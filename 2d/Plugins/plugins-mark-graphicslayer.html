<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no" />
    <title>地图覆盖物-点类型</title>
    <style>
        html,
        body,
        #mapcontainer {
            padding: 0;
            margin: 0;
            width: 100%;
            height: 100%;
        }

        .mapbuttoncontainergroup {
            width: 20%;
            height: 50%;
            position: absolute;
            display: flex;
            flex-flow: column;
        }

        .mapbuttoncontainer {
            width: 100%;
            display: flex;
            flex-flow: row;
            top: 5px;
            left: 10px;
            display: block;
        }

        .mapbuttoncontainer .mapbutton {
            width: 100px;
            height: 40px;
            margin-right: 15px;
            margin-bottom: 15px;
            /* float: left; */
        }
           .esri-popup__content .tdlabel {
           width: 200px;
           }

           .esri-popup__content .tdvalue {
           width: 200px;
           }
    </style>
     <script src="../../library/common/jquery-2.2.3.min.js"></script>
     <script src="../../library/smap/jingshan/SMap.min.js"></script>
     <script src="../../library/smap/jingshan/Plugins.min.js"></script>
     <script>
         const smap = new SMap.Map('mapcontainer', {
            viewMode: '2D',
            center: [-20135, -48456],
            zoom: 3,
            zooms: [0, 11],
            mapStyle: 'smap://styles/dark'
        })
        let onemarker = null
        let sencondmarker = null
        let threemarker = null
        let fourmarker = null
        let fivemarker = null
        let sixmarker = null
        let OverlayGroup =null
        let GraphicOverlays =null;
        function createContentpopup(data) {
         let htmlstring = '';
         htmlstring += "<table>"
             for (let key in data) {
             htmlstring += "<tr>";
                 htmlstring += '<td class="tdlabel">';
                     htmlstring += "<span>";
                         htmlstring += key;
                         htmlstring += " :";
                         htmlstring += "</span>";
                     htmlstring += "</td>";
                 htmlstring += '<td class="tdvalue">';
                     htmlstring += "<span>";
                         htmlstring += data[key] != null ? data[key] : "";
                         htmlstring += "</span>";
                     htmlstring += "</td>";
                 htmlstring += "</tr>";
             }
             htmlstring += "</table>"
         return htmlstring;
         }
      $(function () {
         $("#btnaddmark").click(function () {
         GraphicOverlays = new Plugins.GraphicOverlays(smap.view)
         GraphicOverlays.on(SMap.MapEvent.click, function(result, geometry) {
             if (geometry) {
                  smap.view.popup.defaultPopupTemplateEnabled = true
                  smap.view.popup.autoOpenEnabled = false
                  smap.view.popup.open({
                  location: geometry,
                  title: result.results[0].graphic.attributes.name,
                  content: createContentpopup(result.results[0].graphic.attributes),
               })
             }
            })
            GraphicOverlays.on(SMap.MapEvent.pointermove, function(result, geometry) {
            //  if (geometry) {
            //       smap.view.popup.defaultPopupTemplateEnabled = true
            //       smap.view.popup.autoOpenEnabled = false
            //       smap.view.popup.open({
            //       location: geometry,
            // title: results[0].graphic.attributes.name,
            //       content: createContentpopup(result[0].attributes),
            //    })
            //  }
          })
          onemarker = new SMap.Marker({
                   icon: new SMap.Icon({
                   size: new SMap.Size(40, 40),
                   image: 'http://127.0.0.1:5500/resources/images/green.gif'
                   }),
                   attributes: {
                   'name': '点1',
                   'type': '点'
                   },
                   symbol:{
                     type: "simple-marker",
                     style: "square",
                     color: [255, 0, 0, 1],
                     size: "18px",
                     outline: {
                         color: [255, 0, 0, 1],
                         width: 1
                     }
                 },
                   label: new SMap.Label({
                        text: '点1',
                        color: 'red',
                        visible: true,
                        size: 22,
                        weight: 'normal',
                        angle: 0,
                        backgroundColor: 'red',
                        borderLineColor: 'blue',
                        borderLineSize: 1,
                        haloColor: '[51, 204, 51, 0.2]',
                        haloSize: 0,
                        horizontalAlignment: 'left',
                        verticalAlignment: 'top',
                        kerning: true,
                        lineHeight: 0,
                        lineWidth: 0,
                        rotated: true,
                        xoffset: 0,
                        yoffset: 0,
                        zoffset: 1,
                        labelingInfo: {
                            type: "text", 
                            color: "white",
                            haloColor: "black",
                            haloSize: "1px",
                            text: "You are here",
                            xoffset: 3,
                            yoffset: 3,
                            font: {
                            size: 12,
                            family: "Josefin Slab",
                            weight: "bold"
                          }
                        }

                   }),
                   position: [0, 0, 100]
          })
           GraphicOverlays.add(onemarker)

           sencondmarker = new SMap.Marker({
                 icon: new SMap.Icon({
                 size: new SMap.Size(40, 40),
                 image: 'http://127.0.0.1:5500/resources/images/bluewhite.gif'
                 }),
                 attributes: {
                 'name': '点2',
                 'type': '点'
                 },
                 label: new SMap.Label({
                 text: '点2',
                 size: 12,
                 color: 'blue',
                 xoffset: 0,
                 yoffset: 0,
                 horizontalAlignment: 'left',
                 verticalAlignment: 'top',
                 placement: 'center-right'
                 }),
                 position: [100, 100, 1000]
                 })
             GraphicOverlays.add(sencondmarker)
         })
         $("#btnupdatemark").click(function () {
              onemarker.label.text = '点一更新'
              GraphicOverlays.update(onemarker)
         })

         $("#btndeletemark").click(function () {
          GraphicOverlays.remove(onemarker)
         })

         $("#btnaddmanymark").click(function () {
            threemarker = new SMap.Marker({
                    icon: new SMap.Icon({
                    size: new SMap.Size(40, 40),
                    image: 'http://127.0.0.1:5500/resources/images/green.gif'
                    }),
                    attributes: {
                    'name': '点3',
                    'type': '点'
                    },
                    label: new SMap.Label({
                    text: '点3',
                    size: 22,
                    xoffset: 0,
                    yoffset: 0,
                    horizontalAlignment: 'left',
                    verticalAlignment: 'top'
                    }),
                    position: [1000, 1000, 10]
            })
            fourmarker = new SMap.Marker({
                    icon: new SMap.Icon({
                    size: new SMap.Size(40, 40),
                    image: 'http://127.0.0.1:5500/resources/images/bluewhite.gif'
                    }),
                    attributes: {
                    'name': '点4',
                    'type': '点'
                    },
                    label: new SMap.Label({
                    text: '点4',
                    size: 22,
                    xoffset: 0,
                    yoffset: 0,
                    horizontalAlignment: 'left',
                    verticalAlignment: 'top'
                    }),
                    position: [1100, 1100, 20]
            })
            GraphicOverlays.add([threemarker, fourmarker])
         })

          $("#btnupdatemanymark").click(function () {
             threemarker.icon.image = 'http://127.0.0.1:5500/resources/images/bluewhite.gif'
             threemarker.label.text = '点三更新'
             fourmarker.icon.image = 'http://127.0.0.1:5500/resources/images/green.gif'
             fourmarker.label.text = '点四更新'
             GraphicOverlays.update([threemarker, fourmarker])
          })

            $("#btndeletemanymark").click(function () {
             GraphicOverlays.remove([threemarker, fourmarker])
            })

           $("#btnaddmarkgroup").click(function () {
               fivemarker = new SMap.Marker({
                      icon: new SMap.Icon({
                      size: new SMap.Size(40, 40),
                      image: 'http://127.0.0.1:5500/resources/images/green.gif'
                      }),
                      attributes: {
                      'name': '点5',
                      'type': '点'
                      },
                      label: new SMap.Label({
                      text: '点5',
                      size: 22,
                      color: 'yellow',
                      xoffset: 0.1,
                      yoffset: 0.1,
                      // zoffset: 10,
                      horizontalAlignment: 'left',
                      verticalAlignment: 'top'
                      }),
                      position: [500, 500, 100]
              })
               sixmarker = new SMap.Marker({
                      icon: new SMap.Icon({
                      size: new SMap.Size(40, 40),
                      image: 'http://127.0.0.1:5500/resources/images/bluewhite.gif'
                      }),
                      attributes: {
                      'name': '点6',
                      'type': '点'
                      },
                      label: new SMap.Label({
                      text: '点6',
                      size: 22,
                      color: 'black',
                      xoffset: 0.1,
                      yoffset: 0.1,
                      // zoffset: 10,
                      horizontalAlignment: 'left',
                      verticalAlignment: 'top'
                      }),
                      position: [550, 550, 200]
              })
              OverlayGroup = new SMap.OverlayGroup([fivemarker, sixmarker],{overlaytype: 'marker'})
              GraphicOverlays.add(OverlayGroup)
           })

           $("#btnupdatemarkgroup").click(function () {
               fivemarker.icon.image = 'http://127.0.0.1:5500/resources/images/bluewhite.gif'
               fivemarker.label.text = '点5更新'
    
               sixmarker.icon.image ='http://127.0.0.1:5500/resources/images/green.gif'
               sixmarker.label.text = '点6更新'
               GraphicOverlays.update(OverlayGroup)
           })

           $("#btndeltemarkgroup").click(function () {
             smap.remove(OverlayGroup)
           })
           $("#btnaddbigmarks").click(function () {
                const marks = []
                for (let i = 0; i <= 3000; i++) {
                  const x = Math.ceil(Math.random() * 120000)
                  const y = Math.ceil(Math.random() * 120000)
                  const onemarker = new SMap.Marker({
                    icon: new SMap.Icon({
                      size: new SMap.Size(40, 40),
                      image: 'http://127.0.0.1:5500/resources/images/green.gif'
                    }),
                    attributes: {
                      'name': '点' + i,
                      'type': '点'
                    },
                    label: new SMap.Label({
                      text: '点' + i,
                      color: 'red',
                      visible: false,
                      size: 22,
                      weight: 'normal',
                      angle: 0,
                      backgroundColor: 'red',
                      borderLineColor: 'blue',
                      borderLineSize: 1,
                      haloColor: '[51, 204, 51, 0.2]',
                      haloSize: 0,
                      horizontalAlignment: 'left',
                      verticalAlignment: 'top',
                      kerning: true,
                      lineHeight: 0,
                      lineWidth: 0,
                      rotated: true,
                      xoffset: 0,
                      yoffset: 0
                    }),
                    position: [x, y, 100]
                 })
                   marks.push(onemarker)
                  }
                  smap.add(marks)
           })
            $("#btncleanall").click(function () {
                GraphicOverlays.removeAll()
            })
            $("#btndeletelayer").click(function () {
               GraphicOverlays.delete()
            })
            
             $("#addlayercontrol").click(function () {
               const layerListControl = new SMap.LayerListControl({
               visible: true,
               position: 'top-right',
               collapse: true
               })
               smap.addControl(layerListControl)
         })
      })
    </script>
</head>

<body>
    <div id="mapcontainer"></div>
    <div class="mapbuttoncontainergroup">
        <div class="mapbuttoncontainer">
            <button class="mapbutton" id="btnaddmark"> add one mark </button>
            <button class="mapbutton" id="btnupdatemark"> update one mark</button>
            <button class="mapbutton" id="btndeletemark"> delete one mark</button>
        </div>
        <div class="mapbuttoncontainer">
            <button class="mapbutton" id="btnaddmanymark"> add many marks </button>
            <button class="mapbutton" id="btnupdatemanymark"> update many marks</button>
            <button class="mapbutton" id="btndeletemanymark"> delete many marks</button>
        </div>

        <div class="mapbuttoncontainer">
            <button class="mapbutton" id="btnaddmarkgroup"> add mark group</button>
            <button class="mapbutton" id="btnupdatemarkgroup"> update mark group</button>
            <button class="mapbutton" id="btndeltemarkgroup"> delete mark group</button>
        </div>
        <div class="mapbuttoncontainer">
            <button class="mapbutton" id="btnaddbigmarks"> add big mount marks</button>
             <button class="mapbutton" id="btncleanall">clear all GraphicOverlays</button>
             <button class="mapbutton" id="btndeletelayer">delete GraphicOverlays</button>
             <button class="mapbutton" id="addlayercontrol"> 添加图层控件</button>
        </div>
    </div>

</body>

</html>
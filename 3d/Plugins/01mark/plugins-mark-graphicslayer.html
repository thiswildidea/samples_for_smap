<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no" />
    <title>地图覆盖物-点类型</title>
    <style>
        html,
        body,
        #mapcontainer {
            padding: 0;
            margin: 0;
            width: 100%;
            height: 100%;
        }

        .mapbuttoncontainergroup {
            width: 20%;
            height: 50%;
            position: absolute;
            display: flex;
            flex-flow: column;
        }

        .mapbuttoncontainer {
            width: 100%;
            display: flex;
            flex-flow: row;
            top: 5px;
            left: 10px;
            display: block;
        }

        .mapbuttoncontainer .mapbutton {
            width: 100px;
            height: 40px;
            margin-right: 15px;
            margin-bottom: 15px;
            /* float: left; */
        }

        .esri-popup__content .tdlabel {
            width: 200px;
        }

        .esri-popup__content .tdvalue {
            width: 200px;
        }
    </style>
    <script src="../../../library/common/jquery-2.2.3.min.js"></script>
    <script src="../../../library/smap/xuhui/SMap.min.js"></script>
    <script src="../../../library/smap/xuhui/Plugins.min.js"></script>
    <script>
        const smap = new SMap.Map('mapcontainer', {
            viewMode: '3D',
            center: [0, 0],
            zoom: 3,
            zooms: [0, 11],
            pitch: 60,
            mapStyle: 'smap://styles/dark',
            showBuildingBlock: true
        })
        let onemarker = null
        let sencondmarker = null
        let threemarker = null
        let fourmarker = null
        let fivemarker = null
        let sixmarker = null
        let OverlayGroup = null
        let GraphicOverlays = null;

        function createContentpopup(data) {
            let htmlstring = '';
            htmlstring += "<table>"
            for (let key in data) {
                htmlstring += "<tr>";
                htmlstring += '<td class="tdlabel">';
                htmlstring += "<span>";
                htmlstring += key;
                htmlstring += " :";
                htmlstring += "</span>";
                htmlstring += "</td>";
                htmlstring += '<td class="tdvalue">';
                htmlstring += "<span>";
                htmlstring += data[key] != null ? data[key] : "";
                htmlstring += "</span>";
                htmlstring += "</td>";
                htmlstring += "</tr>";
            }
            htmlstring += "</table>"
            return htmlstring;
        }
        $(function () {
            $("#btnaddmark").click(function () {
                GraphicOverlays = new Plugins.GraphicOverlays(smap.view)
                GraphicOverlays.on(SMap.MapEvent.click, function (result, geometry) {
                    if (geometry) {
                        smap.view.popup.defaultPopupTemplateEnabled = true
                        smap.view.popup.autoOpenEnabled = false
                        smap.view.popup.open({
                            location: geometry,
                            title: result.results[0].graphic.attributes.name,
                            content: createContentpopup(result.results[0].graphic
                                .attributes),
                        })
                    }
                })
                GraphicOverlays.on(SMap.MapEvent.pointermove, function (result, geometry) {

                })
                onemarker = new SMap.Marker({
                    attributes: {
                        'name': '点1',
                        'type': '点'
                    },
                    symbol: {
                        type: "point-3d",
                        symbolLayers: [{
                            type: "object",
                            width: 5,
                            height: 20,
                            depth: 15,
                            resource: {
                                primitive: "diamond"
                            },
                            material: {
                                color: "red"
                            }
                        }],
                        verticalOffset: {
                            screenLength: 40,
                            maxWorldLength: 100,
                            minWorldLength: 20
                        },
                        callout: {
                            type: "line",
                            size: 1.5,
                            color: "white",
                            border: {
                                color: "black"
                            }
                        }
                    },
                    label: new SMap.Label({
                        visible: true,
                        labelingInfo: {
                            type: "text",
                            color: "white",
                            haloColor: "black",
                            haloSize: "1px",
                            text: "点1",
                            xoffset: 3,
                            yoffset: 3,
                            font: {
                                size: 12,
                                family: "Josefin Slab",
                                weight: "bold"
                            }
                        }
                    }),
                    position: [0, 0, 100]
                })
                GraphicOverlays.add(onemarker)

                sencondmarker = new SMap.Marker({
                    attributes: {
                        'name': '点2',
                        'type': '点'
                    },
                    symbol: {
                        type: "point-3d",
                        symbolLayers: [{
                            type: "icon",
                            size: 18,
                            resource: {
                                href: "http://127.0.0.1:5500/resources/images/bluewhite.gif"
                            },
                            material: {
                                color: "red"
                            }
                        }]
                    },
                    label: new SMap.Label({
                        visible: true,
                        labelingInfo: {
                            type: "text",
                            color: "white",
                            haloColor: "black",
                            haloSize: "1px",
                            text: "点2",
                            xoffset: 3,
                            yoffset: 3,
                            font: {
                                size: 12,
                                family: "Josefin Slab",
                                weight: "bold"
                            }
                        }
                    }),
                    position: [100, 100, 1000]
                })
                GraphicOverlays.add(sencondmarker)
            })
            $("#btnupdatemark").click(function () {
                onemarker.label.labelingInfo.text = '点一更新'
                GraphicOverlays.update(onemarker)
            })

            $("#btndeletemark").click(function () {
                GraphicOverlays.remove(onemarker)
            })

            $("#btnaddmanymark").click(function () {
                threemarker = new SMap.Marker({
                    attributes: {
                        'name': '点3',
                        'type': '点'
                    },
                    symbol: {
                        type: "point-3d",
                        symbolLayers: [{
                            type: "icon",
                            size: 18,
                            resource: {
                                href: "http://127.0.0.1:5500/resources/images/bluewhite.gif"
                            },
                            material: {
                                color: "red"
                            }
                        }]
                    },
                    label: new SMap.Label({
                        visible: true,
                        labelingInfo: {
                            type: "text",
                            color: "white",
                            haloColor: "black",
                            haloSize: "1px",
                            text: "点3",
                            xoffset: 3,
                            yoffset: 3,
                            font: {
                                size: 12,
                                family: "Josefin Slab",
                                weight: "bold"
                            }
                        }
                    }),
                    position: [1000, 1000, 10]
                })
                fourmarker = new SMap.Marker({
                    symbol: {
                        type: "point-3d",
                        symbolLayers: [{
                            type: "icon",
                            size: 18,
                            resource: {
                                href: "http://127.0.0.1:5500/resources/images/green.gif"
                            },
                            material: {
                                color: "red"
                            }
                        }]
                    },
                    attributes: {
                        'name': '点4',
                        'type': '点'
                    },
                    label: new SMap.Label({
                        visible: true,
                        labelingInfo: {
                            type: "text",
                            color: "white",
                            haloColor: "black",
                            haloSize: "1px",
                            text: "点4",
                            xoffset: 3,
                            yoffset: 3,
                            font: {
                                size: 12,
                                family: "Josefin Slab",
                                weight: "bold"
                            }
                        }
                    }),
                    position: [1100, 1100, 20]
                })
                GraphicOverlays.add([threemarker, fourmarker])
            })

            $("#btnupdatemanymark").click(function () {
                threemarker.label.labelingInfo.text = '点三更新'
                threemarker.symbol.url = "http://127.0.0.1:5500/resources/images/green.gif"
                fourmarker.label.labelingInfo.text = '点四更新'
                threemarker.symbol.url = "http://127.0.0.1:5500/resources/images/bluewhite.gif"
                GraphicOverlays.update([threemarker, fourmarker])
            })

            $("#btndeletemanymark").click(function () {
                GraphicOverlays.remove([threemarker, fourmarker])
            })

            $("#btnaddmarkgroup").click(function () {
                fivemarker = new SMap.Marker({
                    symbol: {
                        type: "picture-marker",
                        url: "http://127.0.0.1:5500/resources/images/green.gif",
                        width: "64px",
                        height: "64px"
                    },
                    attributes: {
                        'name': '点5',
                        'type': '点'
                    },
                    label: new SMap.Label({
                        visible: true,
                        labelingInfo: {
                            type: "text",
                            color: "white",
                            haloColor: "black",
                            haloSize: "1px",
                            text: "点5",
                            xoffset: 3,
                            yoffset: 3,
                            font: {
                                size: 12,
                                family: "Josefin Slab",
                                weight: "bold"
                            }
                        }
                    }),
                    position: [500, 500, 100]
                })
                sixmarker = new SMap.Marker({
                    symbol: {
                        type: "picture-marker",
                        url: "http://127.0.0.1:5500/resources/images/bluewhite.gif",
                        width: "64px",
                        height: "64px"
                    },
                    attributes: {
                        'name': '点6',
                        'type': '点'
                    },
                    label: new SMap.Label({
                        visible: true,
                        labelingInfo: {
                            type: "text",
                            color: "white",
                            haloColor: "black",
                            haloSize: "1px",
                            text: "点6",
                            xoffset: 3,
                            yoffset: 3,
                            font: {
                                size: 12,
                                family: "Josefin Slab",
                                weight: "bold"
                            }
                        }
                    }),
                    position: [550, 550, 200]
                })
                OverlayGroup = new SMap.OverlayGroup([fivemarker, sixmarker], {
                    overlaytype: 'marker'
                })
                GraphicOverlays.add(OverlayGroup)
            })

            $("#btnupdatemarkgroup").click(function () {
                fivemarker.symbol.url = 'http://127.0.0.1:5500/resources/images/bluewhite.gif'
                fivemarker.label.text = '点5更新'

                sixmarker.symbol.url = 'http://127.0.0.1:5500/resources/images/green.gif'
                sixmarker.label.labelingInfo.text = '点6更新'
                GraphicOverlays.update(OverlayGroup)
            })

            $("#btndeltemarkgroup").click(function () {
                smap.remove(OverlayGroup)
            })
            $("#btnaddbigmarks").click(function () {
                const marks = []
                for (let i = 0; i <= 3000; i++) {
                    const x = Math.ceil(Math.random() * 120000)
                    const y = Math.ceil(Math.random() * 120000)
                    const onemarker = new SMap.Marker({
                        symbol: {
                            type: "picture-marker",
                            url: "http://127.0.0.1:5500/resources/images/bluewhite.gif",
                            width: "64px",
                            height: "64px"
                        },
                        attributes: {
                            'name': '点' + i,
                            'type': '点'
                        },
                        label: new SMap.Label({
                            visible: true,
                            labelingInfo: {
                                type: "text",
                                color: "white",
                                haloColor: "black",
                                haloSize: "1px",
                                text: "点" + i,
                                xoffset: 3,
                                yoffset: 3,
                                font: {
                                    size: 12,
                                    family: "Josefin Slab",
                                    weight: "bold"
                                }
                            }
                        }),
                        position: [x, y, 100]
                    })
                    marks.push(onemarker)
                }
                smap.add(marks)
            })
            $("#btncleanall").click(function () {
                GraphicOverlays.removeAll()
            })
            $("#btndeletelayer").click(function () {
                GraphicOverlays.delete()
            })

            $("#addlayercontrol").click(function () {
                const layerListControl = new SMap.LayerListControl({
                    visible: true,
                    position: 'top-right',
                    collapse: true
                })
                smap.addControl(layerListControl)
            })
        })
    </script>
</head>

<body>
    <div id="mapcontainer"></div>
    <div class="mapbuttoncontainergroup">
        <div class="mapbuttoncontainer">
            <button class="mapbutton" id="btnaddmark"> add one mark </button>
            <button class="mapbutton" id="btnupdatemark"> update one mark</button>
            <button class="mapbutton" id="btndeletemark"> delete one mark</button>
        </div>
        <div class="mapbuttoncontainer">
            <button class="mapbutton" id="btnaddmanymark"> add many marks </button>
            <button class="mapbutton" id="btnupdatemanymark"> update many marks</button>
            <button class="mapbutton" id="btndeletemanymark"> delete many marks</button>
        </div>

        <div class="mapbuttoncontainer">
            <button class="mapbutton" id="btnaddmarkgroup"> add mark group</button>
            <button class="mapbutton" id="btnupdatemarkgroup"> update mark group</button>
            <button class="mapbutton" id="btndeltemarkgroup"> delete mark group</button>
        </div>
        <div class="mapbuttoncontainer">
            <button class="mapbutton" id="btnaddbigmarks"> add big mount marks</button>
            <button class="mapbutton" id="btncleanall">clear all GraphicOverlays</button>
            <button class="mapbutton" id="btndeletelayer">delete GraphicOverlays</button>
            <button class="mapbutton" id="addlayercontrol"> 添加图层控件</button>
        </div>
    </div>

</body>

</html>
! function (e, t) {
    "object" == typeof exports && "undefined" != typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define(t) : e.Plugins = t()
}(this, function () {
    "use strict";
    var e = (t.prototype._addListener = function (e, t, r) {
        if (this.emit("newListener", e, t), this.events.has(e)) {
            var n = this.events.get(e);
            r ? n.unshift(t) : n.push(t)
        } else this.events.set(e, [t]);
        var o = this.getMaxListeners();
        if (0 < o && this.listenerCount(e) > o) {
            var i = new Error("Possible EventEmitter memory leak detected.\n         " + this.listenerCount(e) + " " + e.toString() + " listeners.\n         Use emitter.setMaxListeners() to increase limit");
            i.name = "MaxListenersExceededWarning", console.warn(i)
        }
        return this
    }, t.prototype.addListener = function (e, t) {
        return this._addListener(e, t, !1)
    }, t.prototype.emit = function (e) {
        for (var t = [], r = 1; r < arguments.length; r++) t[r - 1] = arguments[r];
        if (this.events.has(e)) {
            for (var n = 0, o = this.events.get(e).slice(); n < o.length; n++) {
                var i = o[n];
                try {
                    i.apply(this, t)
                } catch (e) {
                    this.emit("error", e)
                }
            }
            return !0
        }
        if ("error" === e) throw 0 < t.length ? t[0] : Error("Unhandled error.");
        return !1
    }, t.prototype.eventNames = function () {
        return Array.from(this.events.keys())
    }, t.prototype.getMaxListeners = function () {
        return this.maxListeners || t.defaultMaxListeners
    }, t.prototype.listenerCount = function (e) {
        return this.events.has(e) ? this.events.get(e).length : 0
    }, t.prototype._listeners = function (e, t, r) {
        if (!e.events.has(t)) return [];
        var n = e.events.get(t);
        return r ? this.unwrapListeners(n) : n.slice(0)
    }, t.prototype.unwrapListeners = function (e) {
        for (var t = new Array(e.length), r = 0; r < e.length; r++) t[r] = e[r].listener || e[r];
        return t
    }, t.prototype.listeners = function (e) {
        return this._listeners(this, e, !0)
    }, t.prototype.rawListeners = function (e) {
        return this._listeners(this, e, !1)
    }, t.prototype.off = function (e, t) {
        return this.removeListener(e, t)
    }, t.prototype.on = function (e, t) {
        return this.addListener(e, t)
    }, t.prototype.once = function (e, t) {
        var r = this.onceWrap(e, t);
        return this.on(e, r), this
    }, t.prototype.onceWrap = function (e, t) {
        function r() {
            for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];
            this.context.removeListener(this.eventName, this.rawListener), this.listener.apply(this.context, e)
        }
        var n = {
                eventName: e,
                listener: t,
                rawListener: r,
                context: this
            },
            o = r.bind(n);
        return (n.rawListener = o).listener = t, o
    }, t.prototype.prependListener = function (e, t) {
        return this._addListener(e, t, !0)
    }, t.prototype.prependOnceListener = function (e, t) {
        var r = this.onceWrap(e, t);
        return this.prependListener(e, r), this
    }, t.prototype.removeAllListeners = function (e) {
        var t = this;
        if (void 0 === this.events) return this;
        if (this.events.has(e)) {
            var r = this.events.get(e).slice();
            this.events.delete(e);
            for (var n = 0, o = r; n < o.length; n++) {
                var i = o[n];
                this.emit("removeListener", e, i)
            }
        } else this.eventNames().map(function (e) {
            t.removeAllListeners(e)
        });
        return this
    }, t.prototype.removeListener = function (e, t) {
        if (this.events.has(e)) {
            var r = this.events.get(e); - 1 !== r.indexOf(t) && (r.splice(r.indexOf(t), 1), this.emit("removeListener", e, t), 0 === r.length && this.events.delete(e))
        }
        return this
    }, t.prototype.setMaxListeners = function (e) {
        return this.maxListeners = e, this
    }, t.defaultMaxListeners = 50, t);

    function t() {
        this.events = new Map
    }
    var p = (r.jsapi = "http://31.8.11.75/smiapi/arcgis", r.jsapiversion4X = "4.15", r);

    function r() {}
    var a = p.jsapiversion4X,
        o = "next";

    function i(e) {
        if (null === e && (e = a), e.toString().toLowerCase() === o) return o;
        var t = e && e.match(/^(\d)\.(\d+)/);
        return t && {
            major: parseInt(t[1], 10),
            minor: parseInt(t[2], 10)
        }
    }

    function s(e) {
        return void 0 === e && (e = a), p.jsapi + "/" + e + "/init.js"
    }

    function l(e) {
        var t = document.createElement("link");
        return t.rel = "stylesheet", t.href = e, t
    }

    function c(e, t) {
        if (t) {
            var r = document.querySelector(t);
            r.parentNode.insertBefore(e, r)
        } else document.head.appendChild(e)
    }

    function u(e) {
        return document.querySelector('link[href*="' + e + '"]')
    }

    function y(e) {
        return !e || i(e) ? function (e) {
            void 0 === e && (e = a), null === e && (e = a);
            var t = s(e),
                r = t.substring(0, t.indexOf("init.js")),
                n = i(e);
            return n === o || 3 !== n.major ? r + "esri/themes/light/main.css" : r + (n.minor <= 10 ? "js/" : "") + "esri/css/esri.css"
        }(e) : e
    }

    function d(e, t) {
        var r = y(e),
            n = u(r);
        if (n || c(n = l(r), t), 4 === function (e) {
                null === e && (e = a);
                var t = e && e.match(/^(\d)\.(\d+)/);
                return t && {
                    major: parseInt(t[1], 10),
                    minor: parseInt(t[2], 10)
                }
            }(e).major) {
            var o = r.substring(0, r.indexOf("esri/themes/")) + "esri/themes/gis/css/gis.css",
                i = u(o);
            i || c(i = l(o), t)
        }
        return n
    }
    var n = {
            Promise: "undefined" != typeof window ? window.Promise : void 0
        },
        f = {};

    function h(e, t, r) {
        var n, o, i, a;
        r && (i = r, a = function (e) {
            i(e.error || new Error("There was an error attempting to load " + o.src)), o.removeEventListener("error", a, !1)
        }, (o = e).addEventListener("error", a, !1), n = a);
        var s = function () {
            t(e), e.removeEventListener("load", s, !1), n && e.removeEventListener("error", n, !1)
        };
        e.addEventListener("load", s, !1)
    }

    function v() {
        return document.querySelector("script[data-shsmi]")
    }

    function m() {
        var e = window.require;
        return e && e.on
    }

    function w(e) {
        void 0 === e && (e = {});
        var l = {};
        [f, e].forEach(function (e) {
            for (var t in e) Object.prototype.hasOwnProperty.call(e, t) && (l[t] = e[t])
        });
        var c = l.version,
            u = l.url || s(c);
        return new n.Promise(function (e, t) {
            var r, n, o = v();
            if (o) {
                var i = o.getAttribute("src");
                i !== u ? t(new Error("The ArcGIS API for JavaScript is already loaded (" + i + ").")) : m() ? e(o) : h(o, e, t)
            } else if (m()) t(new Error("The ArcGIS API for JavaScript is already loaded."));
            else {
                var a = l.css;
                if (a) d(!0 === a ? c : a, l.insertCssBefore);
                else d(null, l.insertCssBefore);
                if (l.dojoConfig) window.dojoConfig = l.dojoConfig;
                else {
                    var s = {
                        async: !0,
                        packages: [{
                            location: p.jsapi + "/extensions",
                            name: "smiapi"
                        }, {
                            location: p.jsapi + "/extensions/geolocation",
                            name: "geolocate",
                            main: "geolocate"
                        }],
                        deps: ["@dojo/framework/shim/main"],
                        has: {
                            "esri-promise-compatibility": 1,
                            "esri-featurelayer-webgl": 1
                        }
                    };
                    window.dojoConfig = s
                }
                r = u, (n = document.createElement("script")).type = "text/javascript", n.src = r, n.setAttribute("data-shsmi", "loading"), h(o = n, function () {
                    o.setAttribute("data-shsmi", "loaded"), e(o)
                }, t), document.head.appendChild(o)
            }
        })
    }

    function b(t) {
        return new n.Promise(function (r, e) {
            var n = window.require.on("error", e);
            window.require(t, function () {
                for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];
                n.remove(), r(e)
            })
        })
    }

    function g(e, t) {
        if (void 0 === t && (t = {}), m()) return b(e);
        var r = v(),
            n = r && r.getAttribute("src");
        return !t.url && n && (t.url = n), w(t).then(function () {
            return b(e)
        })
    }
    var L = (x.prototype.S4 = function () {
        return (65536 * (1 + Math.random()) | 0).toString(16).substring(1)
    }, x.prototype.get_uuid = function () {
        return this.S4() + this.S4() + "-" + this.S4() + "-" + this.S4() + "-" + this.S4() + "-" + this.S4() + this.S4() + this.S4()
    }, x);

    function x() {
        this.uuid = this.get_uuid()
    }
    var _, k, S = (_ = function (e, t) {
            return (_ = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function (e, t) {
                    e.__proto__ = t
                } || function (e, t) {
                    for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r])
                })(e, t)
        }, function (e, t) {
            function r() {
                this.constructor = e
            }
            _(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r)
        }),
        j = function (e, a, s, l) {
            return new(s = s || Promise)(function (r, t) {
                function n(e) {
                    try {
                        i(l.next(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function o(e) {
                    try {
                        i(l.throw(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function i(e) {
                    var t;
                    e.done ? r(e.value) : ((t = e.value) instanceof s ? t : new s(function (e) {
                        e(t)
                    })).then(n, o)
                }
                i((l = l.apply(e, a || [])).next())
            })
        },
        E = function (r, n) {
            var o, i, a, e, s = {
                label: 0,
                sent: function () {
                    if (1 & a[0]) throw a[1];
                    return a[1]
                },
                trys: [],
                ops: []
            };
            return e = {
                next: t(0),
                throw: t(1),
                return: t(2)
            }, "function" == typeof Symbol && (e[Symbol.iterator] = function () {
                return this
            }), e;

            function t(t) {
                return function (e) {
                    return function (t) {
                        if (o) throw new TypeError("Generator is already executing.");
                        for (; s;) try {
                            if (o = 1, i && (a = 2 & t[0] ? i.return : t[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, t[1])).done) return a;
                            switch (i = 0, a && (t = [2 & t[0], a.value]), t[0]) {
                                case 0:
                                case 1:
                                    a = t;
                                    break;
                                case 4:
                                    return s.label++, {
                                        value: t[1],
                                        done: !1
                                    };
                                case 5:
                                    s.label++, i = t[1], t = [0];
                                    continue;
                                case 7:
                                    t = s.ops.pop(), s.trys.pop();
                                    continue;
                                default:
                                    if (!(a = 0 < (a = s.trys).length && a[a.length - 1]) && (6 === t[0] || 2 === t[0])) {
                                        s = 0;
                                        continue
                                    }
                                    if (3 === t[0] && (!a || t[1] > a[0] && t[1] < a[3])) {
                                        s.label = t[1];
                                        break
                                    }
                                    if (6 === t[0] && s.label < a[1]) {
                                        s.label = a[1], a = t;
                                        break
                                    }
                                    if (a && s.label < a[2]) {
                                        s.label = a[2], s.ops.push(t);
                                        break
                                    }
                                    a[2] && s.ops.pop(), s.trys.pop();
                                    continue
                            }
                            t = n.call(r, s)
                        } catch (e) {
                            t = [6, e], i = 0
                        } finally {
                            o = a = 0
                        }
                        if (5 & t[0]) throw t[1];
                        return {
                            value: t[0] ? t[1] : void 0,
                            done: !0
                        }
                    }([t, e])
                }
            }
        },
        P = (S(I, k = e), I.prototype.add = function (i) {
            var a = this;
            void 0 === i && (i = {}), g(["esri/layers/GraphicsLayer", "esri/Graphic"]).then(function (e) {
                var t = e[0],
                    o = e[1];
                if (i.boundaryType && a.view) {
                    var r = a.view.map.findLayerById(i.boundaryType);
                    if (r) {
                        var n = r.createQuery();
                        n.where = i.boundaryDefinition, r.queryFeatures(n).then(function (e) {
                            if (0 < e.features.length) {
                                var r, n = a.view.map.findLayerById(a.displayedLayerid);
                                void 0 === n && (n = new t({
                                    title: a.displayedLayerid + "边界",
                                    id: a.displayedLayerid,
                                    listMode: "hide"
                                }), a.view.map.add(n)), r = void 0 !== i.symbol ? i.symbol : {
                                    type: "simple-fill",
                                    color: [255, 255, 255, 0],
                                    outline: {
                                        color: [255, 255, 0, 1],
                                        width: "5px"
                                    }
                                }, e.features.map(function (e) {
                                    var t = new o({
                                        geometry: e.geometry,
                                        symbol: r,
                                        attributes: e.attributes
                                    });
                                    n.add(t)
                                })
                            }
                        })
                    }
                }
            }).catch(function (e) {
                console.error(e)
            })
        }, I.prototype.remove = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && this.view.map.remove(e)
        }, I.prototype.show = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && (e.visible = !0)
        }, I.prototype.hide = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && (e.visible = !1)
        }, I.prototype.init = function (t) {
            return j(this, void 0, void 0, function () {
                var n = this;
                return E(this, function (e) {
                    return this.displayedLayerid = (new L).uuid, this.view = t, this.view.on("click", function (r) {
                        n.view.hitTest(r).then(function (t) {
                            return j(n, void 0, void 0, function () {
                                return E(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit("click", t.results[0].graphic, r.mapPoint), [2]
                                })
                            })
                        })
                    }), [2]
                })
            })
        }, I);

    function I(e) {
        var t = k.call(this) || this;
        return t.displayedLayerid = "", t.view = null, t.init(e), t
    }
    var O, A, C = (O = function (e, t) {
            return (O = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function (e, t) {
                    e.__proto__ = t
                } || function (e, t) {
                    for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r])
                })(e, t)
        }, function (e, t) {
            function r() {
                this.constructor = e
            }
            O(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r)
        }),
        R = function (e, a, s, l) {
            return new(s = s || Promise)(function (r, t) {
                function n(e) {
                    try {
                        i(l.next(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function o(e) {
                    try {
                        i(l.throw(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function i(e) {
                    var t;
                    e.done ? r(e.value) : ((t = e.value) instanceof s ? t : new s(function (e) {
                        e(t)
                    })).then(n, o)
                }
                i((l = l.apply(e, a || [])).next())
            })
        },
        B = function (r, n) {
            var o, i, a, e, s = {
                label: 0,
                sent: function () {
                    if (1 & a[0]) throw a[1];
                    return a[1]
                },
                trys: [],
                ops: []
            };
            return e = {
                next: t(0),
                throw: t(1),
                return: t(2)
            }, "function" == typeof Symbol && (e[Symbol.iterator] = function () {
                return this
            }), e;

            function t(t) {
                return function (e) {
                    return function (t) {
                        if (o) throw new TypeError("Generator is already executing.");
                        for (; s;) try {
                            if (o = 1, i && (a = 2 & t[0] ? i.return : t[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, t[1])).done) return a;
                            switch (i = 0, a && (t = [2 & t[0], a.value]), t[0]) {
                                case 0:
                                case 1:
                                    a = t;
                                    break;
                                case 4:
                                    return s.label++, {
                                        value: t[1],
                                        done: !1
                                    };
                                case 5:
                                    s.label++, i = t[1], t = [0];
                                    continue;
                                case 7:
                                    t = s.ops.pop(), s.trys.pop();
                                    continue;
                                default:
                                    if (!(a = 0 < (a = s.trys).length && a[a.length - 1]) && (6 === t[0] || 2 === t[0])) {
                                        s = 0;
                                        continue
                                    }
                                    if (3 === t[0] && (!a || t[1] > a[0] && t[1] < a[3])) {
                                        s.label = t[1];
                                        break
                                    }
                                    if (6 === t[0] && s.label < a[1]) {
                                        s.label = a[1], a = t;
                                        break
                                    }
                                    if (a && s.label < a[2]) {
                                        s.label = a[2], s.ops.push(t);
                                        break
                                    }
                                    a[2] && s.ops.pop(), s.trys.pop();
                                    continue
                            }
                            t = n.call(r, s)
                        } catch (e) {
                            t = [6, e], i = 0
                        } finally {
                            o = a = 0
                        }
                        if (5 & t[0]) throw t[1];
                        return {
                            value: t[0] ? t[1] : void 0,
                            done: !0
                        }
                    }([t, e])
                }
            }
        },
        M = (C(T, A = e), T.prototype.add = function (o) {
            var i = this;
            g(["smiapi/utils/FlashPoint3DLayer", "esri/geometry/Point", "esri/views/3d/externalRenderers"]).then(function (e) {
                var t = e[0],
                    r = e[1],
                    n = e[2];
                i.falshpoint3DRenderer = new t({
                    nring: o.nring,
                    spead: o.spead,
                    color: o.color,
                    view: o.view,
                    points: o.points
                }, function (e) {
                    var t = null;
                    null != e && (t = new r({
                        x: e.x,
                        y: e.y,
                        spatialReference: {
                            wkid: 102100
                        }
                    })), i.emit("click", e, t)
                }), n.add(i.view, i.falshpoint3DRenderer)
            })
        }, T.prototype.remove = function () {
            var t = this;
            g(["esri/views/3d/externalRenderers"]).then(function (e) {
                e[0].remove(t.view, t.falshpoint3DRenderer)
            })
        }, T.prototype.init = function (t) {
            return R(this, void 0, void 0, function () {
                return B(this, function (e) {
                    return this.view = t, [2]
                })
            })
        }, T);

    function T(e) {
        var t = A.call(this) || this;
        return t.view = null, t.falshpoint3DRenderer = null, t.init(e), t
    }
    var z, G, q = (z = function (e, t) {
            return (z = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function (e, t) {
                    e.__proto__ = t
                } || function (e, t) {
                    for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r])
                })(e, t)
        }, function (e, t) {
            function r() {
                this.constructor = e
            }
            z(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r)
        }),
        D = function (e, a, s, l) {
            return new(s = s || Promise)(function (r, t) {
                function n(e) {
                    try {
                        i(l.next(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function o(e) {
                    try {
                        i(l.throw(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function i(e) {
                    var t;
                    e.done ? r(e.value) : ((t = e.value) instanceof s ? t : new s(function (e) {
                        e(t)
                    })).then(n, o)
                }
                i((l = l.apply(e, a || [])).next())
            })
        },
        H = function (r, n) {
            var o, i, a, e, s = {
                label: 0,
                sent: function () {
                    if (1 & a[0]) throw a[1];
                    return a[1]
                },
                trys: [],
                ops: []
            };
            return e = {
                next: t(0),
                throw: t(1),
                return: t(2)
            }, "function" == typeof Symbol && (e[Symbol.iterator] = function () {
                return this
            }), e;

            function t(t) {
                return function (e) {
                    return function (t) {
                        if (o) throw new TypeError("Generator is already executing.");
                        for (; s;) try {
                            if (o = 1, i && (a = 2 & t[0] ? i.return : t[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, t[1])).done) return a;
                            switch (i = 0, a && (t = [2 & t[0], a.value]), t[0]) {
                                case 0:
                                case 1:
                                    a = t;
                                    break;
                                case 4:
                                    return s.label++, {
                                        value: t[1],
                                        done: !1
                                    };
                                case 5:
                                    s.label++, i = t[1], t = [0];
                                    continue;
                                case 7:
                                    t = s.ops.pop(), s.trys.pop();
                                    continue;
                                default:
                                    if (!(a = 0 < (a = s.trys).length && a[a.length - 1]) && (6 === t[0] || 2 === t[0])) {
                                        s = 0;
                                        continue
                                    }
                                    if (3 === t[0] && (!a || t[1] > a[0] && t[1] < a[3])) {
                                        s.label = t[1];
                                        break
                                    }
                                    if (6 === t[0] && s.label < a[1]) {
                                        s.label = a[1], a = t;
                                        break
                                    }
                                    if (a && s.label < a[2]) {
                                        s.label = a[2], s.ops.push(t);
                                        break
                                    }
                                    a[2] && s.ops.pop(), s.trys.pop();
                                    continue
                            }
                            t = n.call(r, s)
                        } catch (e) {
                            t = [6, e], i = 0
                        } finally {
                            o = a = 0
                        }
                        if (5 & t[0]) throw t[1];
                        return {
                            value: t[0] ? t[1] : void 0,
                            done: !0
                        }
                    }([t, e])
                }
            }
        },
        N = (q(F, G = e), F.prototype.add = function (n) {
            var o = this;
            g(["smiapi/utils/HeatMapLayer"]).then(function (e) {
                var t = e[0],
                    r = {
                        container: document.getElementById(n.container),
                        radius: n.radius || 30,
                        maxOpacity: n.maxOpacity || .8,
                        minOpacity: n.minOpacity || 0,
                        blur: n.blur || .7,
                        gradient: n.gradient || {
                            0: "rgb(0,0,0)",
                            .3: "rgb(0,0,255)",
                            .8: "rgb(0,255,0)",
                            .98: "rgb(255,255,0)",
                            1: "rgb(255,0,0)"
                        }
                    };
                o.heatmaplayer = new t(o.view, r, n.datas, n.h337, n.id), o.heatmaplayer.addData()
            })
        }, F.prototype.remove = function (e) {
            var t = document.getElementsByClassName("esri-view-surface")[0],
                r = document.getElementById(e);
            null != r && t.removeChild(r)
        }, F.prototype.refreshdata = function (e) {
            this.heatmaplayer.setVisible(!0), this.heatmaplayer.freshenLayerData(e)
        }, F.prototype.show = function () {
            this.heatmaplayer.setVisible(!0)
        }, F.prototype.hide = function () {
            this.heatmaplayer.setVisible(!1)
        }, F.prototype.init = function (t) {
            return D(this, void 0, void 0, function () {
                return H(this, function (e) {
                    return this.displayedLayerid = (new L).uuid, this.view = t, [2]
                })
            })
        }, F);

    function F(e) {
        var t = G.call(this) || this;
        return t.displayedLayerid = "", t.view = null, t.heatmaplayer = null, t.init(e), t
    }
    var U = (W.shqxboundary = "qx_boundary", W.shjdboundary = "jd_boundary", W.shjwhboundary = "jwh_boundary", W);

    function W() {}
    var V, J, Q = (V = function (e, t) {
            return (V = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function (e, t) {
                    e.__proto__ = t
                } || function (e, t) {
                    for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r])
                })(e, t)
        }, function (e, t) {
            function r() {
                this.constructor = e
            }
            V(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r)
        }),
        X = function (e, a, s, l) {
            return new(s = s || Promise)(function (r, t) {
                function n(e) {
                    try {
                        i(l.next(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function o(e) {
                    try {
                        i(l.throw(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function i(e) {
                    var t;
                    e.done ? r(e.value) : ((t = e.value) instanceof s ? t : new s(function (e) {
                        e(t)
                    })).then(n, o)
                }
                i((l = l.apply(e, a || [])).next())
            })
        },
        K = function (r, n) {
            var o, i, a, e, s = {
                label: 0,
                sent: function () {
                    if (1 & a[0]) throw a[1];
                    return a[1]
                },
                trys: [],
                ops: []
            };
            return e = {
                next: t(0),
                throw: t(1),
                return: t(2)
            }, "function" == typeof Symbol && (e[Symbol.iterator] = function () {
                return this
            }), e;

            function t(t) {
                return function (e) {
                    return function (t) {
                        if (o) throw new TypeError("Generator is already executing.");
                        for (; s;) try {
                            if (o = 1, i && (a = 2 & t[0] ? i.return : t[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, t[1])).done) return a;
                            switch (i = 0, a && (t = [2 & t[0], a.value]), t[0]) {
                                case 0:
                                case 1:
                                    a = t;
                                    break;
                                case 4:
                                    return s.label++, {
                                        value: t[1],
                                        done: !1
                                    };
                                case 5:
                                    s.label++, i = t[1], t = [0];
                                    continue;
                                case 7:
                                    t = s.ops.pop(), s.trys.pop();
                                    continue;
                                default:
                                    if (!(a = 0 < (a = s.trys).length && a[a.length - 1]) && (6 === t[0] || 2 === t[0])) {
                                        s = 0;
                                        continue
                                    }
                                    if (3 === t[0] && (!a || t[1] > a[0] && t[1] < a[3])) {
                                        s.label = t[1];
                                        break
                                    }
                                    if (6 === t[0] && s.label < a[1]) {
                                        s.label = a[1], a = t;
                                        break
                                    }
                                    if (a && s.label < a[2]) {
                                        s.label = a[2], s.ops.push(t);
                                        break
                                    }
                                    a[2] && s.ops.pop(), s.trys.pop();
                                    continue
                            }
                            t = n.call(r, s)
                        } catch (e) {
                            t = [6, e], i = 0
                        } finally {
                            o = a = 0
                        }
                        if (5 & t[0]) throw t[1];
                        return {
                            value: t[0] ? t[1] : void 0,
                            done: !0
                        }
                    }([t, e])
                }
            }
        },
        Y = (Q(Z, J = e), Z.prototype.add = function (d) {
            var f = this;
            g(["esri/Graphic", "esri/layers/GraphicsLayer", "esri/geometry/Polygon", "esri/geometry/geometryEngineAsync", "esri/geometry/SpatialReference", "esri/Color"]).then(function (e) {
                var c = e[0],
                    t = e[1],
                    r = e[2],
                    u = e[3],
                    p = (e[4], e[5]),
                    n = null;
                "qx_boundary" === d.boundaryType ? n = f.view.map.findLayerById("qx_boundary") : "jd_boundary" === d.boundaryType ? n = f.view.map.findLayerById("jd_boundary") : "jwh_boundary" === d.boundaryType && (n = f.view.map.findLayerById("jwh_boundary"));
                var y = f.view.map.findLayerById(f.displayedLayerid);
                if (null == y && (y = new t({
                        id: f.displayedLayerid,
                        title: "遮罩层",
                        listMode: "hide"
                    }), f.view.map.add(y)), y.removeAll(), d.inputgeometry) {
                    if (null === (n = f.view.map.findLayerById("qx_boundary"))) return;
                    var o = new r({
                            rings: d.inputgeometry,
                            spatialReference: f.view.spatialReference
                        }),
                        i = n.fullExtent;
                    i.spatialReference = f.view.spatialReference;
                    var l = o;
                    l.spatialReference = f.view.spatialReference, u.buffer(l, d.boundarydistance, "meters").then(function (e) {
                        u.difference(i, e).then(function (e) {
                            var t;
                            t = "3d" === f.view.type ? d.symbol ? {
                                type: "polygon-3d",
                                symbolLayers: [{
                                    type: "extrude",
                                    material: {
                                        color: d.maskColor
                                    },
                                    size: d.symbol.size,
                                    edges: {
                                        type: "solid",
                                        color: d.maskColor
                                    }
                                }]
                            } : {
                                type: "polygon-3d",
                                symbolLayers: [{
                                    type: "fill",
                                    material: {
                                        color: d.maskColor
                                    },
                                    outline: {
                                        color: "white",
                                        size: "0px"
                                    }
                                }]
                            } : {
                                type: "simple-fill",
                                color: d.maskColor,
                                style: "solid",
                                outline: {
                                    color: d.maskColor,
                                    width: 1
                                }
                            };
                            var r = new c({
                                geometry: e,
                                symbol: t
                            });
                            y.add(r);
                            for (var o = void 0 === d.bounarycount ? 30 : d.bounarycount, i = Math.ceil(d.boundarydistance / o), a = new p(d.boundaryColor).toRgba(), n = function (n) {
                                    u.buffer(l, n * o, "meters").then(function (t) {
                                        u.buffer(l, (n - 1) * o, "meters").then(function (e) {
                                            u.difference(t, e).then(function (e) {
                                                var t;
                                                a[3] = 1 / i * n, t = "3d" === f.view.type ? d.symbol ? {
                                                    type: "polygon-3d",
                                                    symbolLayers: [{
                                                        type: "extrude",
                                                        material: {
                                                            color: a
                                                        },
                                                        size: d.symbol.size,
                                                        edges: {
                                                            type: "solid",
                                                            color: a
                                                        }
                                                    }]
                                                } : {
                                                    type: "polygon-3d",
                                                    symbolLayers: [{
                                                        type: "fill",
                                                        material: {
                                                            color: a
                                                        },
                                                        outline: {
                                                            color: "white",
                                                            size: "0px"
                                                        }
                                                    }]
                                                } : {
                                                    type: "simple-fill",
                                                    color: a,
                                                    style: "solid",
                                                    outline: {
                                                        color: a,
                                                        width: 1
                                                    }
                                                };
                                                var r = new c({
                                                    geometry: e,
                                                    symbol: t
                                                });
                                                y.add(r)
                                            })
                                        })
                                    })
                                }, s = 1; s <= i; s++) n(s)
                        })
                    })
                } else {
                    if (null === n) return;
                    var a = n.createQuery();
                    a.where = d.boundaryDefinition, n.queryFeatures(a).then(function (e) {
                        if (e.features.length) {
                            var t = n.fullExtent;
                            t.spatialReference = f.view.spatialReference;
                            var l = e.features[0].geometry;
                            l.spatialReference = f.view.spatialReference, u.buffer(l, d.boundarydistance, "meters").then(function (e) {
                                u.difference(t, e).then(function (e) {
                                    var t;
                                    t = "3d" === f.view.type ? d.symbol ? {
                                        type: "polygon-3d",
                                        symbolLayers: [{
                                            type: "extrude",
                                            material: {
                                                color: d.maskColor
                                            },
                                            size: d.symbol.size,
                                            edges: {
                                                type: "solid",
                                                color: d.maskColor
                                            }
                                        }]
                                    } : {
                                        type: "polygon-3d",
                                        symbolLayers: [{
                                            type: "fill",
                                            material: {
                                                color: d.maskColor
                                            },
                                            outline: {
                                                color: "white",
                                                size: "0px"
                                            }
                                        }]
                                    } : {
                                        type: "simple-fill",
                                        color: d.maskColor,
                                        style: "solid",
                                        outline: {
                                            color: d.maskColor,
                                            width: 1
                                        }
                                    };
                                    var r = new c({
                                        geometry: e,
                                        symbol: t
                                    });
                                    y.add(r);
                                    for (var o = void 0 === d.bounarycount ? 30 : d.bounarycount, i = Math.ceil(d.boundarydistance / o), a = new p(d.boundaryColor).toRgba(), n = function (n) {
                                            u.buffer(l, n * o, "meters").then(function (t) {
                                                u.buffer(l, (n - 1) * o, "meters").then(function (e) {
                                                    u.difference(t, e).then(function (e) {
                                                        var t;
                                                        a[3] = 1 / i * n, t = "3d" === f.view.type ? d.symbol ? {
                                                            type: "polygon-3d",
                                                            symbolLayers: [{
                                                                type: "extrude",
                                                                material: {
                                                                    color: a
                                                                },
                                                                size: d.symbol.size,
                                                                edges: {
                                                                    type: "solid",
                                                                    color: a
                                                                }
                                                            }]
                                                        } : {
                                                            type: "polygon-3d",
                                                            symbolLayers: [{
                                                                type: "fill",
                                                                material: {
                                                                    color: a
                                                                },
                                                                outline: {
                                                                    color: "white",
                                                                    size: "0px"
                                                                }
                                                            }]
                                                        } : {
                                                            type: "simple-fill",
                                                            color: a,
                                                            style: "solid",
                                                            outline: {
                                                                color: a,
                                                                width: 1
                                                            }
                                                        };
                                                        var r = new c({
                                                            geometry: e,
                                                            symbol: t
                                                        });
                                                        y.add(r)
                                                    })
                                                })
                                            })
                                        }, s = 1; s <= i; s++) n(s)
                                })
                            })
                        }
                    })
                }
            })
        }, Z.prototype.remove = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && this.view.map.remove(e)
        }, Z.prototype.show = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && (e.visible = !0)
        }, Z.prototype.hide = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && (e.visible = !1)
        }, Z.prototype.init = function (t) {
            return X(this, void 0, void 0, function () {
                return K(this, function (e) {
                    return this.displayedLayerid = (new L).uuid, this.view = t, [2]
                })
            })
        }, Z);

    function Z(e) {
        var t = J.call(this) || this;
        return t.displayedLayerid = "", t.view = null, t.init(e), t
    }
    var $, ee, te = ($ = function (e, t) {
            return ($ = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function (e, t) {
                    e.__proto__ = t
                } || function (e, t) {
                    for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r])
                })(e, t)
        }, function (e, t) {
            function r() {
                this.constructor = e
            }
            $(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r)
        }),
        re = function (e, a, s, l) {
            return new(s = s || Promise)(function (r, t) {
                function n(e) {
                    try {
                        i(l.next(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function o(e) {
                    try {
                        i(l.throw(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function i(e) {
                    var t;
                    e.done ? r(e.value) : ((t = e.value) instanceof s ? t : new s(function (e) {
                        e(t)
                    })).then(n, o)
                }
                i((l = l.apply(e, a || [])).next())
            })
        },
        ne = function (r, n) {
            var o, i, a, e, s = {
                label: 0,
                sent: function () {
                    if (1 & a[0]) throw a[1];
                    return a[1]
                },
                trys: [],
                ops: []
            };
            return e = {
                next: t(0),
                throw: t(1),
                return: t(2)
            }, "function" == typeof Symbol && (e[Symbol.iterator] = function () {
                return this
            }), e;

            function t(t) {
                return function (e) {
                    return function (t) {
                        if (o) throw new TypeError("Generator is already executing.");
                        for (; s;) try {
                            if (o = 1, i && (a = 2 & t[0] ? i.return : t[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, t[1])).done) return a;
                            switch (i = 0, a && (t = [2 & t[0], a.value]), t[0]) {
                                case 0:
                                case 1:
                                    a = t;
                                    break;
                                case 4:
                                    return s.label++, {
                                        value: t[1],
                                        done: !1
                                    };
                                case 5:
                                    s.label++, i = t[1], t = [0];
                                    continue;
                                case 7:
                                    t = s.ops.pop(), s.trys.pop();
                                    continue;
                                default:
                                    if (!(a = 0 < (a = s.trys).length && a[a.length - 1]) && (6 === t[0] || 2 === t[0])) {
                                        s = 0;
                                        continue
                                    }
                                    if (3 === t[0] && (!a || t[1] > a[0] && t[1] < a[3])) {
                                        s.label = t[1];
                                        break
                                    }
                                    if (6 === t[0] && s.label < a[1]) {
                                        s.label = a[1], a = t;
                                        break
                                    }
                                    if (a && s.label < a[2]) {
                                        s.label = a[2], s.ops.push(t);
                                        break
                                    }
                                    a[2] && s.ops.pop(), s.trys.pop();
                                    continue
                            }
                            t = n.call(r, s)
                        } catch (e) {
                            t = [6, e], i = 0
                        } finally {
                            o = a = 0
                        }
                        if (5 & t[0]) throw t[1];
                        return {
                            value: t[0] ? t[1] : void 0,
                            done: !0
                        }
                    }([t, e])
                }
            }
        },
        oe = (te(ie, ee = e), ie.prototype.add = function (i) {
            var a = this;
            void 0 === i && (i = {}), g(["esri/layers/echartsLayer"]).then(function (e) {
                var t = e[0],
                    r = [];
                i.datas.forEach(function (e, t) {
                    r.push({
                        name: e[0] + " Top10",
                        type: "lines",
                        coordinateSystem: "arcgis",
                        zlevel: 1,
                        effect: {
                            show: !0,
                            period: 6,
                            trailLength: .7,
                            color: "#fff",
                            symbolSize: 3
                        },
                        lineStyle: {
                            normal: {
                                color: i.color[t],
                                width: 0,
                                curveness: .2
                            }
                        },
                        data: a.convertData(e[1], i.geoCoordMap)
                    }, {
                        name: e[0] + " Top10",
                        type: "lines",
                        coordinateSystem: "arcgis",
                        zlevel: 2,
                        symbol: ["none", "arrow"],
                        symbolSize: 10,
                        effect: {
                            show: !0,
                            period: 6,
                            trailLength: 0,
                            symbol: i.planePath,
                            symbolSize: 15
                        },
                        lineStyle: {
                            normal: {
                                color: i.color[t],
                                width: 1,
                                opacity: .6,
                                curveness: .2
                            }
                        },
                        data: a.convertData(e[1], i.geoCoordMap)
                    }, {
                        name: e[0] + " Top10",
                        type: "effectScatter",
                        coordinateSystem: "arcgis",
                        zlevel: 2,
                        rippleEffect: {
                            brushType: "stroke"
                        },
                        legendHoverLink: !0,
                        hoverAnimation: !0,
                        symbol: i.symbol,
                        label: {
                            normal: {
                                show: !0,
                                position: "right",
                                formatter: "{b}"
                            }
                        },
                        symbolSize: function (e) {
                            return e[2] / 8
                        },
                        itemStyle: {
                            normal: {
                                color: i.color[t],
                                shadowBlur: 10,
                                shadowColor: "#333"
                            }
                        },
                        data: e[1].map(function (e) {
                            return {
                                name: e[1].name,
                                value: i.geoCoordMap[e[1].name].concat([e[1].value])
                            }
                        })
                    })
                });
                var n = new t(a.view, "", i.id),
                    o = {
                        title: {
                            text: "",
                            subtext: "",
                            left: "center",
                            textStyle: {
                                color: "#fff"
                            }
                        },
                        series: r
                    };
                n.setChartOption(o)
            })
        }, ie.prototype.remove = function (e) {
            var t = document.getElementsByClassName("esri-view-surface")[0],
                r = document.getElementById(e);
            null != r && t.removeChild(r)
        }, ie.prototype.convertData = function (e, t) {
            for (var r = [], n = 0, o = e; n < o.length; n++) {
                var i = o[n],
                    a = t[i[0].name],
                    s = t[i[1].name];
                a && s && r.push({
                    fromName: i[0].name,
                    toName: i[1].name,
                    coords: [a, s],
                    value: i[1].value
                })
            }
            return r
        }, ie.prototype.getAPIScript = function (e) {
            return document.querySelector("script[" + e + "]")
        }, ie.prototype.loadAPIScript = function (o, i) {
            var a = this;
            return new n.Promise(function (e, t) {
                var r = a.getAPIScript(o);
                if (r) {
                    var n = r.getAttribute("src");
                    n !== i ? t(new Error("The echartgl is already loaded (" + n + ").")) : a.handleScriptLoad(r, e, t)
                } else r = a.createScript(o, i), a.handleScriptLoad(r, function () {
                    r.setAttribute(o, "loaded"), e(r)
                }, t), document.head.appendChild(r)
            })
        }, ie.prototype.createScript = function (e, t) {
            var r = document.createElement("script");
            return r.type = "text/javascript", r.src = t, r.setAttribute(e, "loading"), r
        }, ie.prototype.handleScriptLoad = function (e, t, r) {
            var n;
            r && (n = this.handleScriptError(e, r));
            var o = function () {
                t(e), e.removeEventListener("load", o, !1), n && e.removeEventListener("error", n, !1)
            };
            e.addEventListener("load", o, !1)
        }, ie.prototype.handleScriptError = function (t, r) {
            var n = function (e) {
                r(e.error || new Error("There was an error attempting to load " + t.src)), t.removeEventListener("error", n, !1)
            };
            return t.addEventListener("error", n, !1), n
        }, ie.prototype.init = function (t) {
            return re(this, void 0, void 0, function () {
                return ne(this, function (e) {
                    return this.view = t, [2]
                })
            })
        }, ie);

    function ie(e) {
        var t = ee.call(this) || this;
        return t.view = null, t.init(e), t
    }
    var ae, se, le = (ae = function (e, t) {
            return (ae = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function (e, t) {
                    e.__proto__ = t
                } || function (e, t) {
                    for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r])
                })(e, t)
        }, function (e, t) {
            function r() {
                this.constructor = e
            }
            ae(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r)
        }),
        ce = function (e, a, s, l) {
            return new(s = s || Promise)(function (r, t) {
                function n(e) {
                    try {
                        i(l.next(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function o(e) {
                    try {
                        i(l.throw(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function i(e) {
                    var t;
                    e.done ? r(e.value) : ((t = e.value) instanceof s ? t : new s(function (e) {
                        e(t)
                    })).then(n, o)
                }
                i((l = l.apply(e, a || [])).next())
            })
        },
        ue = function (r, n) {
            var o, i, a, e, s = {
                label: 0,
                sent: function () {
                    if (1 & a[0]) throw a[1];
                    return a[1]
                },
                trys: [],
                ops: []
            };
            return e = {
                next: t(0),
                throw: t(1),
                return: t(2)
            }, "function" == typeof Symbol && (e[Symbol.iterator] = function () {
                return this
            }), e;

            function t(t) {
                return function (e) {
                    return function (t) {
                        if (o) throw new TypeError("Generator is already executing.");
                        for (; s;) try {
                            if (o = 1, i && (a = 2 & t[0] ? i.return : t[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, t[1])).done) return a;
                            switch (i = 0, a && (t = [2 & t[0], a.value]), t[0]) {
                                case 0:
                                case 1:
                                    a = t;
                                    break;
                                case 4:
                                    return s.label++, {
                                        value: t[1],
                                        done: !1
                                    };
                                case 5:
                                    s.label++, i = t[1], t = [0];
                                    continue;
                                case 7:
                                    t = s.ops.pop(), s.trys.pop();
                                    continue;
                                default:
                                    if (!(a = 0 < (a = s.trys).length && a[a.length - 1]) && (6 === t[0] || 2 === t[0])) {
                                        s = 0;
                                        continue
                                    }
                                    if (3 === t[0] && (!a || t[1] > a[0] && t[1] < a[3])) {
                                        s.label = t[1];
                                        break
                                    }
                                    if (6 === t[0] && s.label < a[1]) {
                                        s.label = a[1], a = t;
                                        break
                                    }
                                    if (a && s.label < a[2]) {
                                        s.label = a[2], s.ops.push(t);
                                        break
                                    }
                                    a[2] && s.ops.pop(), s.trys.pop();
                                    continue
                            }
                            t = n.call(r, s)
                        } catch (e) {
                            t = [6, e], i = 0
                        } finally {
                            o = a = 0
                        }
                        if (5 & t[0]) throw t[1];
                        return {
                            value: t[0] ? t[1] : void 0,
                            done: !0
                        }
                    }([t, e])
                }
            }
        },
        pe = (le(ye, se = e), ye.prototype.play = function (a) {
            var s = this;
            void 0 === a && (a = {}), g(["geolocate", "esri/widgets/Track", "esri/geometry/support/webMercatorUtils"]).then(function (e) {
                var r = e[0],
                    t = e[1],
                    n = e[2];
                if (void 0 !== a.coords) {
                    var o = 0;
                    s.track = new t({
                        view: s.view,
                        goToLocationEnabled: !1
                    });
                    var i = 0;
                    r.use(), void 0 !== s.routepalybackinternal && clearInterval(s.routepalybackinternal), s.routepalybackinternal = setInterval(function () {
                        var e = n.xyToLngLat(a.coords[i].x, a.coords[i].y),
                            t = {
                                lng: e[0],
                                lat: e[1]
                            };
                        r.change(t), i = (i + 1) % a.coords.length, ++o === a.coords.length && clearInterval(s.routepalybackinternal)
                    }, 2500), s.view.when(function () {
                        var t = s.view.center;
                        s.track.on("track", function () {
                            a.mobilesymbol && (s.track.graphic.symbol = a.mobilesymbol);
                            var e = s.track.graphic.geometry;
                            1 < o && a.showtrail && s.createAnimateRoute(e, t, a.trailsymbol), s.view.goTo({
                                center: e,
                                tilt: 70,
                                scale: 2500,
                                heading: 360 - s.getHeading(e, t),
                                rotation: 360 - s.getHeading(e, t)
                            }).catch(function (e) {
                                "AbortError" !== e.name && console.error(e)
                            }), t = e.clone()
                        }), s.track.start()
                    })
                }
            }).catch(function (e) {
                console.error(e)
            })
        }, ye.prototype.remove = function () {
            this.routepalybackinternal, clearInterval(this.routepalybackinternal), this.track.destroy();
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && this.view.map.remove(e)
        }, ye.prototype.getHeading = function (e, t) {
            return 180 * Math.atan2(e.y - t.y, e.x - t.x) / Math.PI - 90
        }, ye.prototype.createAnimateRoute = function (i, a, s) {
            var l = this;
            g(["esri/Graphic", "esri/layers/GraphicsLayer"]).then(function (e) {
                var t = e[0],
                    r = e[1],
                    n = new t({
                        geometry: {
                            type: "polyline",
                            paths: [
                                [a.longitude, a.latitude],
                                [i.longitude, i.latitude]
                            ]
                        },
                        symbol: void 0 !== s ? s : {
                            type: "simple-line",
                            color: [156, 39, 176],
                            width: 10
                        }
                    }),
                    o = l.view.map.findLayerById(l.displayedLayerid);
                void 0 === o && (o = new r({
                    title: "路径轨迹播放",
                    id: l.displayedLayerid,
                    listMode: "hide"
                }), l.view.map.add(o)), o.add(n)
            })
        }, ye.prototype.init = function (t) {
            return ce(this, void 0, void 0, function () {
                return ue(this, function (e) {
                    return this.displayedLayerid = (new L).uuid, this.view = t, [2]
                })
            })
        }, ye);

    function ye(e) {
        var t = se.call(this) || this;
        return t.displayedLayerid = "", t.view = null, t.routepalybackinternal = null, t.track = null, t.init(e), t
    }
    var de, fe, he = (de = function (e, t) {
            return (de = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function (e, t) {
                    e.__proto__ = t
                } || function (e, t) {
                    for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r])
                })(e, t)
        }, function (e, t) {
            function r() {
                this.constructor = e
            }
            de(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r)
        }),
        ve = function (e, a, s, l) {
            return new(s = s || Promise)(function (r, t) {
                function n(e) {
                    try {
                        i(l.next(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function o(e) {
                    try {
                        i(l.throw(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function i(e) {
                    var t;
                    e.done ? r(e.value) : ((t = e.value) instanceof s ? t : new s(function (e) {
                        e(t)
                    })).then(n, o)
                }
                i((l = l.apply(e, a || [])).next())
            })
        },
        me = function (r, n) {
            var o, i, a, e, s = {
                label: 0,
                sent: function () {
                    if (1 & a[0]) throw a[1];
                    return a[1]
                },
                trys: [],
                ops: []
            };
            return e = {
                next: t(0),
                throw: t(1),
                return: t(2)
            }, "function" == typeof Symbol && (e[Symbol.iterator] = function () {
                return this
            }), e;

            function t(t) {
                return function (e) {
                    return function (t) {
                        if (o) throw new TypeError("Generator is already executing.");
                        for (; s;) try {
                            if (o = 1, i && (a = 2 & t[0] ? i.return : t[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, t[1])).done) return a;
                            switch (i = 0, a && (t = [2 & t[0], a.value]), t[0]) {
                                case 0:
                                case 1:
                                    a = t;
                                    break;
                                case 4:
                                    return s.label++, {
                                        value: t[1],
                                        done: !1
                                    };
                                case 5:
                                    s.label++, i = t[1], t = [0];
                                    continue;
                                case 7:
                                    t = s.ops.pop(), s.trys.pop();
                                    continue;
                                default:
                                    if (!(a = 0 < (a = s.trys).length && a[a.length - 1]) && (6 === t[0] || 2 === t[0])) {
                                        s = 0;
                                        continue
                                    }
                                    if (3 === t[0] && (!a || t[1] > a[0] && t[1] < a[3])) {
                                        s.label = t[1];
                                        break
                                    }
                                    if (6 === t[0] && s.label < a[1]) {
                                        s.label = a[1], a = t;
                                        break
                                    }
                                    if (a && s.label < a[2]) {
                                        s.label = a[2], s.ops.push(t);
                                        break
                                    }
                                    a[2] && s.ops.pop(), s.trys.pop();
                                    continue
                            }
                            t = n.call(r, s)
                        } catch (e) {
                            t = [6, e], i = 0
                        } finally {
                            o = a = 0
                        }
                        if (5 & t[0]) throw t[1];
                        return {
                            value: t[0] ? t[1] : void 0,
                            done: !0
                        }
                    }([t, e])
                }
            }
        },
        we = (he(be, fe = e), be.prototype.play = function (y) {
            var d = this;
            void 0 === y && (y = {}), g(["esri/geometry/Point", "esri/Graphic", "esri/layers/GraphicsLayer", "esri/geometry/support/webMercatorUtils"]).then(function (e) {
                var o = e[0],
                    i = e[1],
                    a = e[2];
                if (e[3], void 0 !== y.coords) {
                    var s = 0,
                        l = 0,
                        c = d.view.center;
                    void 0 !== d.mapRoamplayinternal && clearInterval(d.mapRoamplayinternal);
                    var u = void 0 !== y.duration ? y.duration : 2e3,
                        p = void 0 !== y.speedFactor ? y.speedFactor : 1;
                    d.mapRoamplayinternal = setInterval(function () {
                        var e = {
                            x: y.coords[l].x,
                            y: y.coords[l].y,
                            z: void 0 !== y.coords[l].z ? y.coords[l].z : 0
                        };
                        l = (l + 1) % y.coords.length, ++s;
                        var t = new o({
                                x: e.x,
                                y: e.y,
                                z: e.z,
                                spatialReference: d.view.spatialReference
                            }),
                            r = d.view.map.findLayerById(d.mobilelayerid);
                        void 0 === r && (r = new a({
                            title: "漫游路径" + d.mobilelayerid,
                            id: d.mobilelayerid,
                            listMode: "hide"
                        }), d.view.map.add(r)), r.removeAll();
                        var n = new i({
                            geometry: t,
                            symbol: y.mobilesymbol
                        });
                        r.add(n), 1 < s && y.showtrail && d.createAnimateRoute(t, c, y.trailsymbol), d.view.goTo({
                            center: t,
                            tilt: 70,
                            scale: 2500,
                            heading: 360 - d.getHeading(t, c),
                            rotation: 360 - d.getHeading(t, c)
                        }, {
                            speedFactor: p,
                            duration: u - .2 * u,
                            maxDuration: u - .2 * u,
                            easing: "in-out-coast-quadratic"
                        }).then().catch(function (e) {
                            "AbortError" !== e.name && console.error(e)
                        }), c = t.clone(), s === y.coords.length && clearInterval(d.mapRoamplayinternal)
                    }, u)
                }
            }).catch(function (e) {
                console.error(e)
            })
        }, be.prototype.remove = function () {
            this.mapRoamplayinternal, clearInterval(this.mapRoamplayinternal);
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && this.view.map.remove(e);
            var t = this.view.map.findLayerById(this.mobilelayerid);
            t && this.view.map.remove(t)
        }, be.prototype.getHeading = function (e, t) {
            return 180 * Math.atan2(e.y - t.y, e.x - t.x) / Math.PI - 90
        }, be.prototype.createAnimateRoute = function (i, a, s) {
            var l = this;
            g(["esri/Graphic", "esri/layers/GraphicsLayer"]).then(function (e) {
                var t = e[0],
                    r = e[1],
                    n = new t({
                        geometry: {
                            type: "polyline",
                            paths: [
                                [a.x, a.y, a.z],
                                [i.x, i.y, i.z]
                            ],
                            spatialReference: l.view.spatialReference
                        },
                        symbol: void 0 !== s ? s : {
                            type: "simple-line",
                            color: [156, 39, 176],
                            width: 10
                        }
                    }),
                    o = l.view.map.findLayerById(l.displayedLayerid);
                void 0 === o && (o = new r({
                    title: "漫游路径" + l.displayedLayerid,
                    id: l.displayedLayerid,
                    listMode: "hide"
                }), l.view.map.add(o)), o.add(n)
            })
        }, be.prototype.init = function (t) {
            return ve(this, void 0, void 0, function () {
                return me(this, function (e) {
                    return this.displayedLayerid = (new L).uuid, this.mobilelayerid = (new L).uuid, this.view = t, [2]
                })
            })
        }, be);

    function be(e) {
        var t = fe.call(this) || this;
        return t.displayedLayerid = "", t.view = null, t.mapRoamplayinternal = null, t.mobilelayerid = "", t.init(e), t
    }
    return {
        load: g,
        Layers: U,
        Boundary: P,
        FlashPoint3DLayer: M,
        HeatMap: N,
        MaskBoundary: Y,
        TrajectoryPlus: we,
        MigrationMap: oe,
        Trajectory: pe
    }
});
//# sourceMappingURL=Plugins.min.js.map
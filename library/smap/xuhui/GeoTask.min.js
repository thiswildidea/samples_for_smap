! function (e, t) {
    "object" == typeof exports && "undefined" != typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define(t) : e.GeoTask = t()
}(this, function () {
    "use strict";
    var e = (t.prototype._addListener = function (e, t, i) {
        if (this.emit("newListener", e, t), this.events.has(e)) {
            var r = this.events.get(e);
            i ? r.unshift(t) : r.push(t)
        } else this.events.set(e, [t]);
        var n = this.getMaxListeners();
        if (0 < n && this.listenerCount(e) > n) {
            var o = new Error("Possible EventEmitter memory leak detected.\n         " + this.listenerCount(e) + " " + e.toString() + " listeners.\n         Use emitter.setMaxListeners() to increase limit");
            o.name = "MaxListenersExceededWarning", console.warn(o)
        }
        return this
    }, t.prototype.addListener = function (e, t) {
        return this._addListener(e, t, !1)
    }, t.prototype.emit = function (e) {
        for (var t = [], i = 1; i < arguments.length; i++) t[i - 1] = arguments[i];
        if (this.events.has(e)) {
            for (var r = 0, n = this.events.get(e).slice(); r < n.length; r++) {
                var o = n[r];
                try {
                    o.apply(this, t)
                } catch (e) {
                    this.emit("error", e)
                }
            }
            return !0
        }
        if ("error" === e) throw 0 < t.length ? t[0] : Error("Unhandled error.");
        return !1
    }, t.prototype.eventNames = function () {
        return Array.from(this.events.keys())
    }, t.prototype.getMaxListeners = function () {
        return this.maxListeners || t.defaultMaxListeners
    }, t.prototype.listenerCount = function (e) {
        return this.events.has(e) ? this.events.get(e).length : 0
    }, t.prototype._listeners = function (e, t, i) {
        if (!e.events.has(t)) return [];
        var r = e.events.get(t);
        return i ? this.unwrapListeners(r) : r.slice(0)
    }, t.prototype.unwrapListeners = function (e) {
        for (var t = new Array(e.length), i = 0; i < e.length; i++) t[i] = e[i].listener || e[i];
        return t
    }, t.prototype.listeners = function (e) {
        return this._listeners(this, e, !0)
    }, t.prototype.rawListeners = function (e) {
        return this._listeners(this, e, !1)
    }, t.prototype.off = function (e, t) {
        return this.removeListener(e, t)
    }, t.prototype.on = function (e, t) {
        return this.addListener(e, t)
    }, t.prototype.once = function (e, t) {
        var i = this.onceWrap(e, t);
        return this.on(e, i), this
    }, t.prototype.onceWrap = function (e, t) {
        function i() {
            for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];
            this.context.removeListener(this.eventName, this.rawListener), this.listener.apply(this.context, e)
        }
        var r = {
                eventName: e,
                listener: t,
                rawListener: i,
                context: this
            },
            n = i.bind(r);
        return (r.rawListener = n).listener = t, n
    }, t.prototype.prependListener = function (e, t) {
        return this._addListener(e, t, !0)
    }, t.prototype.prependOnceListener = function (e, t) {
        var i = this.onceWrap(e, t);
        return this.prependListener(e, i), this
    }, t.prototype.removeAllListeners = function (e) {
        var t = this;
        if (void 0 === this.events) return this;
        if (this.events.has(e)) {
            var i = this.events.get(e).slice();
            this.events.delete(e);
            for (var r = 0, n = i; r < n.length; r++) {
                var o = n[r];
                this.emit("removeListener", e, o)
            }
        } else this.eventNames().map(function (e) {
            t.removeAllListeners(e)
        });
        return this
    }, t.prototype.removeListener = function (e, t) {
        if (this.events.has(e)) {
            var i = this.events.get(e); - 1 !== i.indexOf(t) && (i.splice(i.indexOf(t), 1), this.emit("removeListener", e, t), 0 === i.length && this.events.delete(e))
        }
        return this
    }, t.prototype.setMaxListeners = function (e) {
        return this.maxListeners = e, this
    }, t.defaultMaxListeners = 50, t);

    function t() {
        this.events = new Map
    }
    var d = (i.jsapi = "http://10.201.37.225:8080/smiapi/arcgis", i.jsapiversion4X = "4.15", i);

    function i() {}
    var s = d.jsapiversion4X,
        n = "next";

    function o(e) {
        if (null === e && (e = s), e.toString().toLowerCase() === n) return n;
        var t = e && e.match(/^(\d)\.(\d+)/);
        return t && {
            major: parseInt(t[1], 10),
            minor: parseInt(t[2], 10)
        }
    }

    function a(e) {
        return void 0 === e && (e = s), d.jsapi + "/" + e + "/init.js"
    }

    function u(e) {
        var t = document.createElement("link");
        return t.rel = "stylesheet", t.href = e, t
    }

    function l(e, t) {
        if (t) {
            var i = document.querySelector(t);
            i.parentNode.insertBefore(e, i)
        } else document.head.appendChild(e)
    }

    function c(e) {
        return document.querySelector('link[href*="' + e + '"]')
    }

    function p(e) {
        return !e || o(e) ? function (e) {
            void 0 === e && (e = s), null === e && (e = s);
            var t = a(e),
                i = t.substring(0, t.indexOf("init.js")),
                r = o(e);
            return r === n || 3 !== r.major ? i + "esri/themes/light/main.css" : i + (r.minor <= 10 ? "js/" : "") + "esri/css/esri.css"
        }(e) : e
    }

    function h(e, t) {
        var i = p(e),
            r = c(i);
        if (r || l(r = u(i), t), 4 === function (e) {
                null === e && (e = s);
                var t = e && e.match(/^(\d)\.(\d+)/);
                return t && {
                    major: parseInt(t[1], 10),
                    minor: parseInt(t[2], 10)
                }
            }(e).major) {
            var n = i.substring(0, i.indexOf("esri/themes/")) + "esri/themes/gis/css/gis.css",
                o = c(n);
            o || l(o = u(n), t)
        }
        return r
    }
    var r = {
            Promise: "undefined" != typeof window ? window.Promise : void 0
        },
        y = {};

    function f(e, t, i) {
        var r, n, o, s;
        i && (o = i, s = function (e) {
            o(e.error || new Error("There was an error attempting to load " + n.src)), n.removeEventListener("error", s, !1)
        }, (n = e).addEventListener("error", s, !1), r = s);
        var a = function () {
            t(e), e.removeEventListener("load", a, !1), r && e.removeEventListener("error", r, !1)
        };
        e.addEventListener("load", a, !1)
    }

    function v() {
        return document.querySelector("script[data-shsmi]")
    }

    function m() {
        var e = window.require;
        return e && e.on
    }

    function w(e) {
        void 0 === e && (e = {});
        var u = {};
        [y, e].forEach(function (e) {
            for (var t in e) Object.prototype.hasOwnProperty.call(e, t) && (u[t] = e[t])
        });
        var l = u.version,
            c = u.url || a(l);
        return new r.Promise(function (e, t) {
            var i, r, n = v();
            if (n) {
                var o = n.getAttribute("src");
                o !== c ? t(new Error("The ArcGIS API for JavaScript is already loaded (" + o + ").")) : m() ? e(n) : f(n, e, t)
            } else if (m()) t(new Error("The ArcGIS API for JavaScript is already loaded."));
            else {
                var s = u.css;
                if (s) h(!0 === s ? l : s, u.insertCssBefore);
                else h(null, u.insertCssBefore);
                if (u.dojoConfig) window.dojoConfig = u.dojoConfig;
                else {
                    var a = {
                        async: !0,
                        packages: [{
                            location: d.jsapi + "/extensions",
                            name: "smiapi"
                        }, {
                            location: d.jsapi + "/extensions/geolocation",
                            name: "geolocate",
                            main: "geolocate"
                        }],
                        deps: ["@dojo/framework/shim/main"],
                        has: {
                            "esri-promise-compatibility": 1,
                            "esri-featurelayer-webgl": 1
                        }
                    };
                    window.dojoConfig = a
                }
                i = c, (r = document.createElement("script")).type = "text/javascript", r.src = i, r.setAttribute("data-shsmi", "loading"), f(n = r, function () {
                    n.setAttribute("data-shsmi", "loaded"), e(n)
                }, t), document.head.appendChild(n)
            }
        })
    }

    function g(t) {
        return new r.Promise(function (i, e) {
            var r = window.require.on("error", e);
            window.require(t, function () {
                for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];
                r.remove(), i(e)
            })
        })
    }

    function b(e, t) {
        if (void 0 === t && (t = {}), m()) return g(e);
        var i = v(),
            r = i && i.getAttribute("src");
        return !t.url && r && (t.url = r), w(t).then(function () {
            return g(e)
        })
    }
    var L = (x.prototype.S4 = function () {
        return (65536 * (1 + Math.random()) | 0).toString(16).substring(1)
    }, x.prototype.get_uuid = function () {
        return this.S4() + this.S4() + "-" + this.S4() + "-" + this.S4() + "-" + this.S4() + "-" + this.S4() + this.S4() + this.S4()
    }, x);

    function x() {
        this.uuid = this.get_uuid()
    }
    var I = (k.maploaded = "maploaded", k.zoomchanged = "zoomchanged", k.extentchanged = "extentchanged", k.centerchanged = "centerchanged", k.blur = "blur", k.click = "click", k.doubleclick = "doubleclick", k.drag = "drag", k.focus = "focus", k.hold = "hold", k.keydown = "key-down", k.keyup = "key-up", k.mousewheel = "mouse-wheel", k.pointerdown = "pointer-down", k.pointerenter = "pointer-enter", k.pointerleave = "pointer-leave", k.pointermove = "pointer-move", k.pointerup = "pointer-up", k.resize = "pointer-up", k.popupvisible = "popup-visible", k);

    function k() {}
    var q, j, S = (q = function (e, t) {
            return (q = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function (e, t) {
                    e.__proto__ = t
                } || function (e, t) {
                    for (var i in t) t.hasOwnProperty(i) && (e[i] = t[i])
                })(e, t)
        }, function (e, t) {
            function i() {
                this.constructor = e
            }
            q(e, t), e.prototype = null === t ? Object.create(t) : (i.prototype = t.prototype, new i)
        }),
        _ = function (e, s, a, u) {
            return new(a = a || Promise)(function (i, t) {
                function r(e) {
                    try {
                        o(u.next(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function n(e) {
                    try {
                        o(u.throw(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function o(e) {
                    var t;
                    e.done ? i(e.value) : ((t = e.value) instanceof a ? t : new a(function (e) {
                        e(t)
                    })).then(r, n)
                }
                o((u = u.apply(e, s || [])).next())
            })
        },
        M = function (i, r) {
            var n, o, s, e, a = {
                label: 0,
                sent: function () {
                    if (1 & s[0]) throw s[1];
                    return s[1]
                },
                trys: [],
                ops: []
            };
            return e = {
                next: t(0),
                throw: t(1),
                return: t(2)
            }, "function" == typeof Symbol && (e[Symbol.iterator] = function () {
                return this
            }), e;

            function t(t) {
                return function (e) {
                    return function (t) {
                        if (n) throw new TypeError("Generator is already executing.");
                        for (; a;) try {
                            if (n = 1, o && (s = 2 & t[0] ? o.return : t[0] ? o.throw || ((s = o.return) && s.call(o), 0) : o.next) && !(s = s.call(o, t[1])).done) return s;
                            switch (o = 0, s && (t = [2 & t[0], s.value]), t[0]) {
                                case 0:
                                case 1:
                                    s = t;
                                    break;
                                case 4:
                                    return a.label++, {
                                        value: t[1],
                                        done: !1
                                    };
                                case 5:
                                    a.label++, o = t[1], t = [0];
                                    continue;
                                case 7:
                                    t = a.ops.pop(), a.trys.pop();
                                    continue;
                                default:
                                    if (!(s = 0 < (s = a.trys).length && s[s.length - 1]) && (6 === t[0] || 2 === t[0])) {
                                        a = 0;
                                        continue
                                    }
                                    if (3 === t[0] && (!s || t[1] > s[0] && t[1] < s[3])) {
                                        a.label = t[1];
                                        break
                                    }
                                    if (6 === t[0] && a.label < s[1]) {
                                        a.label = s[1], s = t;
                                        break
                                    }
                                    if (s && a.label < s[2]) {
                                        a.label = s[2], a.ops.push(t);
                                        break
                                    }
                                    s[2] && a.ops.pop(), a.trys.pop();
                                    continue
                            }
                            t = r.call(i, a)
                        } catch (e) {
                            t = [6, e], o = 0
                        } finally {
                            n = s = 0
                        }
                        if (5 & t[0]) throw t[1];
                        return {
                            value: t[0] ? t[1] : void 0,
                            done: !0
                        }
                    }([t, e])
                }
            }
        },
        P = (S(E, j = e), E.prototype.MapService = function (d) {
            return _(this, void 0, void 0, function () {
                var c, t = this;
                return M(this, function (e) {
                    switch (e.label) {
                        case 0:
                            return c = null, [4, b(["esri/layers/GraphicsLayer", "esri/Graphic", "esri/tasks/IdentifyTask", "esri/tasks/support/IdentifyParameters"]).then(function (e) {
                                var s = e[0],
                                    a = e[1],
                                    u = e[2],
                                    l = e[3];
                                return _(t, void 0, void 0, function () {
                                    var t, i, r, n, o = this;
                                    return M(this, function (e) {
                                        switch (e.label) {
                                            case 0:
                                                return this.view ? (t = null, d.layerUniqueId && (i = this.view.map.findLayerById(d.layerUniqueId)) && (t = i.url), (t = t || d.url) ? (r = new u(t), (n = new l).tolerance = void 0 === d.tolerance ? 20 : d.tolerance, n.layerIds = void 0 === d.layerIds ? ["*"] : d.layerIds, n.geometry = d.geometry, n.mapExtent = this.view.extent, n.returnGeometry = !0, [4, r.execute(n).then(function (e) {
                                                    if (0 < e.results.length && d.displayed) {
                                                        var r = o.view.map.findLayerById(o.displayedLayerid);
                                                        void 0 === r && (r = new s({
                                                            title: o.displayedLayerid + "查询结果",
                                                            id: o.displayedLayerid,
                                                            listMode: "hide"
                                                        }), o.view.map.add(r)), e.results.map(function (e) {
                                                            var t = null;
                                                            t = "point" === e.feature.geometry.type ? d.marksymbol ? d.marksymbol : {
                                                                type: "simple-marker",
                                                                style: "square",
                                                                color: [255, 0, 0, .2],
                                                                size: "8px",
                                                                outline: {
                                                                    color: [255, 0, 0, 1],
                                                                    width: 1
                                                                }
                                                            } : "polyline" === e.feature.geometry.type ? d.marksymbol ? d.linesymbol : {
                                                                type: "simple-line",
                                                                color: [255, 0, 0, 1],
                                                                width: "2px",
                                                                style: "short-dot"
                                                            } : d.polygonsymbol ? d.polygonsymbol : {
                                                                type: "simple-fill",
                                                                color: [255, 255, 255, .2],
                                                                outline: {
                                                                    color: [255, 0, 0, 1],
                                                                    width: "5px"
                                                                }
                                                            }, e.feature.geometry.spatialReference = o.view.spatialReference;
                                                            var i = new a({
                                                                geometry: e.feature.geometry,
                                                                attributes: e.feature.attributes,
                                                                symbol: t
                                                            });
                                                            r.add(i)
                                                        })
                                                    }
                                                    c = e
                                                })]) : [2]) : [2];
                                            case 1:
                                                return e.sent(), [2]
                                        }
                                    })
                                })
                            })];
                        case 1:
                            return e.sent(), [2, new r.Promise(function (e, t) {
                                e(c)
                            })]
                    }
                })
            })
        }, E.prototype.FeatureService = function (u) {
            return _(this, void 0, void 0, function () {
                var a, t = this;
                return M(this, function (e) {
                    switch (e.label) {
                        case 0:
                            return a = null, [4, b(["esri/layers/GraphicsLayer", "esri/Graphic", "esri/layers/FeatureLayer"]).then(function (e) {
                                var o = e[0],
                                    s = e[1],
                                    r = e[2];
                                return _(t, void 0, void 0, function () {
                                    var t, i, n = this;
                                    return M(this, function (e) {
                                        switch (e.label) {
                                            case 0:
                                                return this.view ? (u.layerUniqueId && (t = this.view.map.findLayerById(u.layerUniqueId)), t || u.url && (t = new r({
                                                    url: u.url,
                                                    id: u.layerUniqueId,
                                                    title: u.layerUniqueId,
                                                    visible: !1
                                                }), this.view.map.add(t)), t ? ((i = t.createQuery()).geometry = u.geometry, [4, t.queryFeatures(i).then(function (e) {
                                                    if (0 < e.features.length) {
                                                        if (u.displayed) {
                                                            var r = n.view.map.findLayerById(n.displayedLayerid);
                                                            void 0 === r && (r = new o({
                                                                title: n.displayedLayerid + "查询结果",
                                                                id: n.displayedLayerid,
                                                                listMode: "hide"
                                                            }), n.view.map.add(r)), e.features.map(function (e) {
                                                                var t = null;
                                                                t = "point" === e.geometry.type ? u.marksymbol ? u.marksymbol : {
                                                                    type: "simple-marker",
                                                                    style: "square",
                                                                    color: [255, 0, 0, .2],
                                                                    size: "8px",
                                                                    outline: {
                                                                        color: [255, 0, 0, 1],
                                                                        width: 1
                                                                    }
                                                                } : "polyline" === e.geometry.type ? u.marksymbol ? u.linesymbol : {
                                                                    type: "simple-line",
                                                                    color: [255, 0, 0, 1],
                                                                    width: "2px",
                                                                    style: "short-dot"
                                                                } : u.polygonsymbol ? u.polygonsymbol : {
                                                                    type: "simple-fill",
                                                                    color: [255, 255, 255, .2],
                                                                    outline: {
                                                                        color: [255, 0, 0, 1],
                                                                        width: "5px"
                                                                    }
                                                                }, e.geometry.spatialReference = n.view.spatialReference;
                                                                var i = new s({
                                                                    geometry: e.geometry,
                                                                    attributes: e.attributes,
                                                                    symbol: t
                                                                });
                                                                r.add(i)
                                                            })
                                                        }
                                                        a = e
                                                    }
                                                })]) : [2]) : [2];
                                            case 1:
                                                return e.sent(), [2]
                                        }
                                    })
                                })
                            })];
                        case 1:
                            return e.sent(), [2, new r.Promise(function (e, t) {
                                e(a)
                            })]
                    }
                })
            })
        }, E.prototype.SceneService = function (o) {
            return _(this, void 0, void 0, function () {
                var n, t = this;
                return M(this, function (e) {
                    switch (e.label) {
                        case 0:
                            return n = null, [4, b(["esri/layers/GraphicsLayer", "esri/Graphic", "esri/layers/SceneLayer"]).then(function (e) {
                                e[0], e[1];
                                var r = e[2];
                                return _(t, void 0, void 0, function () {
                                    var t, i;
                                    return M(this, function (e) {
                                        switch (e.label) {
                                            case 0:
                                                return this.view ? (o.layerUniqueId && (t = this.view.map.findLayerById(o.layerUniqueId)), t || o.url && (t = new r({
                                                    url: o.url,
                                                    id: o.layerUniqueId,
                                                    title: o.layerUniqueId,
                                                    visible: !1
                                                }), this.view.map.add(t)), t ? ((i = t.createQuery()).geometry = o.geometry, [4, t.queryFeatures(i).then(function (e) {
                                                    0 < e.features.length && (console.log(e.features), n = e)
                                                })]) : [2]) : [2];
                                            case 1:
                                                return e.sent(), [2]
                                        }
                                    })
                                })
                            })];
                        case 1:
                            return e.sent(), [2, new r.Promise(function (e, t) {
                                e(n)
                            })]
                    }
                })
            })
        }, E.prototype.remove = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && this.view.map.remove(e)
        }, E.prototype.show = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && (e.visible = !0)
        }, E.prototype.hide = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && (e.visible = !1)
        }, E.prototype.init = function (t) {
            return _(this, void 0, void 0, function () {
                var r = this;
                return M(this, function (e) {
                    return this.displayedLayerid = (new L).uuid, this.view = t, this.view.on(I.click, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return _(r, void 0, void 0, function () {
                                return M(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.click, t.results[0].graphic, i.mapPoint), [2]
                                })
                            })
                        })
                    }), this.view.on(I.pointermove, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return _(r, void 0, void 0, function () {
                                return M(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.pointermove, t.results[0].graphic, this.view.toMap({
                                        x: i.x,
                                        y: i.y
                                    })), [2]
                                })
                            })
                        })
                    }), this.view.on(I.pointerenter, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return _(r, void 0, void 0, function () {
                                return M(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.pointerenter, t.results[0].graphic, this.view.toMap({
                                        x: i.x,
                                        y: i.y
                                    })), [2]
                                })
                            })
                        })
                    }), this.view.on(I.pointerleave, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return _(r, void 0, void 0, function () {
                                return M(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.pointerleave, t.results[0].graphic, this.view.toMap({
                                        x: i.x,
                                        y: i.y
                                    })), [2]
                                })
                            })
                        })
                    }), this.view.on(I.doubleclick, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return _(r, void 0, void 0, function () {
                                return M(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.doubleclick, t.results[0].graphic, this.view.toMap({
                                        x: i.x,
                                        y: i.y
                                    })), [2]
                                })
                            })
                        })
                    }), [2]
                })
            })
        }, E);

    function E(e) {
        var t = j.call(this) || this;
        return t.view = null, t.displayedLayerid = "", t.init(e), t
    }
    var B = (T.shqxboundary = "qx_boundary", T.shjdboundary = "jd_boundary", T.shjwhboundary = "jwh_boundary", T);

    function T() {}
    var U, G, O = (U = function (e, t) {
            return (U = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function (e, t) {
                    e.__proto__ = t
                } || function (e, t) {
                    for (var i in t) t.hasOwnProperty(i) && (e[i] = t[i])
                })(e, t)
        }, function (e, t) {
            function i() {
                this.constructor = e
            }
            U(e, t), e.prototype = null === t ? Object.create(t) : (i.prototype = t.prototype, new i)
        }),
        A = function (e, s, a, u) {
            return new(a = a || Promise)(function (i, t) {
                function r(e) {
                    try {
                        o(u.next(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function n(e) {
                    try {
                        o(u.throw(e))
                    } catch (e) {
                        t(e)
                    }
                }

                function o(e) {
                    var t;
                    e.done ? i(e.value) : ((t = e.value) instanceof a ? t : new a(function (e) {
                        e(t)
                    })).then(r, n)
                }
                o((u = u.apply(e, s || [])).next())
            })
        },
        C = function (i, r) {
            var n, o, s, e, a = {
                label: 0,
                sent: function () {
                    if (1 & s[0]) throw s[1];
                    return s[1]
                },
                trys: [],
                ops: []
            };
            return e = {
                next: t(0),
                throw: t(1),
                return: t(2)
            }, "function" == typeof Symbol && (e[Symbol.iterator] = function () {
                return this
            }), e;

            function t(t) {
                return function (e) {
                    return function (t) {
                        if (n) throw new TypeError("Generator is already executing.");
                        for (; a;) try {
                            if (n = 1, o && (s = 2 & t[0] ? o.return : t[0] ? o.throw || ((s = o.return) && s.call(o), 0) : o.next) && !(s = s.call(o, t[1])).done) return s;
                            switch (o = 0, s && (t = [2 & t[0], s.value]), t[0]) {
                                case 0:
                                case 1:
                                    s = t;
                                    break;
                                case 4:
                                    return a.label++, {
                                        value: t[1],
                                        done: !1
                                    };
                                case 5:
                                    a.label++, o = t[1], t = [0];
                                    continue;
                                case 7:
                                    t = a.ops.pop(), a.trys.pop();
                                    continue;
                                default:
                                    if (!(s = 0 < (s = a.trys).length && s[s.length - 1]) && (6 === t[0] || 2 === t[0])) {
                                        a = 0;
                                        continue
                                    }
                                    if (3 === t[0] && (!s || t[1] > s[0] && t[1] < s[3])) {
                                        a.label = t[1];
                                        break
                                    }
                                    if (6 === t[0] && a.label < s[1]) {
                                        a.label = s[1], s = t;
                                        break
                                    }
                                    if (s && a.label < s[2]) {
                                        a.label = s[2], a.ops.push(t);
                                        break
                                    }
                                    s[2] && a.ops.pop(), a.trys.pop();
                                    continue
                            }
                            t = r.call(i, a)
                        } catch (e) {
                            t = [6, e], o = 0
                        } finally {
                            n = s = 0
                        }
                        if (5 & t[0]) throw t[1];
                        return {
                            value: t[0] ? t[1] : void 0,
                            done: !0
                        }
                    }([t, e])
                }
            }
        },
        F = (O(R, G = e), R.prototype.featureLayer = function (u) {
            return void 0 === u && (u = {}), A(this, void 0, void 0, function () {
                var a, t = this;
                return C(this, function (e) {
                    switch (e.label) {
                        case 0:
                            return a = null, [4, b(["esri/layers/GraphicsLayer", "esri/Graphic", "esri/layers/FeatureLayer"]).then(function (e) {
                                var o = e[0],
                                    s = e[1],
                                    r = e[2];
                                return A(t, void 0, void 0, function () {
                                    var t, i, n = this;
                                    return C(this, function (e) {
                                        switch (e.label) {
                                            case 0:
                                                return this.view ? (u.layerUniqueId && (t = this.view.map.findLayerById(u.layerUniqueId)), t || u.url && (t = new r({
                                                    url: u.url,
                                                    id: u.layerUniqueId,
                                                    title: u.layerUniqueId,
                                                    visible: !1
                                                }), this.view.map.add(t)), t ? ((i = t.createQuery()).where = u.queryDefinition, i.outFields = void 0 === u.outFields ? ["*"] : u.outFields, [4, t.queryFeatures(i).then(function (e) {
                                                    if (0 < e.features.length) {
                                                        var i, r = n.view.map.findLayerById(n.displayedLayerid);
                                                        void 0 === r && (r = new o({
                                                            title: n.displayedLayerid + "查询结果",
                                                            id: n.displayedLayerid,
                                                            listMode: "hide"
                                                        }), n.view.map.add(r)), u.displayed && (u.symbol ? i = u.symbol : "polygon" === u.type ? i = {
                                                            type: "simple-fill",
                                                            color: [255, 255, 255, 0],
                                                            outline: {
                                                                color: [255, 0, 0, 1],
                                                                width: "5px"
                                                            }
                                                        } : "polyline" === u.type ? i = {
                                                            type: "simple-line",
                                                            color: [255, 0, 0, 0],
                                                            width: "2px",
                                                            style: "short-dot"
                                                        } : "point" === u.type && (i = {
                                                            type: "simple-marker",
                                                            style: "square",
                                                            color: [255, 0, 0, 0],
                                                            size: "8px",
                                                            outline: {
                                                                color: [255, 0, 0, 0],
                                                                width: 1
                                                            }
                                                        }), e.features.map(function (e) {
                                                            e.geometry.spatialReference = n.view.spatialReference;
                                                            var t = new s({
                                                                geometry: e.geometry,
                                                                attributes: e.attributes,
                                                                symbol: i
                                                            });
                                                            r.add(t)
                                                        })), a = e
                                                    }
                                                })]) : [2]) : [2];
                                            case 1:
                                                return e.sent(), [2]
                                        }
                                    })
                                })
                            })];
                        case 1:
                            return e.sent(), [2, new r.Promise(function (e, t) {
                                e(a)
                            })]
                    }
                })
            })
        }, R.prototype.mapImageLayer = function (d) {
            return void 0 === d && (d = {}), A(this, void 0, void 0, function () {
                var c, t = this;
                return C(this, function (e) {
                    switch (e.label) {
                        case 0:
                            return c = null, [4, b(["esri/layers/GraphicsLayer", "esri/Graphic", "esri/tasks/QueryTask", "esri/tasks/support/Query"]).then(function (e) {
                                var s = e[0],
                                    a = e[1],
                                    u = e[2],
                                    l = e[3];
                                return A(t, void 0, void 0, function () {
                                    var t, i, r, n, o = this;
                                    return C(this, function (e) {
                                        switch (e.label) {
                                            case 0:
                                                return d.layerUniqueId ? (i = this.view.map.findLayerById(d.layerUniqueId)) && (t = i.url) : t = d.url, d.layerId ? (r = new u({
                                                    url: t + "/" + d.layerId
                                                }), (n = new l).returnGeometry = !0, n.outFields = void 0 === d.outFields ? ["*"] : d.outFields, [4, r.execute(n).then(function (e) {
                                                    if (0 < e.features.length) {
                                                        var i, r = o.view.map.findLayerById(o.displayedLayerid);
                                                        void 0 === r && (r = new s({
                                                            title: o.displayedLayerid + "查询结果",
                                                            id: o.displayedLayerid,
                                                            listMode: "hide"
                                                        }), o.view.map.add(r)), d.displayed && (d.symbol ? i = d.symbol : "polygon" === d.type ? i = {
                                                            type: "simple-fill",
                                                            color: [255, 255, 255, 0],
                                                            outline: {
                                                                color: [255, 0, 0, 1],
                                                                width: "5px"
                                                            }
                                                        } : "polyline" === d.type ? i = {
                                                            type: "simple-line",
                                                            color: [255, 0, 0, 0],
                                                            width: "2px",
                                                            style: "short-dot"
                                                        } : "point" === d.type && (i = {
                                                            type: "simple-marker",
                                                            style: "square",
                                                            color: [255, 0, 0, 0],
                                                            size: "8px",
                                                            outline: {
                                                                color: [255, 0, 0, 0],
                                                                width: 1
                                                            }
                                                        }), e.features.map(function (e) {
                                                            e.geometry.spatialReference = o.view.spatialReference;
                                                            var t = new a({
                                                                geometry: e.geometry,
                                                                attributes: e.attributes,
                                                                symbol: i
                                                            });
                                                            r.add(t)
                                                        })), c = e
                                                    }
                                                })]) : [2];
                                            case 1:
                                                return e.sent(), [2]
                                        }
                                    })
                                })
                            })];
                        case 1:
                            return e.sent(), [2, new r.Promise(function (e, t) {
                                e(c)
                            })]
                    }
                })
            })
        }, R.prototype.remove = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && this.view.map.remove(e)
        }, R.prototype.show = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && (e.visible = !0)
        }, R.prototype.hide = function () {
            var e = this.view.map.findLayerById(this.displayedLayerid);
            e && (e.visible = !1)
        }, R.prototype.init = function (t) {
            return A(this, void 0, void 0, function () {
                var r = this;
                return C(this, function (e) {
                    return this.displayedLayerid = (new L).uuid, this.view = t, this.view.on(I.click, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return A(r, void 0, void 0, function () {
                                return C(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.click, t.results[0].graphic, i.mapPoint), [2]
                                })
                            })
                        })
                    }), this.view.on(I.pointermove, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return A(r, void 0, void 0, function () {
                                return C(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.pointermove, t.results[0].graphic, this.view.toMap({
                                        x: i.x,
                                        y: i.y
                                    })), [2]
                                })
                            })
                        })
                    }), this.view.on(I.pointerenter, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return A(r, void 0, void 0, function () {
                                return C(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.pointerenter, t.results[0].graphic, this.view.toMap({
                                        x: i.x,
                                        y: i.y
                                    })), [2]
                                })
                            })
                        })
                    }), this.view.on(I.pointerleave, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return A(r, void 0, void 0, function () {
                                return C(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.pointerleave, t.results[0].graphic, this.view.toMap({
                                        x: i.x,
                                        y: i.y
                                    })), [2]
                                })
                            })
                        })
                    }), this.view.on(I.doubleclick, function (i) {
                        r.view.hitTest(i).then(function (t) {
                            return A(r, void 0, void 0, function () {
                                return C(this, function (e) {
                                    return 0 < t.results.length && t.results[0].graphic.layer.id === this.displayedLayerid && this.emit(I.doubleclick, t.results[0].graphic, this.view.toMap({
                                        x: i.x,
                                        y: i.y
                                    })), [2]
                                })
                            })
                        })
                    }), [2]
                })
            })
        }, R);

    function R(e) {
        var t = G.call(this) || this;
        return t.view = null, t.displayedLayerid = "", t.init(e), t
    }
    return {
        load: b,
        Layers: B,
        Identify: P,
        Query: F
    }
});
//# sourceMappingURL=GeoTask.min.js.map
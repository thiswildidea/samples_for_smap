!function (e, t) { "object" == typeof exports && "undefined" != typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define(t) : e.Plugins = t() }(this, function () { "use strict"; var e = (t.prototype._addListener = function (e, t, i) { if (this.emit("newListener", e, t), this.events.has(e)) { var r = this.events.get(e); i ? r.unshift(t) : r.push(t) } else this.events.set(e, [t]); var o = this.getMaxListeners(); if (0 < o && this.listenerCount(e) > o) { var n = new Error("Possible EventEmitter memory leak detected.\n         " + this.listenerCount(e) + " " + e.toString() + " listeners.\n         Use emitter.setMaxListeners() to increase limit"); n.name = "MaxListenersExceededWarning", console.warn(n) } return this }, t.prototype.addListener = function (e, t) { return this._addListener(e, t, !1) }, t.prototype.emit = function (e) { for (var t = [], i = 1; i < arguments.length; i++)t[i - 1] = arguments[i]; if (this.events.has(e)) { for (var r = 0, o = this.events.get(e).slice(); r < o.length; r++) { var n = o[r]; try { n.apply(this, t) } catch (e) { this.emit("error", e) } } return !0 } if ("error" === e) throw 0 < t.length ? t[0] : Error("Unhandled error."); return !1 }, t.prototype.eventNames = function () { return Array.from(this.events.keys()) }, t.prototype.getMaxListeners = function () { return this.maxListeners || t.defaultMaxListeners }, t.prototype.listenerCount = function (e) { return this.events.has(e) ? this.events.get(e).length : 0 }, t.prototype._listeners = function (e, t, i) { if (!e.events.has(t)) return []; var r = e.events.get(t); return i ? this.unwrapListeners(r) : r.slice(0) }, t.prototype.unwrapListeners = function (e) { for (var t = new Array(e.length), i = 0; i < e.length; i++)t[i] = e[i].listener || e[i]; return t }, t.prototype.listeners = function (e) { return this._listeners(this, e, !0) }, t.prototype.rawListeners = function (e) { return this._listeners(this, e, !1) }, t.prototype.off = function (e, t) { return this.removeListener(e, t) }, t.prototype.on = function (e, t) { return this.addListener(e, t) }, t.prototype.once = function (e, t) { var i = this.onceWrap(e, t); return this.on(e, i), this }, t.prototype.onceWrap = function (e, t) { function i() { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; this.context.removeListener(this.eventName, this.rawListener), this.listener.apply(this.context, e) } var r = { eventName: e, listener: t, rawListener: i, context: this }, o = i.bind(r); return (r.rawListener = o).listener = t, o }, t.prototype.prependListener = function (e, t) { return this._addListener(e, t, !0) }, t.prototype.prependOnceListener = function (e, t) { var i = this.onceWrap(e, t); return this.prependListener(e, i), this }, t.prototype.removeAllListeners = function (e) { var t = this; if (void 0 === this.events) return this; if (this.events.has(e)) { var i = this.events.get(e).slice(); this.events.delete(e); for (var r = 0, o = i; r < o.length; r++) { var n = o[r]; this.emit("removeListener", e, n) } } else this.eventNames().map(function (e) { t.removeAllListeners(e) }); return this }, t.prototype.removeListener = function (e, t) { if (this.events.has(e)) { var i = this.events.get(e); -1 !== i.indexOf(t) && (i.splice(i.indexOf(t), 1), this.emit("removeListener", e, t), 0 === i.length && this.events.delete(e)) } return this }, t.prototype.setMaxListeners = function (e) { return this.maxListeners = e, this }, t.defaultMaxListeners = 50, t); function t() { this.events = new Map } var d = (i.jsapi ="http://10.201.37.225:8080/smiapi/arcgis",i.jsapiversion4X="4.16",i);function i(){}var l=d.jsapiversion4X,o="next";function n(e){if(null===e&&(e=l),e.toString().toLowerCase()===o)return o;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function a(e){return void 0===e&&(e=l),d.jsapi+"/"+e+"/init.js"}function s(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function c(e,t){if(t){var i=document.querySelector(t);i.parentNode.insertBefore(e,i)}else document.head.appendChild(e)}function u(e){return document.querySelector('link[href*="'+e+'"]')}function y(e){return!e||n(e)?function(e){void 0===e&&(e=l),null===e&&(e=l);var t=a(e),i=t.substring(0,t.indexOf("init.js")),r=n(e);return r===o||3!==r.major?i+"esri/themes/light/main.css":i+(r.minor<=10?"js/":"")+"esri/css/esri.css"}(e):e}function p(e,t){var i=y(e),r=u(i);if(r||c(r=s(i),t),4===function(e){null===e&&(e=l);var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}(e).major){var o=i.substring(0,i.indexOf("esri/themes/"))+"esri/themes/gis/css/gis.css",n=u(o);n||c(n=s(o),t)}return r}var _={Promise:"undefined"!=typeof window?window.Promise:void 0},r={};function f(e,t,i){var r,o,n,l;i&&(n=i,l=function(e){n(e.error||new Error("There was an error attempting to load "+o.src)),o.removeEventListener("error",l,!1)},(o=e).addEventListener("error",l,!1),r=l);var a=function(){t(e),e.removeEventListener("load",a,!1),r&&e.removeEventListener("error",r,!1)};e.addEventListener("load",a,!1)}function h(){return document.querySelector("script[data-shsmi]")}function b(){var e=window.require;return e&&e.on}function v(e){void 0===e&&(e={});var s={};[r,e].forEach(function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])});var c=s.version,u=s.url||a(c);return new _.Promise(function(e,t){var i,r,o=h();if(o){var n=o.getAttribute("src");n!==u?t(new Error("The ArcGIS API for JavaScript is already loaded ("+n+").")):b()?e(o):f(o,e,t)}else if(b())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var l=s.css;if(l)p(!0===l?c:l,s.insertCssBefore);else p(null,s.insertCssBefore);if(s.dojoConfig)window.dojoConfig=s.dojoConfig;else{var a={async:!0,packages:[{location:d.jsapi+"/extensions",name:"82B44794-5CE0-A64A-9047F07CAF08BD2C"},{location:d.jsapi+"/extensions/geolocation",name:"geolocate",main:"geolocate"}],deps:["@dojo/framework/shim/main"],has:{"esri-promise-compatibility":1,"esri-featurelayer-webgl":1}};window.dojoConfig=a}i=u,(r=document.createElement("script")).type="text/javascript",r.src=i,r.setAttribute("data-shsmi","loading"),f(o=r,function(){o.setAttribute("data-shsmi","loaded"),e(o)},t),document.head.appendChild(o)}})}function m(t){return new _.Promise(function(i,e){var r=window.require.on("error",e);window.require(t,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.remove(),i(e)})})}function P(e,t){if(void 0===t&&(t={}),b())return m(e);var i=h(),r=i&&i.getAttribute("src");return!t.url&&r&&(t.url=r),v(t).then(function(){return m(e)})}var x=(w.prototype.S4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},w.prototype.get_uuid=function(){return this.S4()+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+this.S4()+this.S4()},w);function w(){this.uuid=this.get_uuid()}var g,L,C=(g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),k=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},z=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},R=(C(A,L=e),A.prototype.add=function(o){var n=this;void 0===o&&(o={}),P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/6EB9F731-BBCF-C348-D5F8B690E99E091A","esri/views/3d/externalRenderers"]).then(function(e){var t=e[0],i=e[1],r=new t(n.view,o.center,o.radius,o.height,o.textureurl);i.add(n.view,r),n.auroraRendererArray.push([(new x).uuid,r])}).catch(function(e){console.error(e)})},A.prototype.remove=function(){var i=this;P(["esri/views/3d/externalRenderers"]).then(function(e){var t=e[0];i.auroraRendererArray.map(function(e){t.remove(i.view,e[1])}),i.auroraRendererArray=[]})},A.prototype.init=function(t){return k(this,void 0,void 0,function(){return z(this,function(e){return this.view=t,[2]})})},A);function A(e){var t=L.call(this)||this;return t.auroraRendererArray=[],t.view=null,t.init(e),t}var S=(I.maploaded="maploaded",I.zoomchanged="zoomchanged",I.extentchanged="extentchanged",I.centerchanged="centerchanged",I.blur="blur",I.click="click",I.doubleclick="doubleclick",I.drag="drag",I.focus="focus",I.hold="hold",I.keydown="key-down",I.keyup="key-up",I.mousewheel="mouse-wheel",I.pointerdown="pointer-down",I.pointerenter="pointer-enter",I.pointerleave="pointer-leave",I.pointermove="pointer-move",I.pointerup="pointer-up",I.resize="pointer-up",I.popupvisible="popup-visible",I);function I(){}var E,F,B=(E=function(e,t){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),M=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},O=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},j=(B(W,F=e),W.prototype.add=function(l){var a=this;void 0===l&&(l={}),P(["esri/layers/GraphicsLayer","esri/Graphic","esri/layers/FeatureLayer"]).then(function(e){var t=e[0],o=e[1],i=e[2];if(a.view){var r=null;if(l.boundaryType&&(r=a.view.map.findLayerById(l.boundaryType)),r||l.url&&(r=new i({url:l.url,id:l.boundaryType,title:l.boundaryType,visible:!1}),a.view.map.add(r)),r){var n=r.createQuery();n.where=l.boundaryDefinition,r.queryFeatures(n).then(function(e){if(0<e.features.length){var i,r=a.view.map.findLayerById(a.displayedLayerid);void 0===r&&(r=new t({title:a.displayedLayerid+"边界",id:a.displayedLayerid,listMode:"hide"}),a.view.map.add(r)),i=void 0!==l.symbol?l.symbol:{type:"simple-fill",color:[255,255,255,0],outline:{color:[255,255,0,1],width:"5px"}},e.features.map(function(e){var t=new o({geometry:e.geometry,symbol:i,attributes:e.attributes});r.add(t)})}})}}}).catch(function(e){console.error(e)})},W.prototype.remove=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&this.view.map.remove(e)},W.prototype.show=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!0)},W.prototype.hide=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!1)},W.prototype.init=function(t){return M(this,void 0,void 0,function(){var r=this;return O(this,function(e){return this.displayedLayerid=(new x).uuid,this.view=t,this.view.on(S.click,function(i){r.view.hitTest(i).then(function(t){return M(r,void 0,void 0,function(){return O(this,function(e){return 0<t.results.length&&t.results[0].graphic.layer.id===this.displayedLayerid&&this.emit(S.click,t.results[0].graphic,i.mapPoint),[2]})})})}),this.view.on(S.pointermove,function(i){r.view.hitTest(i).then(function(t){return M(r,void 0,void 0,function(){return O(this,function(e){return 0<t.results.length&&t.results[0].graphic.layer.id===this.displayedLayerid&&this.emit(S.pointermove,t.results[0].graphic,i.mapPoint),[2]})})})}),[2]})})},W);function W(e){var t=F.call(this)||this;return t.displayedLayerid="",t.view=null,t.init(e),t}var D,T,Z=((D=function(e,t){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(H,T=e),H.prototype.add=function(n){var l=this;P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/Mesh","82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/Extrusion","esri/views/3d/externalRenderers"]).then(function(e){var t=e[0],i=e[1],r=e[2],o=n.config;o.data=n.datas,l.mode=n.mode,o.mode=l.mode,o.slice=l.slice,o.stack=l.stack,"mesh"===l.mode?(o.height=1e3,l.contourMapLayerRenderer=new t(l.view,o)):(o.height=3e3,l.contourMapLayerRenderer=new i(l.view,o)),r.add(l.view,l.contourMapLayerRenderer)})},H.prototype.remove=function(e){var t=this;P(["esri/views/3d/externalRenderers"]).then(function(e){e[0].remove(t.view,t.contourMapLayerRenderer)})},H.prototype.init=function(e){this.view=e},H);function H(e){var t=T.call(this)||this;return t.contourMapLayerRendererArray=[],t.contourMapLayerRenderer=null,t.mode="mesh",t.slice=0,t.stack=0,t.view=null,t.init(e),t}var G,q,J=(G=function(e,t){return(G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}G(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),X=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},Y=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},U=(J(N,q=e),N.prototype.drawcircle=function(){var d=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/Point","esri/geometry/geometryEngine"]).then(function(e){var t=e[0],l=e[1],i=e[2],a=e[3],s=e[4];d.emit("drawbegin","circle"),d.drawtool=new t({view:d.view}),d.drawtool.reset();var c=d.view.map.findLayerById(d.displayedLayerid);null==c&&(c=new i({id:d.displayedLayerid,title:"绘制结果显示层",listMode:"hide"}),d.view.map.add(c));var r=(new x).uuid,u=d.view.map.findLayerById(r);u||(u=new i({id:d.displayedLayerid,title:"绘制圆实时追踪显示层",listMode:"hide"}),d.view.map.add(u));var o=d.drawtool.create("circle",{mode:"click"});d.view.focus(),o.on("vertex-add",function(e){if(2===e.vertices.length){u.removeAll();var t=new a({x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:d.view.spatialReference}),i=new a({x:e.vertices[1][0],y:e.vertices[1][1],spatialReference:d.view.spatialReference}),r=s.distance(t,i,"meters"),o=s.buffer(t,r,"meters"),n=new l({geometry:o,symbol:d.polygonsymbol});u.add(n)}}),o.on("vertex-remove",function(e){console.log(e)}),o.on("cursor-update",function(e){if(2===e.vertices.length){u.removeAll();var t=new a({x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:d.view.spatialReference}),i=new a({x:e.vertices[1][0],y:e.vertices[1][1],spatialReference:d.view.spatialReference}),r=s.distance(t,i,"meters"),o=s.buffer(t,r,"meters"),n=new l({geometry:o,symbol:d.polygonsymbol});u.add(n)}}),o.on("redo",function(e){console.log(e)}),o.on("undo",function(e){console.log(e)}),o.on("draw-complete",function(e){if(2===e.vertices.length){var t=new a({x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:d.view.spatialReference}),i=new a({x:e.vertices[1][0],y:e.vertices[1][1],spatialReference:d.view.spatialReference}),r=s.distance(t,i,"meters"),o=s.buffer(t,r,"meters"),n=new l({geometry:o,symbol:d.polygonsymbol});d.view.map.remove(u),c.add(n),d.emit("drawcomplete",n,"circle")}})})},N.prototype.drawrectangle=function(){var d=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/Polygon"]).then(function(e){var t=e[0],a=e[1],i=e[2],s=e[3];d.emit("drawbegin","rectangle"),d.drawtool=new t({view:d.view}),d.drawtool.reset();var c=d.view.map.findLayerById(d.displayedLayerid);c||(c=new i({id:d.displayedLayerid,title:"绘制结果显示层",listMode:"hide"}),d.view.map.add(c));var r=(new x).uuid,u=d.view.map.findLayerById(r);null==u&&(u=new i({id:d.displayedLayerid,title:"绘制矩形追踪实时显示层",listMode:"hide"}),d.view.map.add(u));var o=d.drawtool.create("rectangle",{mode:"click"});d.view.focus(),o.on("vertex-add",function(e){if(2===e.vertices.length){u.removeAll();var t=e.vertices[0][0]>e.vertices[1][0]?e.vertices[1][0]:e.vertices[0][0],i=e.vertices[0][1]>e.vertices[1][1]?e.vertices[1][1]:e.vertices[0][1],r=e.vertices[0][0]>e.vertices[1][0]?e.vertices[0][0]:e.vertices[1][0],o=e.vertices[0][1]>e.vertices[1][1]?e.vertices[0][1]:e.vertices[1][1],n=new s({hasZ:!0,hasM:!0,rings:[[[t,i],[r,i],[r,o],[t,o],[t,i]]],spatialReference:d.view.spatialReference}),l=new a({geometry:n,symbol:d.polygonsymbol});u.add(l)}}),o.on("vertex-remove",function(e){console.log(e)}),o.on("cursor-update",function(e){if(2===e.vertices.length){u.removeAll();var t=e.vertices[0][0]>e.vertices[1][0]?e.vertices[1][0]:e.vertices[0][0],i=e.vertices[0][1]>e.vertices[1][1]?e.vertices[1][1]:e.vertices[0][1],r=e.vertices[0][0]>e.vertices[1][0]?e.vertices[0][0]:e.vertices[1][0],o=e.vertices[0][1]>e.vertices[1][1]?e.vertices[0][1]:e.vertices[1][1],n=new s({hasZ:!0,hasM:!0,rings:[[[t,i],[r,i],[r,o],[t,o],[t,i]]],spatialReference:d.view.spatialReference}),l=new a({geometry:n,symbol:d.polygonsymbol});u.add(l)}}),o.on("redo",function(e){console.log(e)}),o.on("undo",function(e){console.log(e)}),o.on("draw-complete",function(e){if(2===e.vertices.length){var t=e.vertices[0][0]>e.vertices[1][0]?e.vertices[1][0]:e.vertices[0][0],i=e.vertices[0][1]>e.vertices[1][1]?e.vertices[1][1]:e.vertices[0][1],r=e.vertices[0][0]>e.vertices[1][0]?e.vertices[0][0]:e.vertices[1][0],o=e.vertices[0][1]>e.vertices[1][1]?e.vertices[0][1]:e.vertices[1][1],n=new s({hasZ:!0,hasM:!0,rings:[[[t,i],[r,i],[r,o],[t,o],[t,i]]],spatialReference:d.view.spatialReference}),l=new a({geometry:n,symbol:d.polygonsymbol});d.view.map.remove(u),c.add(l),d.emit("drawcomplete",l,"rectangle")}})})},N.prototype.drawPoint=function(){var s=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer"]).then(function(e){var t=e[0],r=e[1],i=e[2];s.emit("drawbegin","point"),s.drawtool=new t({view:s.view}),s.drawtool.reset();var o=s.view.map.findLayerById(s.displayedLayerid);o||(o=new i({id:s.displayedLayerid,title:"绘制结果显示层",listMode:"hide"}),s.view.map.add(o));var n=(new x).uuid,l=s.view.map.findLayerById(n);null==l&&(l=new i({id:s.displayedLayerid,title:"绘制点移动实时追踪显示层",listMode:"hide"}),s.view.map.add(l));var a=s.drawtool.create("point",{mode:"click"});s.view.focus(),a.on("vertex-add",function(e){console.log(e)}),a.on("vertex-remove",function(e){console.log(e)}),a.on("cursor-update",function(e){l.removeAll();var t={type:"point",x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:s.view.spatialReference},i=new r({geometry:t,symbol:s.marksymbol});l.add(i)}),a.on("redo",function(e){console.log(e)}),a.on("undo",function(e){console.log(e)}),a.on("draw-complete",function(e){var t={type:"point",x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:s.view.spatialReference},i=new r({geometry:t,symbol:s.marksymbol});s.view.map.remove(l),o.add(i),s.emit("drawcomplete",i,"point")})})},N.prototype.drawMultipoint=function(){var u=this;P(["esri/views/draw/Draw","esri/views/draw/PointDrawAction","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/Polygon","esri/geometry/geometryEngine"]).then(function(e){var t=e[0],o=(e[1],e[2]),i=e[3];e[4],e[5],u.emit("drawbegin","multipoint"),u.drawtool=new t({view:u.view}),u.drawtool.reset();var n=u.view.map.findLayerById(u.displayedLayerid);n||(n=new i({id:u.displayedLayerid,title:"绘制结果显示层",listMode:"hide"}),u.view.map.add(n));var r=(new x).uuid,l=u.view.map.findLayerById(r);null==l&&(l=new i({id:u.displayedLayerid,title:"绘制多点临时显示层",listMode:"hide"}),u.view.map.add(l));var a=(new x).uuid,s=u.view.map.findLayerById(a);null==s&&(s=new i({id:u.displayedLayerid,title:"绘制多点移动追踪显示层",listMode:"hide"}),u.view.map.add(s));var c=u.drawtool.create("multipoint",{mode:"click"});u.view.focus(),c.on("vertex-add",function(e){l.removeAll(),e.vertices.map(function(e){var t={type:"point",x:e[0],y:e[1],spatialReference:u.view.spatialReference},i=new o({geometry:t,symbol:u.marksymbol});l.add(i)})}),c.on("vertex-remove",function(e){console.log(e)}),c.on("cursor-update",function(e){s.removeAll(),e.vertices.map(function(e){var t={type:"point",x:e[0],y:e[1],spatialReference:u.view.spatialReference},i=new o({geometry:t,symbol:u.marksymbol});s.add(i)})}),c.on("redo",function(e){console.log(e)}),c.on("undo",function(e){console.log(e)}),c.on("draw-complete",function(e){var r=[];e.vertices.map(function(e){var t={type:"point",x:e[0],y:e[1],spatialReference:u.view.spatialReference},i=new o({geometry:t,symbol:u.marksymbol});r.push(i),n.add(i)}),u.view.map.remove(l),u.view.map.remove(s),u.emit("drawcomplete",r,"multipoint")})})},N.prototype.drawPolyline=function(){var u=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/geometryEngine"]).then(function(e){var t=e[0],l=e[1],i=e[2],a=e[3];u.emit("drawbegin","polyline"),u.drawtool=new t({view:u.view}),u.drawtool.reset();var s=u.view.map.findLayerById(u.displayedLayerid);s||(s=new i({id:u.displayedLayerid,title:"绘制结果显示层",listMode:"hide"}),u.view.map.add(s));var r=(new x).uuid,c=u.view.map.findLayerById(r);null==c&&(c=new i({id:u.displayedLayerid,title:"绘制线实时追踪显示层",listMode:"hide"}),u.view.map.add(c));var o=u.drawtool.create("polyline");u.view.focus(),o.on(["vertex-add","vertex-remove","cursor-update","redo","undo"],function(e){if(1<e.vertices.length){var t=e.vertices;c.removeAll();var i=new l({geometry:{type:"polyline",paths:t,spatialReference:u.view.spatialReference},symbol:u.polylinesymbol}),r=function(e){var t=e.clone(),i=t.removePoint(0,t.paths[0].length-1),r=t.getPoint(0,t.paths[0].length-1);return{type:"polyline",spatialReference:u.view.spatialReference,hasZ:!1,paths:[[[r.x,r.y],[i.x,i.y]]]}};if(function(e){if(!(e.paths[0].length<3)){var t=e.clone(),i=r(e);return t.removePoint(0,t.paths[0].length-1),a.crosses(i,t)}}(i.geometry)){var o=new l({geometry:r(i.geometry),symbol:u.polylinesymbol});o&&c.addMany([i,o]),o&&e.preventDefault()}else c.add(i)}}),o.on("draw-complete",function(e){if(1<e.vertices.length){var t=e.vertices;c.removeAll();var i=new l({geometry:{type:"polyline",paths:t,spatialReference:u.view.spatialReference},symbol:u.polylinesymbol}),r=function(e){var t=e.clone(),i=t.removePoint(0,t.paths[0].length-1),r=t.getPoint(0,t.paths[0].length-1);return{type:"polyline",spatialReference:u.view.spatialReference,hasZ:!1,paths:[[[r.x,r.y],[i.x,i.y]]]}},o=null;if(function(e){if(!(e.paths[0].length<3)){var t=e.clone(),i=r(e);return t.removePoint(0,t.paths[0].length-1),a.crosses(i,t)}}(i.geometry)){var n=new l({geometry:r(i.geometry),symbol:u.polylinesymbol});n&&(s.addMany([i,n]),o=new l({geometry:a.union(i.geometry,n.geometry),symbol:u.polylinesymbol})),n&&e.preventDefault()}else o=i,s.add(i);u.view.map.remove(c),u.emit("drawcomplete",o,"polyline")}})})},N.prototype.drawPolygon=function(){var s=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/geometryEngine"]).then(function(e){var t=e[0],o=e[1],i=e[2];e[3],s.emit("drawbegin","polygon"),s.drawtool=new t({view:s.view}),s.drawtool.reset();var n=s.view.map.findLayerById(s.displayedLayerid);n||(n=new i({id:s.displayedLayerid,title:"绘制结果显示层",listMode:"hide"}),s.view.map.add(n));var r=(new x).uuid,l=s.view.map.findLayerById(r);null==l&&(l=new i({id:s.displayedLayerid,title:"绘制多边形实时追踪显示层",listMode:"hide"}),s.view.map.add(l));var a=s.drawtool.create("polygon");s.view.focus(),a.on(["vertex-add","vertex-remove","cursor-update","redo","undo"],function(e){var t=e.vertices;l.removeAll();var i={type:"polygon",rings:t,spatialReference:s.view.spatialReference},r=new o({geometry:i,symbol:s.polygonsymbol});l.add(r)}),a.on("draw-complete",function(e){var t=e.vertices;l.removeAll();var i={type:"polygon",rings:t,spatialReference:s.view.spatialReference},r=new o({geometry:i,symbol:s.polygonsymbol});s.view.map.remove(l),n.add(r),s.emit("drawcomplete",r,"polygon")})})},N.prototype.reset=function(){this.drawtool&&this.drawtool.reset()},N.prototype.clean=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&this.view.map.remove(e)},N.prototype.show=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!0)},N.prototype.hide=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!1)},N.prototype.init=function(i){return X(this,void 0,void 0,function(){var t=this;return Y(this,function(e){return this.displayedLayerid=(new x).uuid,this.view=i,"2d"===this.view.type?(this.polygonsymbol={type:"simple-fill",color:[255,255,255,.6],style:"solid",outline:{color:[255,255,0,.8],width:2}},this.polylinesymbol={type:"simple-line",color:[255,255,255,.6],width:"4px",style:"solid"},this.marksymbol={type:"simple-marker",style:"circle",color:[255,255,0,.6],size:"24px",outline:{color:[255,255,0,.8],width:2}}):(this.polygonsymbol={type:"polygon-3d",symbolLayers:[{type:"extrude",castShadows:!1,size:100,material:{color:[255,255,255,.4]},edges:{type:"solid",color:[50,50,50,.5]}}]},this.polylinesymbol={type:"line-3d",symbolLayers:[{type:"path",anchor:"center",Values:"center",profile:"quad",width:2,height:10,material:{color:[255,255,255,.4]},cap:"square",join:"miter",castShadows:!1,profileRotation:"heading"}]},this.marksymbol={type:"point-3d",symbolLayers:[{type:"object",width:20,height:20,depth:20,resource:{primitive:"sphere"},material:{color:[0,0,255,.8]}}],verticalOffset:{screenLength:60,maxWorldLength:1e3,minWorldLength:20},callout:{type:"line",size:1.5,color:"white",border:{color:"black"}}}),this.view.on(S.click,function(e){t.view.hitTest(e).then(function(e){return X(t,void 0,void 0,function(){return Y(this,function(e){return[2]})})})}),this.view.on(S.pointermove,function(e){t.view.hitTest(e).then(function(e){return X(t,void 0,void 0,function(){return Y(this,function(e){return[2]})})})}),[2]})})},N);function N(e){var t=q.call(this)||this;return t.marksymbol=null,t.polylinesymbol=null,t.polygonsymbol=null,t.displayedLayerid="",t.view=null,t.drawtool=null,t.drawlayerscollection=[],t.init(e),t}var V,$,Q=(V=function(e,t){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}V(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),K=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},ee=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},te=(Q(ie,$=e),ie.prototype.add=function(o){var n=this;void 0===o&&(o={}),P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/dynamicCloud","esri/views/3d/externalRenderers"]).then(function(e){var t=e[0],i=e[1],r=new t(n.view,o.center,o.radius,o.noiseurl,o.cloudurl);i.add(n.view,r),n.dynamicCylinderfenceRendererArray.push([(new x).uuid,r])}).catch(function(e){console.error(e)})},ie.prototype.remove=function(){var i=this;P(["esri/views/3d/externalRenderers"]).then(function(e){var t=e[0];i.dynamicCylinderfenceRendererArray.map(function(e){t.remove(i.view,e[1])}),i.dynamicCylinderfenceRendererArray=[]})},ie.prototype.init=function(t){return K(this,void 0,void 0,function(){return ee(this,function(e){return this.view=t,[2]})})},ie);function ie(e){var t=$.call(this)||this;return t.dynamicCylinderfenceRendererArray=[],t.view=null,t.init(e),t}var re,oe,ne=(re=function(e,t){return(re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}re(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),le=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},ae=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},se=(ne(ce,oe=e),ce.prototype.add=function(o){var n=this;void 0===o&&(o={}),P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/82B44794-5CE0-A64A-9047F07CAF08BD2C","esri/views/3d/externalRenderers"]).then(function(e){var t=e[0],i=e[1],r=new t(n.view,o.center,o.radius,o.height,o.textureurl,o.scale);i.add(n.view,r),n.dynamicCylinderfenceRendererArray.push([(new x).uuid,r])}).catch(function(e){console.error(e)})},ce.prototype.remove=function(){var i=this;P(["esri/views/3d/externalRenderers"]).then(function(e){var t=e[0];i.dynamicCylinderfenceRendererArray.map(function(e){t.remove(i.view,e[1])}),i.dynamicCylinderfenceRendererArray=[]})},ce.prototype.init=function(t){return le(this,void 0,void 0,function(){return ae(this,function(e){return this.view=t,[2]})})},ce);function ce(e){var t=oe.call(this)||this;return t.dynamicCylinderfenceRendererArray=[],t.view=null,t.init(e),t}var ue,de,ye=(ue=function(e,t){return(ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ue(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),pe=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},fe=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},he=(ye(be,de=e),be.prototype.add=function(o){var n=this;void 0===o&&(o={}),P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/95CEAB7E-A2ED-576F-64F0B53B2C6A134F","esri/views/3d/externalRenderers"]).then(function(e){var t=e[0],i=e[1];if(o.points&&o.texturestart&&o.texturestarend&&o.height){o.view=n.view;var r=new t(o);i.add(n.view,r),n.dynamicPolygonRendererArray.push([(new x).uuid,r])}}).catch(function(e){console.error(e)})},be.prototype.remove=function(){var i=this;P(["esri/views/3d/externalRenderers"]).then(function(e){var t=e[0];i.dynamicPolygonRendererArray.map(function(e){t.remove(i.view,e[1])}),i.dynamicPolygonRendererArray=[]})},be.prototype.init=function(t){return pe(this,void 0,void 0,function(){return fe(this,function(e){return this.view=t,[2]})})},be);function be(e){var t=de.call(this)||this;return t.dynamicPolygonRendererArray=[],t.view=null,t.init(e),t}var ve,me,we=(ve=function(e,t){return(ve=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ve(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ge=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},xe=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Le=(we(Ce,me=e),Ce.prototype.add=function(o){var n=this;void 0===o&&(o={}),P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/789A68E1-657F-D870-37F9E6DF554E1C27","esri/views/3d/externalRenderers"]).then(function(e){var t=e[0],i=e[1],r=new t(n.view,o.center,o.radius,o.height,o.textureurl,o.scale);i.add(n.view,r),n.dynamicSquarefenceRendererArray.push([(new x).uuid,r])}).catch(function(e){console.error(e)})},Ce.prototype.remove=function(){var i=this;P(["esri/views/3d/externalRenderers"]).then(function(e){var t=e[0];i.dynamicSquarefenceRendererArray.map(function(e){t.remove(i.view,e[1])}),i.dynamicSquarefenceRendererArray=[]})},Ce.prototype.init=function(t){return ge(this,void 0,void 0,function(){return xe(this,function(e){return this.view=t,[2]})})},Ce);function Ce(e){var t=me.call(this)||this;return t.dynamicSquarefenceRendererArray=[],t.view=null,t.init(e),t}var ke,ze,Re=(ke=function(e,t){return(ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ke(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ae=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},Se=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Ie=(Re(Ee,ze=e),Ee.prototype.add=function(l){var a=this;P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/599EFB79-18C9-DC0A-E2C9FC2F2316C660"]).then(function(e){var t=e[0],i=document.getElementsByClassName("esri-view-surface")[0],r=document.getElementById(a.displayedLayerid);null!==r&&i.removeChild(r);var o=[];a.datas=l.datas,l.datas.forEach(function(e,t){o.push({name:"Top10",type:"effectScatter",coordinateSystem:"arcgis",zlevel:2,showEffectOn:"render",rippleEffect:{brushType:"stroke"},legendHoverLink:!0,hoverAnimation:!0,symbol:null==e.symbol||void 0===e.symbol?"diamond":e.symbol,cursor:"pointer",label:{normal:{show:!0,position:null==e.labelposition||void 0===e.labelposition?"right":e.labelposition,formatter:"{b}"}},tooltip:{padding:10,backgroundColor:"#222",borderColor:"#777",borderWidth:1},symbolSize:function(e){return e[2]/8},itemStyle:{normal:{color:e.color,shadowBlur:10,shadowColor:"#333"}},data:[{name:e.name,value:[e.x,e.y].concat([e.value])}]})});var n={title:{text:"",subtext:"",left:"center",textStyle:{color:"#fff"}},series:o};new t(a.view,"",a.displayedLayerid).setChartOption(n)})},Ee.prototype.update=function(l){var a=this;P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/599EFB79-18C9-DC0A-E2C9FC2F2316C660"]).then(function(e){var t=e[0],i=document.getElementsByClassName("esri-view-surface")[0],r=document.getElementById(a.displayedLayerid);null!==r&&i.removeChild(r);var o=[];a.datas=l.datas,l.datas.forEach(function(e,t){o.push({name:"Top10",type:"effectScatter",coordinateSystem:"arcgis",zlevel:2,showEffectOn:"render",rippleEffect:{brushType:"stroke"},legendHoverLink:!0,hoverAnimation:!0,symbol:null==e.symbol||void 0===e.symbol?"diamond":e.symbol,cursor:"pointer",label:{normal:{show:!0,position:null==e.labelposition||void 0===e.labelposition?"right":e.labelposition,formatter:"{b}"}},tooltip:{padding:10,backgroundColor:"#222",borderColor:"#777",borderWidth:1},symbolSize:function(e){return e[2]/8},itemStyle:{normal:{color:e.color,shadowBlur:10,shadowColor:"#333"}},data:[{name:e.name,value:[e.x,e.y].concat([e.value])}]})});var n={title:{text:"",subtext:"",left:"center",textStyle:{color:"#fff"}},series:o};new t(a.view,"",a.displayedLayerid).setChartOption(n)})},Ee.prototype.delete=function(){var e=document.getElementsByClassName("esri-view-surface")[0],t=document.getElementById(this.displayedLayerid);null!==t&&e.removeChild(t)},Ee.prototype.init=function(t){return Ae(this,void 0,void 0,function(){var s=this;return Se(this,function(e){return this.view=t,this.displayedLayerid=(new x).uuid,P(["esri/geometry/Point","esri/geometry/SpatialReference","esri/geometry/support/webMercatorUtils"]).then(function(e){var l=e[0],a=e[1];e[2],s.view.on(S.click,function(r){if(s.datas.length){var i=s.datas.map(function(e){var t=new l({x:e.x,y:e.y,spatialReference:a.WebMercator}),i=s.view.toScreen(t);return Math.sqrt((i.x-r.x)*(i.x-r.x)+(i.y-r.y)*(i.y-r.y))}),o=0;i.forEach(function(e,t){e<i[o]&&(o=t)}),35<i[o]||s.emit(S.click,s.datas[o],r.mapPoint)}}),s.view.on(S.doubleclick,function(r){if(s.datas.length){var i=s.datas.map(function(e){var t=new l({x:e.x,y:e.y,spatialReference:a.WebMercator}),i=s.view.toScreen(t);return Math.sqrt((i.x-r.x)*(i.x-r.x)+(i.y-r.y)*(i.y-r.y))}),o=0;i.forEach(function(e,t){e<i[o]&&(o=t)}),35<i[o]||s.emit(S.doubleclick,s.datas[o],r.mapPoint)}}),s.view.on(S.pointermove,function(n){s.view.hitTest(n).then(function(t){return Ae(s,void 0,void 0,function(){var i,r,o=this;return Se(this,function(e){if(0<t.results.length&&t.results[0].graphic.layer.id===this.displayedLayerid){if(!this.datas.length)return[2];if(i=this.datas.map(function(e){var t=new l({x:e.x,y:e.y,spatialReference:a.WebMercator}),i=o.view.toScreen(t);return Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y))}),r=0,i.forEach(function(e,t){e<i[r]&&(r=t)}),35<i[r])return[2];this.emit(S.pointermove,this.datas[r],this.view.toMap({x:n.x,y:n.y}))}return[2]})})})})}),[2]})})},Ee);function Ee(e){var t=ze.call(this)||this;return t.displayedLayerid="",t.view=null,t.datas=null,t.init(e),t}var Fe,Be,_e=(Fe=function(e,t){return(Fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Fe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Pe=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},Me=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Oe=(_e(je,Be=e),je.prototype.createFeatureGroup=function(B){return Pe(this,void 0,void 0,function(){var t,i,r,n,o,l,a,s,c,u,d,y,p,f,h,b,v,m,w,g,x,L,C,k,z,R,A,S,I,E,F=this;return Me(this,function(e){switch(e.label){case 0:return[4,P(["esri/layers/FeatureLayer","esri/layers/support/LabelClass","esri/Graphic","esri/geometry/Point","esri/geometry/Circle","esri/symbols/PictureMarkerSymbol","esri/geometry/Polyline","esri/geometry/Polygon"])];case 1:return t=e.sent(),i=t[0],r=t[1],n=t[2],o=t[3],l=t[4],t[5],a=t[6],s=t[7],(c=this.view.map.findLayerById(this.displayedLayerid))&&(this.view.map.remove(c),this.mapoverlayersflayer=[]),u=[],"group"===B.type?((d=[{name:"objectId",alias:"objectId",type:"oid"},{name:"uuid",alias:"唯一标识",type:"string"}]).push({name:"style",alias:"样式",type:"string"}),B.datafiled.forEach(function(e){d.push(e)}),"marker"===B.overlaytype.toLowerCase()?(B.renderer?y=B.renderer:(y={type:"unique-value",field:"style",uniqueValueInfos:[]},B.style.forEach(function(e){y.uniqueValueInfos.push({value:e.style,label:e.style,symbol:e.symbol})})),p=new i({id:this.displayedLayerid,title:"Overlayer-marker-"+this.displayedLayerid,objectIdField:"objectId",geometryType:"point",renderer:y,screenSizePerspectiveEnabled:"3d"===this.view.type,popupEnabled:!1,popupTemplate:!1,fields:d,source:[],spatialReference:this.view.spatialReference}),B.elevationInfo&&"3d"===this.view.type&&(p.elevationInfo=B.elevationInfo),B.frreduction&&("3d"===this.view.type?p.featureReduction={type:B.frreduction.type}:p.featureReduction=B.frreduction.clusterConfig),this.view.map.add(p),B.overlayers.forEach(function(e){if(e.attributes&&e.position){var t=e.attributes;t.uuid=e.uuid;var i=new n({geometry:new o({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:F.view.spatialReference}),attributes:t});p.source.add(i),u.push(i),F.mapoverlayersflayer.push([B.uuid,e.uuid,i])}}),100<p.source.items.length&&null!=B.frreduction&&(p.featureReduction={type:B.frreduction.type,clusterRadius:B.frreduction.clusterRadius}),B.label.visible&&(I=void 0,B.label.labelingInfo?(I=B.label.labelingInfo,p.labelingInfo=I):(I="2d"===this.view.type?{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:B.label.color},size:B.label.size,halo:{color:B.label.haloColor,size:B.label.haloSize}}]},E=new r({labelExpressionInfo:{expression:"$feature.NAME"},symbol:I,labelPlacement:B.label.placement,minScale:B.label.minScale,maxScale:B.label.maxScale}),p.labelingInfo=[E]))):"circle"===B.overlaytype.toLowerCase()?(B.renderer?y=B.renderer:(y={type:"unique-value",field:"style",uniqueValueInfos:[]},B.style.forEach(function(e){y.uniqueValueInfos.push({value:e.style,label:e.style,symbol:e.symbol})})),f=new i({id:this.displayedLayerid,title:"Overlayer-circle-"+this.displayedLayerid,objectIdField:"objectId",geometryType:"polygon",renderer:y,screenSizePerspectiveEnabled:"3d"===this.view.type,popupEnabled:!1,popupTemplate:!1,fields:d,source:[],spatialReference:this.view.spatialReference}),B.elevationInfo&&"3d"===this.view.type&&(f.elevationInfo=B.elevationInfo),this.view.map.add(f),B.overlayers.forEach(function(e){if(e.attributes&&e.center&&e.radius){var t=e.attributes;t.uuid=e.uuid;var i=new n({geometry:new l({center:new o({x:e.center.X,y:e.center.Y,z:e.center.Z,spatialReference:F.view.spatialReference}),radius:e.radius,radiusUnit:e.radiusUnit,spatialReference:F.view.spatialReference}),attributes:t});u.push(i),f.source.add(i),F.mapoverlayersflayer.push([B.uuid,e.uuid,i])}}),B.label.visible&&(I=void 0,B.label.labelingInfo?(I=B.label.labelingInfo,f.labelingInfo=I):(I="2d"===this.view.type?{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:B.label.color},size:B.label.size,halo:{color:B.label.haloColor,size:B.label.haloSize}}]},E=new r({labelExpressionInfo:{expression:"$feature.NAME"},symbol:I,labelPlacement:B.label.placement,minScale:B.label.minScale,maxScale:B.label.maxScale}),f.labelingInfo=[E]))):"polyline"===B.overlaytype.toLowerCase()?(B.renderer?y=B.renderer:(y={type:"unique-value",field:"style",uniqueValueInfos:[]},B.style.forEach(function(e){y.uniqueValueInfos.push({value:e.style,label:e.style,symbol:e.symbol})})),h=new i({id:this.displayedLayerid,title:"Overlayer-polyline-"+this.displayedLayerid,objectIdField:"objectId",geometryType:"polyline",renderer:y,popupEnabled:!1,popupTemplate:!1,fields:d,source:[],spatialReference:this.view.spatialReference}),B.elevationInfo&&"3d"===this.view.type&&(h.elevationInfo=B.elevationInfo),this.view.map.add(h),B.overlayers.forEach(function(e){if(e.attributes&&e.path){var t=e.attributes;t.uuid=e.uuid;var i=[];e.path.forEach(function(e){i.push([e.X,e.Y,e.Z])});var r=new a({hasZ:!1,hasM:!1,paths:i,spatialReference:F.view.spatialReference}),o=new n({geometry:r,attributes:t});u.push(o),h.source.add(o),F.mapoverlayersflayer.push([B.uuid,e.uuid,o])}}),B.label.visible&&(I=void 0,B.label.labelingInfo?(I=B.label.labelingInfo,h.labelingInfo=I):(I="2d"===this.view.type?{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:B.label.color},size:B.label.size,halo:{color:B.label.haloColor,size:B.label.haloSize}}]},E=new r({labelExpressionInfo:{expression:"$feature.NAME"},symbol:I,labelPlacement:B.label.placement,minScale:B.label.minScale,maxScale:B.label.maxScale}),h.labelingInfo=[E]))):"polygon"===B.overlaytype.toLowerCase()&&(B.renderer?y=B.renderer:(y={type:"unique-value",field:"style",uniqueValueInfos:[]},B.style.forEach(function(e){y.uniqueValueInfos.push({value:e.style,label:e.style,symbol:e.symbol})})),b=new i({id:this.displayedLayerid,title:"Overlayer-polygon-"+this.displayedLayerid,objectIdField:"objectId",geometryType:"polygon",renderer:y,popupEnabled:!1,popupTemplate:!1,fields:d,source:[],spatialReference:this.view.spatialReference}),B.elevationInfo&&"3d"===this.view.type&&(b.elevationInfo=B.elevationInfo),this.view.map.add(b),B.overlayers.forEach(function(e){if(e.attributes&&e.paths){var t=e.attributes;t.uuid=e.uuid;var i=[];e.paths.forEach(function(e){i.push([e.X,e.Y,e.Z])});var r=new s({hasZ:!0,hasM:!0,rings:i,spatialReference:F.view.spatialReference}),o=new n({geometry:r,attributes:t});u.push(o),b.source.add(o),F.mapoverlayersflayer.push([B.uuid,e.uuid,o])}}),B.label.visible&&(I=void 0,B.label.labelingInfo?(I=B.label.labelingInfo,b.labelingInfo=I):(I="2d"===this.view.type?{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:B.label.color},size:B.label.size,halo:{color:B.label.haloColor,size:B.label.haloSize}}]},E=new r({labelExpressionInfo:{expression:"$feature.NAME"},symbol:I,labelPlacement:B.label.placement,minScale:B.label.minScale,maxScale:B.label.maxScale}),b.labelingInfo=[E])))):"element"===B.type&&(v=[{name:"objectId",alias:"objectId",type:"oid"},{name:"uuid",alias:"唯一标识",type:"string"}],Object.keys(B.attributes).forEach(function(e){v.push({name:e,alias:e,type:"string"})}),"marker"===B.overlaytype.toLowerCase()?(m=void 0,m=B.renderer?B.renderer:"3d"===this.view.type?{type:"simple",symbol:{type:"point-3d",symbolLayers:[{type:"icon",size:B.icon.size.width,resource:{href:B.icon.image}}]}}:{type:"simple",symbol:{type:"picture-marker",url:B.icon.image,width:B.icon.size.width,height:B.icon.size.height}},k=new i({id:this.displayedLayerid,title:"Overlayer-marker-"+this.displayedLayerid,objectIdField:"objectId",geometryType:"point",renderer:m,screenSizePerspectiveEnabled:!0,popupEnabled:!1,popupTemplate:!1,fields:v,source:[],spatialReference:this.view.spatialReference}),B.elevationInfo&&"3d"===this.view.type&&(k.elevationInfo=B.elevationInfo),B.position&&B.attributes&&((z=B.attributes).uuid=B.uuid,S=new n({geometry:new o({x:B.position[0],y:B.position[1],z:void 0===B.position[2]?0:B.position[2],spatialReference:this.view.spatialReference}),attributes:z}),u.push(S),k.source.add(S),this.mapoverlayersflayer.push([B.uuid,B.uuid,S])),this.view.map.add(k),B.label.visible&&(I=void 0,B.label.labelingInfo?(I=B.label.labelingInfo,k.labelingInfo=I):(I="2d"===this.view.type?{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:B.label.color},size:B.label.size,halo:{color:B.label.haloColor,size:B.label.haloSize}}]},E=new r({labelExpressionInfo:{expression:"$feature.NAME"},symbol:I,labelPlacement:B.label.placement,minScale:B.label.minScale,maxScale:B.label.maxScale}),k.labelingInfo=[E]))):"circle"===B.overlaytype.toLowerCase()?(w=void 0,w=B.renderer?B.renderer:"simple"===B.symboltype?{type:"simple",symbol:{type:"simple-fill",color:B.fillColor,style:B.style,outline:{color:B.strokeColor,width:B.strokeWeight,style:B.strokestyle}}}:{type:"picture-fill",url:B.url,width:B.picwidth,height:B.picheight,outline:{style:B.strokestyle,color:B.strokeColor,width:B.strokeWeight}},k=new i({id:this.displayedLayerid,title:"Overlayer-circle-"+this.displayedLayerid,objectIdField:"objectId",geometryType:"polygon",renderer:w,screenSizePerspectiveEnabled:!0,popupEnabled:!1,popupTemplate:!1,fields:v,source:[],spatialReference:this.view.spatialReference}),B.elevationInfo&&"3d"===this.view.type&&(k.elevationInfo=B.elevationInfo),B.center&&B.radius&&B.attributes&&((z=B.attributes).uuid=B.uuid,S=new n({geometry:new l({center:new o({x:B.center.X,y:B.center.Y,z:B.center.Z,spatialReference:this.view.spatialReference}),radius:B.radius,radiusUnit:B.radiusUnit,spatialReference:this.view.spatialReference}),attributes:z}),u.push(S),k.source.add(S),this.mapoverlayersflayer.push([B.uuid,B.uuid,S])),this.view.map.add(k),B.label.visible&&(I=void 0,B.label.labelingInfo?(I=B.label.labelingInfo,k.labelingInfo=I):(I="2d"===this.view.type?{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:B.label.color},size:B.label.size,halo:{color:B.label.haloColor,size:B.label.haloSize}}]},E=new r({labelExpressionInfo:{expression:"$feature.NAME"},symbol:I,labelPlacement:B.label.placement,minScale:B.label.minScale,maxScale:B.label.maxScale}),k.labelingInfo=[E]))):"polyline"===B.overlaytype.toLowerCase()?(g=void 0,B.renderer||(g="simple"===B.symboltype?{type:"simple",symbol:{type:"simple-line",color:B.strokeColor,style:B.style,width:B.width,cap:B.cap,join:B.lineJoin}}:B.renderer,k=new i({id:this.displayedLayerid,title:"Overlayer-polyline-"+this.displayedLayerid,objectIdField:"objectId",geometryType:"polyline",renderer:g,screenSizePerspectiveEnabled:!0,popupEnabled:!1,popupTemplate:!1,fields:v,source:[],spatialReference:this.view.spatialReference}),B.elevationInfo&&"3d"===this.view.type&&(k.elevationInfo=B.elevationInfo),B.path&&B.attributes&&((z=B.attributes).uuid=B.uuid,x=[],B.path.forEach(function(e){x.push([e.X,e.Y,e.Z])}),L=new a({hasZ:!1,hasM:!1,paths:x,spatialReference:this.view.spatialReference}),S=new n({geometry:L,attributes:z}),u.push(S),k.source.add(S),this.mapoverlayersflayer.push([B.uuid,B.uuid,S])),this.view.map.add(k),B.label.visible&&(I=void 0,B.label.labelingInfo?(I=B.label.labelingInfo,k.labelingInfo=I):(I="2d"===this.view.type?{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:B.label.color},size:B.label.size,halo:{color:B.label.haloColor,size:B.label.haloSize}}]},E=new r({labelExpressionInfo:{expression:"$feature.NAME"},symbol:I,labelPlacement:B.label.placement,minScale:B.label.minScale,maxScale:B.label.maxScale}),k.labelingInfo=[E])))):"polygon"===B.overlaytype.toLowerCase()&&(C=void 0,C=B.renderer?B.symbol:"simple"===B.symboltype?{type:"simple",symbol:{type:"simple-fill",color:B.fillColor,style:B.style,outline:{color:B.strokeColor,width:B.strokeWeight,style:B.strokestyle}}}:{type:"simple",symbol:{type:"picture-fill",url:B.url,width:B.picwidth,height:B.picheight,outline:{style:B.strokestyle,color:B.strokeColor,width:B.strokeWeight}}},k=new i({id:this.displayedLayerid,title:"Overlayer-polygon-"+this.displayedLayerid,objectIdField:"objectId",geometryType:"polygon",renderer:C,screenSizePerspectiveEnabled:!0,popupEnabled:!1,popupTemplate:!1,fields:v,source:[],spatialReference:this.view.spatialReference}),B.elevationInfo&&"3d"===this.view.type&&(k.elevationInfo=B.elevationInfo),B.paths&&B.attributes&&((z=B.attributes).uuid=B.uuid,R=[],B.paths.forEach(function(e){R.push([e.X,e.Y,e.Z])}),A=new s({hasZ:!0,hasM:!0,rings:R,spatialReference:this.view.spatialReference}),S=new n({geometry:A,attributes:z}),u.push(S),k.source.add(S),this.mapoverlayersflayer.push([B.uuid,B.uuid,S])),this.view.map.add(k),B.label.visible&&(I=void 0,B.label.labelingInfo?(I=B.label.labelingInfo,k.labelingInfo=I):(I="2d"===this.view.type?{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:B.label.color},size:B.label.size,halo:{color:B.label.haloColor,size:B.label.haloSize}}]},E=new r({labelExpressionInfo:{expression:"$feature.NAME"},symbol:I,labelPlacement:B.label.placement,minScale:B.label.minScale,maxScale:B.label.maxScale}),k.labelingInfo=[E])))),[2,new _.Promise(function(e,t){e(u)})]}})})},je.prototype.addfeature=function(b){return Pe(this,void 0,void 0,function(){var t,a,s,c,u,d,i,y,r,o,n,l,p,f,h=this;return Me(this,function(e){switch(e.label){case 0:return[4,P(["esri/layers/FeatureLayer","esri/layers/support/LabelClass","esri/Graphic","esri/geometry/Point","esri/geometry/Circle","esri/symbols/PictureMarkerSymbol","esri/geometry/Polyline","esri/geometry/Polygon"])];case 1:return(t=e.sent())[0],t[1],a=t[2],s=t[3],c=t[4],t[5],u=t[6],d=t[7],(i=this.view.map.findLayerById(this.displayedLayerid))&&(y=[],b instanceof Array?(b.forEach(function(e){if("marker"===e.overlaytype.toLowerCase()){(o=e.attributes).uuid=e.uuid;var t=new a({geometry:new s({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:h.view.spatialReference}),attributes:o});y.push(t),h.mapoverlayersflayer.push([e.uuid,e.uuid,t])}else if("circle"===e.overlaytype.toLowerCase())(o=e.attributes).uuid=e.uuid,t=new a({geometry:new c({center:new s({x:e.center.X,y:e.center.Y,z:e.center.Z,spatialReference:h.view.spatialReference}),radius:e.radius,radiusUnit:e.radiusUnit,spatialReference:h.view.spatialReference}),attributes:o}),y.push(t),h.mapoverlayersflayer.push([e.uuid,e.uuid,t]);else if("polyline"===e.overlaytype.toLowerCase()){(o=e.attributes).uuid=e.uuid;var i=[];e.path.forEach(function(e){i.push([e.X,e.Y,e.Z])});var r=new u({hasZ:!1,hasM:!1,paths:i,spatialReference:h.view.spatialReference});t=new a({geometry:r,attributes:o}),y.push(t),h.mapoverlayersflayer.push([e.uuid,e.uuid,t])}else if("polygon"===e.overlaytype.toLowerCase()){var o;(o=e.attributes).uuid=e.uuid;var n=[];e.paths.forEach(function(e){n.push([e.X,e.Y,e.Z])});var l=new d({hasZ:!0,hasM:!0,rings:n,spatialReference:h.view.spatialReference});t=new a({geometry:l,attributes:o}),y.push(t),h.mapoverlayersflayer.push([e.uuid,e.uuid,t])}}),i.applyEdits({addFeatures:y}).then(function(e){return new _.Promise(function(e,t){e(y)})})):("marker"===b.overlaytype.toLowerCase()?((n=b.attributes).uuid=b.uuid,f=new a({geometry:new s({x:b.position[0],y:b.position[1],z:void 0===b.position[2]?0:b.position[2],spatialReference:this.view.spatialReference}),attributes:n}),y.push(f),this.mapoverlayersflayer.push([b.uuid,b.uuid,f])):"circle"===b.overlaytype.toLowerCase()?((n=b.attributes).uuid=b.uuid,f=new a({geometry:new c({center:new s({x:b.center.X,y:b.center.Y,z:b.center.Z,spatialReference:this.view.spatialReference}),radius:b.radius,radiusUnit:b.radiusUnit,spatialReference:this.view.spatialReference}),attributes:n}),y.push(f),this.mapoverlayersflayer.push([b.uuid,b.uuid,f])):"polyline"===b.overlaytype.toLowerCase()?((n=b.attributes).uuid=b.uuid,r=[],b.path.forEach(function(e){r.push([e.X,e.Y,e.Z])}),o=new u({hasZ:!1,hasM:!1,paths:r,spatialReference:this.view.spatialReference}),f=new a({geometry:o,attributes:n}),y.push(f),this.mapoverlayersflayer.push([b.uuid,b.uuid,f])):"polygon"===b.overlaytype.toLowerCase()&&((n=b.attributes).uuid=b.uuid,l=[],b.paths.forEach(function(e){l.push([e.X,e.Y,e.Z])}),p=new d({hasZ:!0,hasM:!0,rings:l,spatialReference:this.view.spatialReference}),f=new a({geometry:p,attributes:n}),y.push(f),this.mapoverlayersflayer.push([b.uuid,b.uuid,f])),i.applyEdits({addFeatures:y}).then(function(e){return new _.Promise(function(e,t){e(y)})}))),[2]}})})},je.prototype.updatefeature=function(f){return Pe(this,void 0,void 0,function(){var t,a,s,c,u,d,i,y,p=this;return Me(this,function(e){switch(e.label){case 0:return[4,P(["esri/layers/FeatureLayer","esri/layers/support/LabelClass","esri/Graphic","esri/geometry/Point","esri/geometry/Circle","esri/symbols/PictureMarkerSymbol","esri/geometry/Polyline","esri/geometry/Polygon"])];case 1:return(t=e.sent())[0],t[1],t[2],a=t[3],s=t[4],t[5],c=t[6],u=t[7],this.view.map.findLayerById(this.displayedLayerid)&&(d=[],f instanceof Array?(f.forEach(function(t){var i=p.mapoverlayersflayer.filter(function(e){return e[1]===t.uuid});if(1===i.length){if("marker"===t.overlaytype.toLowerCase()){var e=new a({x:t.position[0],y:t.position[1],z:void 0===t.position[2]?0:t.position[2],spatialReference:p.view.spatialReference});i[0][2].geometry=e}else if("circle"===t.overlaytype.toLowerCase())e=new s({center:new a({x:t.center.X,y:t.center.Y,z:t.center.Z,spatialReference:p.view.spatialReference}),radius:t.radius,radiusUnit:t.radiusUnit,spatialReference:p.view.spatialReference}),i[0][2].geometry=e;else if("polyline"===t.overlaytype.toLowerCase()){var r=[];t.path.forEach(function(e){r.push([e.X,e.Y,e.Z])});var o=new c({hasZ:!1,hasM:!1,paths:r,spatialReference:p.view.spatialReference});i[0][2].geometry=o}else if("polygon"===t.overlaytype.toLowerCase()){var n=[];t.paths.forEach(function(e){n.push([e.X,e.Y,e.Z])});var l=new u({hasZ:!0,hasM:!0,rings:n,spatialReference:p.view.spatialReference});i[0][2].geometry=l}Object.keys(t.attributes).map(function(e){"objectId"!==e&&i[0][2].setAttribute(e,t.attributes[e])}),d.push(i[0][2])}}),(i=this.view.map.findLayerById(this.displayedLayerid))&&d.length&&i.applyEdits({updateFeatures:d}).then(function(e){return new _.Promise(function(e,t){e(d)})})):"group"===f.type?(f.overlayers.forEach(function(t){var i=p.mapoverlayersflayer.filter(function(e){return e[1]===t.uuid});if(1===i.length){if("marker"===t.overlaytype.toLowerCase()){var e=new a({x:t.position[0],y:t.position[1],z:void 0===t.position[2]?0:t.position[2],spatialReference:p.view.spatialReference});i[0][2].geometry=e}else if("circle"===t.overlaytype.toLowerCase())e=new s({center:new a({x:t.center.X,y:t.center.Y,z:t.center.Z,spatialReference:p.view.spatialReference}),radius:t.radius,radiusUnit:t.radiusUnit,spatialReference:p.view.spatialReference}),i[0][2].geometry=e;else if("polyline"===t.overlaytype.toLowerCase()){var r=[];t.path.forEach(function(e){r.push([e.X,e.Y,e.Z])});var o=new c({hasZ:!1,hasM:!1,paths:r,spatialReference:p.view.spatialReference});i[0][2].geometry=o}else if("polygon"===t.overlaytype.toLowerCase()){var n=[];t.paths.forEach(function(e){n.push([e.X,e.Y,e.Z])});var l=new u({hasZ:!0,hasM:!0,rings:n,spatialReference:p.view.spatialReference});i[0][2].geometry=l}Object.keys(t.attributes).map(function(e){"objectId"!==e&&i[0][2].setAttribute(e,t.attributes[e])}),d.push(i[0][2])}}),(i=this.view.map.findLayerById(this.displayedLayerid))&&d.length&&i.applyEdits({updateFeatures:d}).then(function(e){return new _.Promise(function(e,t){e(d)})})):"element"===f.type&&(y=this.mapoverlayersflayer.filter(function(e){return e[1]===f.uuid})).forEach(function(t){if(f.attributes.uuid=f.uuid,"marker"===f.overlaytype.toLowerCase()){var e=new a({x:f.position[0],y:f.position[1],z:void 0===f.position[2]?0:f.position[2],spatialReference:p.view.spatialReference});t[2].geometry=e}else if("circle"===f.overlaytype.toLowerCase())e=new s({center:new a({x:f.center.X,y:f.center.Y,z:f.center.Z,spatialReference:p.view.spatialReference}),radius:f.radius,radiusUnit:f.radiusUnit,spatialReference:p.view.spatialReference}),y[0][2].geometry=e;else if("polyline"===f.overlaytype.toLowerCase()){var i=[];f.path.forEach(function(e){i.push([e.X,e.Y,e.Z])});var r=new c({hasZ:!1,hasM:!1,paths:i,spatialReference:p.view.spatialReference});y[0][2].geometry=r}else if("polygon"===f.overlaytype.toLowerCase()){var o=[];f.paths.forEach(function(e){o.push([e.X,e.Y,e.Z])});var n=new u({hasZ:!0,hasM:!0,rings:o,spatialReference:p.view.spatialReference});y[0][2].geometry=n}Object.keys(f.attributes).map(function(e){"objectId"!==e&&t[2].setAttribute(e,f.attributes[e])}),d.push(t[2]);var l=p.view.map.findLayerById(p.displayedLayerid);l&&d.length&&l.applyEdits({updateFeatures:d}).then(function(e){return new _.Promise(function(e,t){e(d)})})})),[2]}})})},je.prototype.removefeature=function(t){var e=this;if(this.view.map.findLayerById(this.displayedLayerid))if(t instanceof Array){var i=[];t.forEach(function(t){e.mapoverlayersflayer.filter(function(e){return e[1]===t.uuid}).forEach(function(e){i.push(e[2])}),e.mapoverlayersflayer=e.mapoverlayersflayer.filter(function(e){return e[1]!==t.uuid})}),(n=this.view.map.findLayerById(this.displayedLayerid))&&i.length&&n.applyEdits({deleteFeatures:i}).then(function(e){})}else if("group"===t.type){var r=this.mapoverlayersflayer.filter(function(e){return e[0]===t.uuid}),o=[];r.forEach(function(e){o.push(e[2])}),(n=this.view.map.findLayerById(this.displayedLayerid))&&o.length&&n.applyEdits({deleteFeatures:o}).then(function(e){}),this.mapoverlayersflayer=this.mapoverlayersflayer.filter(function(e){return e[0]!==t.uuid})}else if("element"===t.type){r=this.mapoverlayersflayer.filter(function(e){return e[1]===t.uuid});var n,l=[];r.forEach(function(e){l.push(e[2])}),(n=this.view.map.findLayerById(this.displayedLayerid))&&l.length&&n.applyEdits({deleteFeatures:l}).then(function(e){}),this.mapoverlayersflayer=this.mapoverlayersflayer.filter(function(e){return e[1]!==t.uuid})}},je.prototype.removeAll=function(){var t=this,e=this.view.map.findLayerById(this.displayedLayerid);if(e){var i=[];this.mapoverlayersflayer.forEach(function(e){i.push(e[2])}),e.applyEdits({deleteFeatures:i}).then(function(e){t.mapoverlayersflayer=[]})}},je.prototype.delete=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(this.view.map.remove(e),this.mapoverlayersflayer=[])},je.prototype.addcluster=function(e){var t=this.view.map.findLayerById(this.displayedLayerid);t&&(t.featureReduction=e)},je.prototype.deletecluster=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.featureReduction=null)},je.prototype.show=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!0)},je.prototype.hide=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!1)},je.prototype.init=function(i){return Pe(this,void 0,void 0,function(){var t=this;return Me(this,function(e){return this.displayedLayerid=(new x).uuid,this.view=i,this.view.on(S.click,function(l){t.view.hitTest(l).then(function(n){return Pe(t,void 0,void 0,function(){var t,i,r,o=this;return Me(this,function(e){if(0<n.results.length){if(!n.results[0].graphic.layer)return[2];if(!(t=n.results[0].graphic.layer.id))return[2];t===this.displayedLayerid&&(i=n.results[0].graphic.attributes.objectId,(r=n.results[0].graphic.layer.createQuery()).where="objectId ="+i,n.results[0].graphic.layer.queryFeatures(r).then(function(e){0<e.features.length&&o.emit(S.click,e.features,l,l.mapPoint)}))}return[2]})})})}),this.view.on(S.pointermove,function(a){t.view.hitTest(a).then(function(l){return Pe(t,void 0,void 0,function(){var t,i,r,o,n=this;return Me(this,function(e){if(0<l.results.length){if(!l.results[0].graphic.layer)return[2];if(!(t=l.results[0].graphic.layer.id))return[2];t===this.displayedLayerid&&(i=l.results[0].graphic.attributes.objectId,(r=l.results[0].graphic.layer.createQuery()).where="objectId ="+i,l.results[0].graphic.layer.queryFeatures(r).then(function(e){0<e.features.length&&(n.eventResult=e.features,n.emit(S.pointermove,e.features,a,n.view.toMap({x:a.x,y:a.y})))}))}else{if(null===this.eventResult)return[2];o=this.eventResult,this.eventResult=null,this.emit(S.pointerleave,o,a,this.view.toMap({x:a.x,y:a.y}))}return[2]})})})}),[2]})})},je);function je(e){var t=Be.call(this)||this;return t.displayedLayerid="",t.view=null,t.mapoverlayersflayer=[],t.eventResult=null,t.init(e),t}var We,De,Te=(We=function(e,t){return(We=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}We(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ze=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},He=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Ge=(Te(qe,De=e),qe.prototype.add=function(o){var n=this;P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/4E3CE3AF-B592-B4F6-576E1B86F84B6969","esri/geometry/Point","esri/views/3d/externalRenderers"]).then(function(e){var t=e[0],i=e[1],r=e[2];o.points&&(n.markpoints=o.points.map(function(e){return e.markerid=(new x).uuid,e}),n.markpointscontainerid=(new x).uuid,n.flashGifLayer=new t({points:n.markpoints,view:n.view,markercontainerid:n.markpointscontainerid},function(e){var t=null;null!=e&&(t=new i({x:e.x,y:e.y,spatialReference:{wkid:102100}})),n.emit(S.click,e,t)},function(e){var t=null;null!=e&&(t=new i({x:e.x,y:e.y,spatialReference:{wkid:102100}})),n.emit(S.pointermove,e,t)}),r.add(n.view,n.flashGifLayer),n.markpointsRendererArray.push([(new x).uuid,n.flashGifLayer]))})},qe.prototype.remove=function(){var r=this;P(["esri/views/3d/externalRenderers"]).then(function(e){var t=e[0];r.markpointsRendererArray.map(function(e){t.remove(r.view,e[1])}),r.markpointsRendererArray=[],r.markpoints.forEach(function(e){var t=document.getElementById(r.markpointscontainerid),i=document.getElementById(e.markerid);null!==i&&t.removeChild(i)})})},qe.prototype.init=function(t){return Ze(this,void 0,void 0,function(){return He(this,function(e){return this.view=t,[2]})})},qe);function qe(e){var t=De.call(this)||this;return t.markpointsRendererArray=[],t.markpoints=null,t.view=null,t.flashGifLayer=null,t.markpointscontainerid=null,t.init(e),t}var Je,Xe,Ye=(Je=function(e,t){return(Je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Je(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ue=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},Ne=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Ve=(Ye($e,Xe=e),$e.prototype.add=function(o){var n=this;P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/92586C78-6DE2-946F-F03F88AF0F8D0D7F","esri/geometry/Point","esri/views/3d/externalRenderers"]).then(function(e){var t=e[0],i=e[1],r=e[2];n.falshpoint3DRenderer=new t({nring:o.nring,spead:o.spead,size:o.size,color:o.color,view:o.view,points:o.points},function(e){var t=null;null!=e&&(t=new i({x:e.x,y:e.y,spatialReference:{wkid:102100}})),n.emit(S.click,e,t)},function(e){var t=null;null!=e&&(t=new i({x:e.x,y:e.y,spatialReference:{wkid:102100}})),n.emit(S.pointermove,e,t)}),r.add(n.view,n.falshpoint3DRenderer)})},$e.prototype.remove=function(){var i=this;P(["esri/views/3d/externalRenderers"]).then(function(e){var t=e[0];i.falshpoint3DRenderer&&t.remove(i.view,i.falshpoint3DRenderer)})},$e.prototype.init=function(t){return Ue(this,void 0,void 0,function(){return Ne(this,function(e){return this.view=t,[2]})})},$e);function $e(e){var t=Xe.call(this)||this;return t.view=null,t.falshpoint3DRenderer=null,t.init(e),t}var Qe,Ke,et=(Qe=function(e,t){return(Qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Qe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),tt=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},it=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},rt=(et(ot,Ke=e),ot.prototype.add=function(B){return tt(this,void 0,void 0,function(){var t,L,C,i,k,z,R,A,r,o,n,l,a,s,c,u,d,y,p,f,h,b,v,m,w,g,x,S,I,E,F=this;return it(this,function(e){switch(e.label){case 0:return[4,P(["esri/Graphic","esri/geometry/Point","esri/layers/GraphicsLayer","esri/symbols/PictureMarkerSymbol","esri/geometry/Polyline","esri/geometry/Polygon","esri/geometry/Circle"])];case 1:return t=e.sent(),L=t[0],C=t[1],i=t[2],t[3],k=t[4],z=t[5],R=t[6],A=[],(r=this.view.map.findLayerById(this.displayedLayerid))||(r=new i({id:this.displayedLayerid,title:"Overlayer-"+this.displayedLayerid}),this.view.map.add(r)),B instanceof Array?B.forEach(function(e){if("marker"===e.overlaytype.toLowerCase()){var t=void 0;t=e.symbol?e.symbol:"2d"===F.view.type?{type:"picture-marker",url:e.icon.image,width:e.icon.size.width,height:e.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:e.icon.size.width,resource:{href:e.icon.image}}]};var i=e.attributes;i.uuid=e.uuid;var r=new L({geometry:new C({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:F.view.spatialReference}),symbol:t,attributes:i});if(A.push(r),F.mapoverlayers.push(["smap-default",e.uuid,r]),(w=F.view.map.findLayerById(F.displayedLayerid))&&w.add(r),e.label.visible){var o=null;o=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}};var n=new L({geometry:new C({x:"3d"===F.view.type?e.position[0]+e.label.xoffset:e.position[0],y:"3d"===F.view.type?e.position[1]+e.label.yoffset:e.position[1],z:"3d"===F.view.type?e.position[2]+e.label.zoffset:e.position[2],spatialReference:F.view.spatialReference}),symbol:o,attributes:i});(g=F.view.map.findLayerById(F.displayedLayerid))&&g.add(n),F.mapoverlayers.push(["smap-default",e.uuid,n])}}else if("polyline"===e.overlaytype.toLowerCase()){var l=null;l=e.symbol?e.symbol:{type:"simple-line",color:e.strokeColor,style:e.style,width:e.width,cap:e.cap,join:e.lineJoin};var a=[];e.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var s=new k({hasZ:!1,hasM:!1,paths:a,spatialReference:F.view.spatialReference}),c=e.attributes;c.uuid=e.uuid;var u=new L({geometry:s,symbol:l,attributes:c});if(A.push(u),F.mapoverlayers.push(["smap-default",e.uuid,u]),(w=F.view.map.findLayerById(F.displayedLayerid))&&w.add(u),e.label.visible){var d=null;d=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},n=new L({geometry:u.geometry.extent.center,symbol:d,attributes:c}),(g=F.view.map.findLayerById(F.displayedLayerid))&&g.add(n),F.mapoverlayers.push(["smap-default",e.uuid,n])}}else if("polygon"===e.overlaytype.toLowerCase()){var y=void 0;y=e.symbol?e.symbol:"simple"===e.symboltype?{type:"simple-fill",color:e.fillColor,style:e.style,outline:{color:e.strokeColor,width:e.strokeWeight,style:e.strokestyle}}:{type:"picture-fill",url:e.url,width:e.picwidth,height:e.picheight,outline:{style:e.strokestyle,color:e.strokeColor,width:e.strokeWeight}};var p=[];e.paths.forEach(function(e){p.push([e.X,e.Y,e.Z])});var f=new z({hasZ:!0,hasM:!0,rings:p,spatialReference:F.view.spatialReference}),h=e.attributes;h.uuid=e.uuid;var b=new L({geometry:f,symbol:y,attributes:h});if(A.push(b),F.mapoverlayers.push(["smap-default",e.uuid,b]),(w=F.view.map.findLayerById(F.displayedLayerid))&&w.add(b),e.label.visible){var v=null;v=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},n=new L({geometry:b.geometry.extent.center,symbol:v,attributes:h}),(g=F.view.map.findLayerById(F.displayedLayerid))&&g.add(n),F.mapoverlayers.push(["smap-default",e.uuid,n])}}else if("circle"===e.overlaytype.toLowerCase()&&(y=void 0,y=e.symbol?e.symbol:"simple"===e.symboltype?{type:"simple-fill",color:e.fillColor,style:e.style,outline:{color:e.strokeColor,width:e.strokeWeight,style:e.strokestyle}}:{type:"picture-fill",url:e.url,width:e.picwidth,height:e.picheight,outline:{style:e.strokestyle,color:e.strokeColor,width:e.strokeWeight}},e.attributes&&e.center&&e.radius)){var m=e.attributes;m.uuid=e.uuid;var w,g,x=new L({geometry:new R({center:new C({x:e.center.X,y:e.center.Y,z:e.center.Z,spatialReference:F.view.spatialReference}),radius:e.radius,radiusUnit:e.radiusUnit,spatialReference:F.view.spatialReference}),symbol:y,attributes:m});if(A.push(x),F.mapoverlayers.push(["smap-default",e.uuid,x]),(w=F.view.map.findLayerById(F.displayedLayerid))&&w.add(x),e.label.visible)v=null,v=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},n=new L({geometry:x.geometry.extent.center,symbol:v,attributes:m}),(g=F.view.map.findLayerById(F.displayedLayerid))&&g.add(n),F.mapoverlayers.push(["smap-default",e.uuid,n])}}):"group"===B.type?B.overlayers.forEach(function(e){if("marker"===e.overlaytype.toLowerCase()){var t=void 0;t=e.symbol?e.symbol:"2d"===F.view.type?{type:"picture-marker",url:e.icon.image,width:e.icon.size.width,height:e.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:e.icon.size.width,resource:{href:e.icon.image}}]};var i=e.attributes;i.uuid=e.uuid;var r=new L({geometry:new C({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:F.view.spatialReference}),symbol:t,attributes:i});if(A.push(r),F.mapoverlayers.push([B.uuid,e.uuid,r]),(g=F.view.map.findLayerById(F.displayedLayerid))&&g.add(r),e.label.visible){var o=null;o=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}};var n=new L({geometry:new C({x:"3d"===F.view.type?e.position[0]+e.label.xoffset:e.position[0],y:"3d"===F.view.type?e.position[1]+e.label.yoffset:e.position[1],z:"3d"===F.view.type?e.position[2]+e.label.zoffset:e.position[2],spatialReference:F.view.spatialReference}),symbol:o,attributes:i});(w=F.view.map.findLayerById(F.displayedLayerid))&&w.add(n),F.mapoverlayers.push([B.uuid,e.uuid,n])}}else if("polyline"===e.overlaytype.toLowerCase()){var l=null;l=e.symbol?e.symbol:{type:"simple-line",color:e.strokeColor,style:e.style,width:e.width,cap:e.cap,join:e.lineJoin};var a=[];e.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var s=new k({hasZ:!1,hasM:!1,paths:a,spatialReference:F.view.spatialReference}),c=e.attributes;c.uuid=e.uuid;var u=new L({geometry:s,symbol:l,attributes:c});if(A.push(u),F.mapoverlayers.push([B.uuid,e.uuid,u]),(w=F.view.map.findLayerById(F.displayedLayerid))&&w.add(u),e.label.visible){var d=null;d=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},n=new L({geometry:u.geometry.extent.center,symbol:d,attributes:c}),(g=F.view.map.findLayerById(F.displayedLayerid))&&g.add(n),F.mapoverlayers.push([B.uuid,e.uuid,n])}}else if("polygon"===e.overlaytype.toLowerCase()){var y=void 0;y=e.symbol?e.symbol:"simple"===e.symboltype?{type:"simple-fill",color:e.fillColor,style:e.style,outline:{color:e.strokeColor,width:e.strokeWeight,style:e.strokestyle}}:{type:"picture-fill",url:e.url,width:e.picwidth,height:e.picheight,outline:{style:e.strokestyle,color:e.strokeColor,width:e.strokeWeight}};var p=[];e.paths.forEach(function(e){p.push([e.X,e.Y,e.Z])});var f=e.attributes;f.uuid=e.uuid;var h=new z({hasZ:!0,hasM:!0,rings:p,spatialReference:F.view.spatialReference}),b=new L({geometry:h,symbol:y,attributes:f});if(A.push(b),F.mapoverlayers.push([B.uuid,e.uuid,b]),(g=F.view.map.findLayerById(F.displayedLayerid))&&g.add(b),e.label.visible){var v=null;v=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},n=new L({geometry:b.geometry.extent.center,symbol:v,attributes:f}),(w=F.view.map.findLayerById(F.displayedLayerid))&&w.add(n),F.mapoverlayers.push([B.uuid,e.uuid,n])}}else if("circle"===e.overlaytype.toLowerCase()&&(y=void 0,y=e.symbol?e.symbol:"simple"===e.symboltype?{type:"simple-fill",color:e.fillColor,style:e.style,outline:{color:e.strokeColor,width:e.strokeWeight,style:e.strokestyle}}:{type:"picture-fill",url:e.url,width:e.picwidth,height:e.picheight,outline:{style:e.strokestyle,color:e.strokeColor,width:e.strokeWeight}},e.attributes&&e.center&&e.radius)){var m=e.attributes;m.uuid=e.uuid;var w,g,x=new L({geometry:new R({center:new C({x:e.center.X,y:e.center.Y,z:e.center.Z,spatialReference:F.view.spatialReference}),radius:e.radius,radiusUnit:e.radiusUnit,spatialReference:F.view.spatialReference}),symbol:y,attributes:m});if(A.push(x),F.mapoverlayers.push(["smap-default",e.uuid,x]),(w=F.view.map.findLayerById(F.displayedLayerid))&&w.add(x),e.label.visible)v=null,v=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},n=new L({geometry:x.geometry.extent.center,symbol:v,attributes:m}),(g=F.view.map.findLayerById(F.displayedLayerid))&&g.add(n),F.mapoverlayers.push(["smap-default",e.uuid,n])}}):"element"===B.type&&("marker"===B.overlaytype.toLowerCase()?(o=void 0,o=B.symbol?B.symbol:"2d"===this.view.type?{type:"picture-marker",url:B.icon.image,width:B.icon.size.width,height:B.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:B.icon.size.width,resource:{href:B.icon.image}}]},(n=B.attributes).uuid=B.uuid,l=new L({geometry:new C({x:B.position[0],y:B.position[1],z:void 0===B.position[2]?0:B.position[2],spatialReference:this.view.spatialReference}),symbol:o,attributes:n}),A.push(l),this.mapoverlayers.push(["smap-default",B.uuid,l]),(x=this.view.map.findLayerById(this.displayedLayerid))&&x.add(l),B.label.visible&&(a=null,a=B.label.labelingInfo?B.label.labelingInfo:{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}},I=new L({geometry:new C({x:"3d"===this.view.type?B.position[0]+B.label.xoffset:B.position[0],y:"3d"===this.view.type?B.position[1]+B.label.yoffset:B.position[1],z:"3d"===this.view.type?B.position[2]+B.label.zoffset:B.position[2],spatialReference:this.view.spatialReference}),symbol:a,attributes:n}),(E=this.view.map.findLayerById(this.displayedLayerid))&&E.add(I),this.mapoverlayers.push(["smap-default",B.uuid,I]))):"polyline"===B.overlaytype.toLowerCase()?(s=null,s=B.symbol?B.symbol:{type:"simple-line",color:B.strokeColor,style:B.style,width:B.width,cap:B.cap,join:B.lineJoin},c=[],B.path.forEach(function(e){c.push([e.X,e.Y,e.Z])}),u=new k({hasZ:!1,hasM:!1,paths:c,spatialReference:this.view.spatialReference}),(d=B.attributes).uuid=B.uuid,y=new L({geometry:u,symbol:s,attributes:d}),A.push(y),this.mapoverlayers.push(["smap-default",B.uuid,y]),(E=this.view.map.findLayerById(this.displayedLayerid))&&E.add(y),B.label.visible&&(v=null,v=B.label.labelingInfo?B.label.labelingInfo:{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}},I=new L({geometry:y.geometry.extent.center,symbol:v,attributes:d}),(x=this.view.map.findLayerById(this.displayedLayerid))&&x.add(I),this.mapoverlayers.push(["smap-default",B.uuid,I]))):"polygon"===B.overlaytype.toLowerCase()?(m=void 0,m=B.symbol?B.symbol:"simple"===B.symboltype?{type:"simple-fill",color:B.fillColor,style:B.style,outline:{color:B.strokeColor,width:B.strokeWeight,style:B.strokestyle}}:{type:"picture-fill",url:B.url,width:B.picwidth,height:B.picheight,outline:{style:B.strokestyle,color:B.strokeColor,width:B.strokeWeight}},p=[],B.paths.forEach(function(e){p.push([e.X,e.Y,e.Z])}),(f=B.attributes).uuid=B.uuid,h=new z({hasZ:!0,hasM:!0,rings:p,spatialReference:this.view.spatialReference}),b=new L({geometry:h,symbol:m,attributes:f}),A.push(b),this.mapoverlayers.push(["smap-default",B.uuid,b]),(x=this.view.map.findLayerById(this.displayedLayerid))&&x.add(b),B.label.visible&&(v=null,v=B.label.labelingInfo?B.label.labelingInfo:{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}},I=new L({geometry:b.geometry.extent.center,symbol:v,attributes:f}),(E=this.view.map.findLayerById(this.displayedLayerid))&&E.add(I),this.mapoverlayers.push(["smap-default",B.uuid,I]))):"circle"===B.overlaytype.toLowerCase()&&(m=void 0,m=B.symbol?B.symbol:"simple"===B.symboltype?{type:"simple-fill",color:B.fillColor,style:B.style,outline:{color:B.strokeColor,width:B.strokeWeight,style:B.strokestyle}}:{type:"picture-fill",url:B.url,width:B.picwidth,height:B.picheight,outline:{style:B.strokestyle,color:B.strokeColor,width:B.strokeWeight}},B.attributes&&B.center&&B.radius&&((w=B.attributes).uuid=B.uuid,g=new L({geometry:new R({center:new C({x:B.center.X,y:B.center.Y,z:B.center.Z,spatialReference:this.view.spatialReference}),radius:B.radius,radiusUnit:B.radiusUnit,spatialReference:this.view.spatialReference}),symbol:m,attributes:w}),A.push(g),this.mapoverlayers.push(["smap-default",B.uuid,g]),(x=this.view.map.findLayerById(this.displayedLayerid))&&x.add(g),B.label.visible&&(S=null,S=B.label.labelingInfo?B.label.labelingInfo:{type:B.label.type,text:B.label.text,color:B.label.color,angle:B.label.angle,backgroundColor:B.label.backgroundColor,borderLineColor:B.label.borderLineColor,borderLineSize:B.label.borderLineSize,kerning:B.label.kerning,lineHeight:B.label.lineHeight,lineWidth:B.label.lineWidth,rotated:B.label.rotated,haloColor:B.label.haloColor,haloSize:B.label.haloSize,xoffset:B.label.xoffset,yoffset:B.label.yoffset,verticalAlignment:B.label.verticalAlignment,horizontalAlignment:B.label.horizontalAlignment,font:{size:B.label.size,family:"Josefin Slab",weight:B.label.weight}},I=new L({geometry:g.geometry.extent.center,symbol:S,attributes:w}),(E=this.view.map.findLayerById(this.displayedLayerid))&&E.add(I),this.mapoverlayers.push(["smap-default",B.uuid,I]))))),[2,new _.Promise(function(e,t){e(A)})]}})})},ot.prototype.remove=function(t){var i=this;t instanceof Array?t.forEach(function(t){i.mapoverlayers.filter(function(e){return e[1]===t.uuid}).forEach(function(e){var t=i.view.map.findLayerById(i.displayedLayerid);t&&t.remove(e[2])}),i.mapoverlayers=i.mapoverlayers.filter(function(e){return e[1]!==t.uuid})}):"group"===t.type?(this.mapoverlayers.filter(function(e){return e[0]===t.uuid}).forEach(function(e){var t=i.view.map.findLayerById(i.displayedLayerid);t&&t.remove(e[2])}),this.mapoverlayers=this.mapoverlayers.filter(function(e){return e[0]!==t.uuid})):"element"===t.type&&(this.mapoverlayers.filter(function(e){return e[1]===t.uuid}).forEach(function(e){var t=i.view.map.findLayerById(i.displayedLayerid);t&&t.remove(e[2])}),this.mapoverlayers=this.mapoverlayers.filter(function(e){return e[1]!==t.uuid}))},ot.prototype.update=function(E){return tt(this,void 0,void 0,function(){var t,L,C,k,z,R,A,i,r,o,n,l,a,s,c,u,d,y,p,f,h,b,v,m,w,g,x,S,I=this;return it(this,function(e){switch(e.label){case 0:return[4,P(["esri/Graphic","esri/geometry/Point","esri/layers/GraphicsLayer","esri/symbols/PictureMarkerSymbol","esri/geometry/Polyline","esri/geometry/Polygon","esri/geometry/Circle"])];case 1:return t=e.sent(),L=t[0],C=t[1],t[2],t[3],k=t[4],z=t[5],R=t[6],A=[],E instanceof Array?E.forEach(function(t){if(I.mapoverlayers.filter(function(e){return e[1]===t.uuid}).forEach(function(e){var t=I.view.map.findLayerById(I.displayedLayerid);t&&t.remove(e[2])}),I.mapoverlayers=I.mapoverlayers.filter(function(e){return e[1]!==t.uuid}),"marker"===t.overlaytype.toLowerCase()){var e=void 0;e=t.symbol?t.symbol:"2d"===I.view.type?{type:"picture-marker",url:t.icon.image,width:t.icon.size.width,height:t.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:t.icon.size.width,resource:{href:t.icon.image}}]};var i=t.attributes;i.uuid=t.uuid;var r=new L({geometry:new C({x:t.position[0],y:t.position[1],z:void 0===t.position[2]?0:t.position[2],spatialReference:I.view.spatialReference}),symbol:e,attributes:i});if(A.push(r),I.mapoverlayers.push(["smap-default",t.uuid,r]),(g=I.view.map.findLayerById(I.displayedLayerid))&&g.add(r),t.label.visible){var o=null;o=t.label.labelingInfo?t.label.labelingInfo:{type:t.label.type,text:t.label.text,color:t.label.color,angle:t.label.angle,backgroundColor:t.label.backgroundColor,borderLineColor:t.label.borderLineColor,borderLineSize:t.label.borderLineSize,kerning:t.label.kerning,lineHeight:t.label.lineHeight,lineWidth:t.label.lineWidth,rotated:t.label.rotated,haloColor:t.label.haloColor,haloSize:t.label.haloSize,xoffset:t.label.xoffset,yoffset:t.label.yoffset,verticalAlignment:t.label.verticalAlignment,horizontalAlignment:t.label.horizontalAlignment,font:{size:t.label.size,family:"Josefin Slab",weight:t.label.weight}};var n=new L({geometry:new C({x:"3d"===I.view.type?t.position[0]+t.label.xoffset:t.position[0],y:"3d"===I.view.type?t.position[1]+t.label.yoffset:t.position[1],z:"3d"===I.view.type?t.position[2]+t.label.zoffset:t.position[2],spatialReference:I.view.spatialReference}),symbol:o,attributes:i});(w=I.view.map.findLayerById(I.displayedLayerid))&&w.add(n),I.mapoverlayers.push(["smap-default",t.uuid,n])}}else if("polyline"===t.overlaytype.toLowerCase()){var l=null;l=t.symbol?t.symbol:{type:"simple-line",color:t.strokeColor,style:t.style,width:t.width,cap:t.cap,join:t.lineJoin};var a=[];t.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var s=new k({hasZ:!1,hasM:!1,paths:a,spatialReference:I.view.spatialReference}),c=t.attributes;c.uuid=t.uuid;var u=new L({geometry:s,symbol:l,attributes:c});if(A.push(u),I.mapoverlayers.push(["smap-default",t.uuid,u]),(w=I.view.map.findLayerById(I.displayedLayerid))&&w.add(u),t.label.visible){var d=null;d=t.label.labelingInfo?t.label.labelingInfo:{type:t.label.type,text:t.label.text,color:t.label.color,angle:t.label.angle,backgroundColor:t.label.backgroundColor,borderLineColor:t.label.borderLineColor,borderLineSize:t.label.borderLineSize,kerning:t.label.kerning,lineHeight:t.label.lineHeight,lineWidth:t.label.lineWidth,rotated:t.label.rotated,haloColor:t.label.haloColor,haloSize:t.label.haloSize,xoffset:t.label.xoffset,yoffset:t.label.yoffset,verticalAlignment:t.label.verticalAlignment,horizontalAlignment:t.label.horizontalAlignment,font:{size:t.label.size,family:"Josefin Slab",weight:t.label.weight}},n=new L({geometry:u.geometry.extent.center,symbol:d,attributes:c}),(g=I.view.map.findLayerById(I.displayedLayerid))&&g.add(n),I.mapoverlayers.push(["smap-default",t.uuid,n])}}else if("polygon"===t.overlaytype.toLowerCase()){var y=void 0;y=t.symbol?t.symbol:"simple"===t.symboltype?{type:"simple-fill",color:t.fillColor,style:t.style,outline:{color:t.strokeColor,width:t.strokeWeight,style:t.strokestyle}}:{type:"picture-fill",url:t.url,width:t.picwidth,height:t.picheight,outline:{style:t.strokestyle,color:t.strokeColor,width:t.strokeWeight}};var p=[];t.paths.forEach(function(e){p.push([e.X,e.Y,e.Z])});var f=new z({hasZ:!0,hasM:!0,rings:p,spatialReference:I.view.spatialReference}),h=t.attributes;h.uuid=t.uuid;var b=new L({geometry:f,symbol:y,attributes:h});if(A.push(b),I.mapoverlayers.push(["smap-default",t.uuid,b]),(g=I.view.map.findLayerById(I.displayedLayerid))&&g.add(b),t.label.visible){var v=null;v=t.label.labelingInfo?t.label.labelingInfo:{type:t.label.type,text:t.label.text,color:t.label.color,angle:t.label.angle,backgroundColor:t.label.backgroundColor,borderLineColor:t.label.borderLineColor,borderLineSize:t.label.borderLineSize,kerning:t.label.kerning,lineHeight:t.label.lineHeight,lineWidth:t.label.lineWidth,rotated:t.label.rotated,haloColor:t.label.haloColor,haloSize:t.label.haloSize,xoffset:t.label.xoffset,yoffset:t.label.yoffset,verticalAlignment:t.label.verticalAlignment,horizontalAlignment:t.label.horizontalAlignment,font:{size:t.label.size,family:"Josefin Slab",weight:t.label.weight}},n=new L({geometry:b.geometry.extent.center,symbol:v,attributes:h}),(w=I.view.map.findLayerById(I.displayedLayerid))&&w.add(n),I.mapoverlayers.push(["smap-default",t.uuid,n])}}else if("circle"===t.overlaytype.toLowerCase()&&(y=void 0,y=t.symbol?t.symbol:"simple"===t.symboltype?{type:"simple-fill",color:t.fillColor,style:t.style,outline:{color:t.strokeColor,width:t.strokeWeight,style:t.strokestyle}}:{type:"picture-fill",url:t.url,width:t.picwidth,height:t.picheight,outline:{style:t.strokestyle,color:t.strokeColor,width:t.strokeWeight}},t.attributes&&t.center&&t.radius)){var m=t.attributes;m.uuid=t.uuid;var w,g,x=new L({geometry:new R({center:new C({x:t.center.X,y:t.center.Y,z:t.center.Z,spatialReference:I.view.spatialReference}),radius:t.radius,radiusUnit:t.radiusUnit,spatialReference:I.view.spatialReference}),symbol:y,attributes:m});if(A.push(x),I.mapoverlayers.push(["smap-default",t.uuid,x]),(w=I.view.map.findLayerById(I.displayedLayerid))&&w.add(x),t.label.visible)v=null,v=t.label.labelingInfo?t.label.labelingInfo:{type:t.label.type,text:t.label.text,color:t.label.color,angle:t.label.angle,backgroundColor:t.label.backgroundColor,borderLineColor:t.label.borderLineColor,borderLineSize:t.label.borderLineSize,kerning:t.label.kerning,lineHeight:t.label.lineHeight,lineWidth:t.label.lineWidth,rotated:t.label.rotated,haloColor:t.label.haloColor,haloSize:t.label.haloSize,xoffset:t.label.xoffset,yoffset:t.label.yoffset,verticalAlignment:t.label.verticalAlignment,horizontalAlignment:t.label.horizontalAlignment,font:{size:t.label.size,family:"Josefin Slab",weight:t.label.weight}},n=new L({geometry:x.geometry.extent.center,symbol:v,attributes:m}),(g=I.view.map.findLayerById(I.displayedLayerid))&&g.add(n),I.mapoverlayers.push(["smap-default",t.uuid,n])}}):"group"===E.type?(this.mapoverlayers.filter(function(e){return e[0]===E.uuid}).forEach(function(e){var t=I.view.map.findLayerById(I.displayedLayerid);t&&t.remove(e[2])}),this.mapoverlayers=this.mapoverlayers.filter(function(e){return e[0]!==E.uuid}),E.overlayers.forEach(function(e){if("marker"===e.overlaytype.toLowerCase()){var t=void 0;t=e.symbol?e.symbol:"2d"===I.view.type?{type:"picture-marker",url:e.icon.image,width:e.icon.size.width,height:e.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:e.icon.size.width,resource:{href:e.icon.image}}]};var i=e.attributes;i.uuid=e.uuid;var r=new L({geometry:new C({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:I.view.spatialReference}),symbol:t,attributes:i});if(A.push(r),I.mapoverlayers.push([E.uuid,e.uuid,r]),(w=I.view.map.findLayerById(I.displayedLayerid))&&w.add(r),e.label.visible){var o=null;o=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}};var n=new L({geometry:new C({x:"3d"===I.view.type?e.position[0]+e.label.xoffset:e.position[0],y:"3d"===I.view.type?e.position[1]+e.label.yoffset:e.position[1],z:"3d"===I.view.type?e.position[2]+e.label.zoffset:e.position[2],spatialReference:I.view.spatialReference}),symbol:o,attributes:i});(g=I.view.map.findLayerById(I.displayedLayerid))&&g.add(n),I.mapoverlayers.push([E.uuid,e.uuid,n])}}else if("polyline"===e.overlaytype.toLowerCase()){var l=null;l=e.symbol?e.symbol:{type:"simple-line",color:e.strokeColor,style:e.style,width:e.width,cap:e.cap,join:e.lineJoin};var a=[];e.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var s=new k({hasZ:!1,hasM:!1,paths:a,spatialReference:I.view.spatialReference}),c=e.attributes;c.uuid=e.uuid;var u=new L({geometry:s,symbol:l,attributes:c});if(A.push(u),I.mapoverlayers.push([E.uuid,e.uuid,u]),(g=I.view.map.findLayerById(I.displayedLayerid))&&g.add(u),e.label.visible){var d=null;d=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},n=new L({geometry:u.geometry.extent.center,symbol:d,attributes:c}),(w=I.view.map.findLayerById(I.displayedLayerid))&&w.add(n),I.mapoverlayers.push([E.uuid,e.uuid,n])}}else if("polygon"===e.overlaytype.toLowerCase()){var y=void 0;y=e.symbol?e.symbol:"simple"===E.symboltype?{type:"simple-fill",color:E.fillColor,style:E.style,outline:{color:E.strokeColor,width:E.strokeWeight,style:E.strokestyle}}:{type:"picture-fill",url:E.url,width:E.picwidth,height:E.picheight,outline:{style:E.strokestyle,color:E.strokeColor,width:E.strokeWeight}};var p=[];E.paths.forEach(function(e){p.push([e.X,e.Y,e.Z])});var f=e.attributes;f.uuid=e.uuid;var h=new z({hasZ:!0,hasM:!0,rings:p,spatialReference:I.view.spatialReference}),b=new L({geometry:h,symbol:y,attributes:f});if(A.push(b),I.mapoverlayers.push(["smap-default",E.uuid,b]),(w=I.view.map.findLayerById(I.displayedLayerid))&&w.add(b),E.label.visible){var v=null;v=e.label.labelingInfo?e.label.labelingInfo:{type:E.label.type,text:E.label.text,color:E.label.color,angle:E.label.angle,backgroundColor:E.label.backgroundColor,borderLineColor:E.label.borderLineColor,borderLineSize:E.label.borderLineSize,kerning:E.label.kerning,lineHeight:E.label.lineHeight,lineWidth:E.label.lineWidth,rotated:E.label.rotated,haloColor:E.label.haloColor,haloSize:E.label.haloSize,xoffset:E.label.xoffset,yoffset:E.label.yoffset,verticalAlignment:E.label.verticalAlignment,horizontalAlignment:E.label.horizontalAlignment,font:{size:E.label.size,family:"Josefin Slab",weight:E.label.weight}},n=new L({geometry:b.geometry.extent.center,symbol:v,attributes:f}),(g=I.view.map.findLayerById(I.displayedLayerid))&&g.add(n),I.mapoverlayers.push(["smap-default",E.uuid,n])}}else if("circle"===e.overlaytype.toLowerCase()&&(y=void 0,y=e.symbol?e.symbol:"simple"===e.symboltype?{type:"simple-fill",color:e.fillColor,style:e.style,outline:{color:e.strokeColor,width:e.strokeWeight,style:e.strokestyle}}:{type:"picture-fill",url:e.url,width:e.picwidth,height:e.picheight,outline:{style:e.strokestyle,color:e.strokeColor,width:e.strokeWeight}},e.attributes&&e.center&&e.radius)){var m=e.attributes;m.uuid=e.uuid;var w,g,x=new L({geometry:new R({center:new C({x:e.center.X,y:e.center.Y,z:e.center.Z,spatialReference:I.view.spatialReference}),radius:e.radius,radiusUnit:e.radiusUnit,spatialReference:I.view.spatialReference}),symbol:y,attributes:m});if(A.push(x),I.mapoverlayers.push(["smap-default",e.uuid,x]),(w=I.view.map.findLayerById(I.displayedLayerid))&&w.add(x),e.label.visible)v=null,v=e.label.labelingInfo?e.label.labelingInfo:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},n=new L({geometry:x.geometry.extent.center,symbol:v,attributes:m}),(g=I.view.map.findLayerById(I.displayedLayerid))&&g.add(n),I.mapoverlayers.push(["smap-default",e.uuid,n])}})):"element"===E.type&&(this.mapoverlayers.filter(function(e){return e[1]===E.uuid}).forEach(function(e){var t=I.view.map.findLayerById(I.displayedLayerid);t&&t.remove(e[2])}),this.mapoverlayers=this.mapoverlayers.filter(function(e){return e[1]!==E.uuid}),"marker"===E.overlaytype.toLowerCase()?(i=void 0,i=E.symbol?E.symbol:"2d"===this.view.type?{type:"picture-marker",url:E.icon.image,width:E.icon.size.width,height:E.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:E.icon.size.width,resource:{href:E.icon.image}}]},(r=E.attributes).uuid=E.uuid,o=new L({geometry:new C({x:E.position[0],y:E.position[1],z:void 0===E.position[2]?0:E.position[2],spatialReference:this.view.spatialReference}),symbol:i,attributes:r}),A.push(o),this.mapoverlayers.push(["smap-default",E.uuid,o]),(S=this.view.map.findLayerById(this.displayedLayerid))&&S.add(o),E.label.visible&&(n=null,n=E.label.labelingInfo?E.label.labelingInfo:{type:E.label.type,text:E.label.text,color:E.label.color,angle:E.label.angle,backgroundColor:E.label.backgroundColor,borderLineColor:E.label.borderLineColor,borderLineSize:E.label.borderLineSize,kerning:E.label.kerning,lineHeight:E.label.lineHeight,lineWidth:E.label.lineWidth,rotated:E.label.rotated,haloColor:E.label.haloColor,haloSize:E.label.haloSize,xoffset:E.label.xoffset,yoffset:E.label.yoffset,verticalAlignment:E.label.verticalAlignment,horizontalAlignment:E.label.horizontalAlignment,font:{size:E.label.size,family:"Josefin Slab",weight:E.label.weight}},x=new L({geometry:new C({x:"3d"===this.view.type?E.position[0]+E.label.xoffset:E.position[0],y:"3d"===this.view.type?E.position[1]+E.label.yoffset:E.position[1],z:"3d"===this.view.type?E.position[2]+E.label.zoffset:E.position[2],spatialReference:this.view.spatialReference}),symbol:n,attributes:r}),(w=this.view.map.findLayerById(this.displayedLayerid))&&w.add(x),this.mapoverlayers.push(["smap-default",E.uuid,x]))):"polyline"===E.overlaytype.toLowerCase()?(l=null,l=E.symbol?E.symbol:{type:"simple-line",color:E.strokeColor,style:E.style,width:E.width,cap:E.cap,join:E.lineJoin},a=[],E.path.forEach(function(e){a.push([e.X,e.Y,e.Z])}),s=new k({hasZ:!1,hasM:!1,paths:a,spatialReference:this.view.spatialReference}),(c=E.attributes).uuid=E.uuid,u=new L({geometry:s,symbol:l,attributes:c}),A.push(u),this.mapoverlayers.push(["smap-default",E.uuid,u]),(w=this.view.map.findLayerById(this.displayedLayerid))&&w.add(u),E.label.visible&&(h=null,h=E.label.labelingInfo?E.label.labelingInfo:{type:E.label.type,text:E.label.text,color:E.label.color,angle:E.label.angle,backgroundColor:E.label.backgroundColor,borderLineColor:E.label.borderLineColor,borderLineSize:E.label.borderLineSize,kerning:E.label.kerning,lineHeight:E.label.lineHeight,lineWidth:E.label.lineWidth,rotated:E.label.rotated,haloColor:E.label.haloColor,haloSize:E.label.haloSize,xoffset:E.label.xoffset,yoffset:E.label.yoffset,verticalAlignment:E.label.verticalAlignment,horizontalAlignment:E.label.horizontalAlignment,font:{size:E.label.size,family:"Josefin Slab",weight:E.label.weight}},x=new L({geometry:u.geometry.extent.center,symbol:h,attributes:c}),(S=this.view.map.findLayerById(this.displayedLayerid))&&S.add(x),this.mapoverlayers.push(["smap-default",E.uuid,x]))):"polygon"===E.overlaytype.toLowerCase()?(b=void 0,b=E.symbol?E.symbol:"simple"===E.symboltype?{type:"simple-fill",color:E.fillColor,style:E.style,outline:{color:E.strokeColor,width:E.strokeWeight,style:E.strokestyle}}:{type:"picture-fill",url:E.url,width:E.picwidth,height:E.picheight,outline:{style:E.strokestyle,color:E.strokeColor,width:E.strokeWeight}},d=[],E.paths.forEach(function(e){d.push([e.X,e.Y,e.Z])}),y=new z({hasZ:!0,hasM:!0,rings:d,spatialReference:this.view.spatialReference}),(p=E.attributes).uuid=E.uuid,f=new L({geometry:y,symbol:b,attributes:p}),A.push(f),this.mapoverlayers.push(["smap-default",E.uuid,f]),(S=this.view.map.findLayerById(this.displayedLayerid))&&S.add(f),E.label.visible&&(h=null,h=E.label.labelingInfo?E.label.labelingInfo:{type:E.label.type,text:E.label.text,color:E.label.color,angle:E.label.angle,backgroundColor:E.label.backgroundColor,borderLineColor:E.label.borderLineColor,borderLineSize:E.label.borderLineSize,kerning:E.label.kerning,lineHeight:E.label.lineHeight,lineWidth:E.label.lineWidth,rotated:E.label.rotated,haloColor:E.label.haloColor,haloSize:E.label.haloSize,xoffset:E.label.xoffset,yoffset:E.label.yoffset,verticalAlignment:E.label.verticalAlignment,horizontalAlignment:E.label.horizontalAlignment,font:{size:E.label.size,family:"Josefin Slab",weight:E.label.weight}},x=new L({geometry:f.geometry.extent.center,symbol:h,attributes:p}),(w=this.view.map.findLayerById(this.displayedLayerid))&&w.add(x),this.mapoverlayers.push(["smap-default",E.uuid,x]))):"circle"===E.overlaytype.toLowerCase()&&(b=void 0,b=E.symbol?E.symbol:"simple"===E.symboltype?{type:"simple-fill",color:E.fillColor,style:E.style,outline:{color:E.strokeColor,width:E.strokeWeight,style:E.strokestyle}}:{type:"picture-fill",url:E.url,width:E.picwidth,height:E.picheight,outline:{style:E.strokestyle,color:E.strokeColor,width:E.strokeWeight}},E.attributes&&E.center&&E.radius&&((v=E.attributes).uuid=E.uuid,m=new L({geometry:new R({center:new C({x:E.center.X,y:E.center.Y,z:E.center.Z,spatialReference:this.view.spatialReference}),radius:E.radius,radiusUnit:E.radiusUnit,spatialReference:this.view.spatialReference}),symbol:b,attributes:v}),A.push(m),this.mapoverlayers.push(["smap-default",E.uuid,m]),(w=this.view.map.findLayerById(this.displayedLayerid))&&w.add(m),E.label.visible&&(g=null,g=E.label.labelingInfo?E.label.labelingInfo:{type:E.label.type,text:E.label.text,color:E.label.color,angle:E.label.angle,backgroundColor:E.label.backgroundColor,borderLineColor:E.label.borderLineColor,borderLineSize:E.label.borderLineSize,kerning:E.label.kerning,lineHeight:E.label.lineHeight,lineWidth:E.label.lineWidth,rotated:E.label.rotated,haloColor:E.label.haloColor,haloSize:E.label.haloSize,xoffset:E.label.xoffset,yoffset:E.label.yoffset,verticalAlignment:E.label.verticalAlignment,horizontalAlignment:E.label.horizontalAlignment,font:{size:E.label.size,family:"Josefin Slab",weight:E.label.weight}},x=new L({geometry:m.geometry.extent.center,symbol:g,attributes:v}),(S=this.view.map.findLayerById(this.displayedLayerid))&&S.add(x),this.mapoverlayers.push(["smap-default",E.uuid,x]))))),[2,new _.Promise(function(e,t){e(A)})]}})})},ot.prototype.removeAll=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.removeAll(),this.mapoverlayers=[])},ot.prototype.delete=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(this.view.map.remove(e),this.mapoverlayers=[])},ot.prototype.show=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!0)},ot.prototype.hide=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!1)},ot.prototype.init=function(i){return tt(this,void 0,void 0,function(){var t=this;return it(this,function(e){return this.displayedLayerid=(new x).uuid,this.view=i,this.view.on(S.click,function(r){t.view.hitTest(r).then(function(i){return tt(t,void 0,void 0,function(){var t;return it(this,function(e){if(0<i.results.length){if(!i.results[0].graphic.layer)return[2];if(!(t=i.results[0].graphic.layer.id))return[2];t===this.displayedLayerid&&this.emit(S.click,i,r.mapPoint)}return[2]})})})}),this.view.on(S.pointermove,function(r){t.view.hitTest(r).then(function(i){return tt(t,void 0,void 0,function(){var t;return it(this,function(e){if(0<i.results.length){if(!i.results[0].graphic.layer)return[2];if(!(t=i.results[0].graphic.layer.id))return[2];t===this.displayedLayerid&&this.emit(S.pointermove,i,this.view.toMap({x:r.x,y:r.y}))}return[2]})})})}),[2]})})},ot);function ot(e){var t=Ke.call(this)||this;return t.displayedLayerid="",t.view=null,t.mapoverlayers=[],t.init(e),t}var nt,lt,at=(nt=function(e,t){return(nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}nt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),st=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},ct=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},ut=(at(dt,lt=e),dt.prototype.add=function(r){var o=this;P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/734A3D86-CF65-FC97-E8B7B8A0197A043B"]).then(function(e){var t=e[0],i={container:document.getElementById(r.container),radius:r.radius||30,maxOpacity:r.maxOpacity||.8,minOpacity:r.minOpacity||0,blur:r.blur||.7,gradient:r.gradient||{0:"rgb(0,0,0)",.3:"rgb(0,0,255)",.8:"rgb(0,255,0)",.98:"rgb(255,255,0)",1:"rgb(255,0,0)"}};o.heatmaplayer=new t(o.view,i,r.datas,r.h337,r.id),o.heatmaplayer.addData()})},dt.prototype.remove=function(e){var t=document.getElementsByClassName("esri-view-surface")[0],i=document.getElementById(e);null!=i&&t.removeChild(i)},dt.prototype.refreshdata=function(e){this.heatmaplayer.setVisible(!0),this.heatmaplayer.freshenLayerData(e)},dt.prototype.show=function(){this.heatmaplayer.setVisible(!0)},dt.prototype.hide=function(){this.heatmaplayer.setVisible(!1)},dt.prototype.init=function(t){return st(this,void 0,void 0,function(){return ct(this,function(e){return this.displayedLayerid=(new x).uuid,this.view=t,[2]})})},dt);function dt(e){var t=lt.call(this)||this;return t.displayedLayerid="",t.view=null,t.heatmaplayer=null,t.init(e),t}var yt=(pt.shqxboundary="qx_boundary",pt.shjdboundary="jd_boundary",pt.shjwhboundary="jwh_boundary",pt);function pt(){}var ft,ht,bt=(ft=function(e,t){return(ft=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ft(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),vt=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},mt=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},wt=(bt(gt,ht=e),gt.prototype.add=function(p){var f=this;P(["esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/Polygon","esri/geometry/geometryEngineAsync","esri/geometry/SpatialReference","esri/Color"]).then(function(e){var c=e[0],t=e[1],i=e[2],u=e[3],d=(e[4],e[5]),r=null;"qx_boundary"!==p.boundaryType&&"jd_boundary"!==p.boundaryType&&"jwh_boundary"!==p.boundaryType||(r=f.view.map.findLayerById(p.boundaryType));var y=f.view.map.findLayerById(f.displayedLayerid);if(null==y&&(y=new t({id:f.displayedLayerid,title:p.boundaryType+"遮罩层",listMode:"hide"}),f.view.map.add(y)),y.removeAll(),p.inputgeometry){if(null===(r=f.view.map.findLayerById("qx_boundary")))return;var o=new i({rings:p.inputgeometry,spatialReference:f.view.spatialReference}),n=r.fullExtent;n.spatialReference=f.view.spatialReference;var s=o;s.spatialReference=f.view.spatialReference,u.buffer(s,p.boundarydistance,"meters").then(function(e){u.difference(n,e).then(function(e){var t;t="3d"===f.view.type?p.symbol?{type:"polygon-3d",symbolLayers:[{type:"extrude",material:{color:p.maskColor},size:p.symbol.size,edges:{type:"solid",color:p.maskColor}}]}:{type:"polygon-3d",symbolLayers:[{type:"fill",material:{color:p.maskColor},outline:{color:"white",size:"0px"}}]}:{type:"simple-fill",color:p.maskColor,style:"solid",outline:{color:p.maskColor,width:1}};var i=new c({geometry:e,symbol:t});y.add(i);for(var o=void 0===p.bounarycount?30:p.bounarycount,n=Math.ceil(p.boundarydistance/o),l=new d(p.boundaryColor).toRgba(),r=function(r){u.buffer(s,r*o,"meters").then(function(t){u.buffer(s,(r-1)*o,"meters").then(function(e){u.difference(t,e).then(function(e){var t;l[3]=1/n*r,t="3d"===f.view.type?p.symbol?{type:"polygon-3d",symbolLayers:[{type:"extrude",material:{color:l},size:p.symbol.size,edges:{type:"solid",color:l}}]}:{type:"polygon-3d",symbolLayers:[{type:"fill",material:{color:l},outline:{color:"white",size:"0px"}}]}:{type:"simple-fill",color:l,style:"solid",outline:{color:l,width:1}};var i=new c({geometry:e,symbol:t});y.add(i)})})})},a=1;a<=n;a++)r(a)})})}else{if(null===r)return;var l=r.createQuery();l.where=p.boundaryDefinition,r.queryFeatures(l).then(function(e){if(e.features.length){var t=r.fullExtent;t.spatialReference=f.view.spatialReference;var s=e.features[0].geometry;s.spatialReference=f.view.spatialReference,u.buffer(s,p.boundarydistance,"meters").then(function(e){u.difference(t,e).then(function(e){var t;t="3d"===f.view.type?p.symbol?{type:"polygon-3d",symbolLayers:[{type:"extrude",material:{color:p.maskColor},size:p.symbol.size,edges:{type:"solid",color:p.maskColor}}]}:{type:"polygon-3d",symbolLayers:[{type:"fill",material:{color:p.maskColor},outline:{color:"white",size:"0px"}}]}:{type:"simple-fill",color:p.maskColor,style:"solid",outline:{color:p.maskColor,width:1}};var i=new c({geometry:e,symbol:t});y.add(i);for(var o=void 0===p.bounarycount?30:p.bounarycount,n=Math.ceil(p.boundarydistance/o),l=new d(p.boundaryColor).toRgba(),r=function(r){u.buffer(s,r*o,"meters").then(function(t){u.buffer(s,(r-1)*o,"meters").then(function(e){u.difference(t,e).then(function(e){var t;l[3]=1/n*r,t="3d"===f.view.type?p.symbol?{type:"polygon-3d",symbolLayers:[{type:"extrude",material:{color:l},size:p.symbol.size,edges:{type:"solid",color:l}}]}:{type:"polygon-3d",symbolLayers:[{type:"fill",material:{color:l},outline:{color:"white",size:"0px"}}]}:{type:"simple-fill",color:l,style:"solid",outline:{color:l,width:1}};var i=new c({geometry:e,symbol:t});y.add(i)})})})},a=1;a<=n;a++)r(a)})})}})}})},gt.prototype.remove=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&this.view.map.remove(e)},gt.prototype.show=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!0)},gt.prototype.hide=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!1)},gt.prototype.init=function(t){return vt(this,void 0,void 0,function(){return mt(this,function(e){return this.displayedLayerid=(new x).uuid,this.view=t,[2]})})},gt);function gt(e){var t=ht.call(this)||this;return t.displayedLayerid="",t.view=null,t.init(e),t}var xt,Lt,Ct=(xt=function(e,t){return(xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}xt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),kt=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},zt=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Rt=(Ct(At,Lt=e),At.prototype.circle=function(){var g=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/Point","esri/geometry/geometryEngine"]).then(function(e){var t=e[0],h=e[1],i=e[2],b=e[3],v=e[4];g.drawtool=new t({view:g.view}),g.drawtool.reset();var m=g.view.map.findLayerById(g.displayedLayerid);null==m&&(m=new i({id:g.displayedLayerid,title:"测量结果显示层",listMode:"hide"}),g.view.map.add(m));var r=(new x).uuid,w=g.view.map.findLayerById(r);w||(w=new i({id:g.displayedLayerid,title:"测量圆实时追踪显示层",listMode:"hide"}),g.view.map.add(w));var o=g.drawtool.create("circle",{mode:"click"});g.view.focus(),o.on("vertex-add",function(e){if(2===e.vertices.length){w.removeAll();var t=new b({x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:g.view.spatialReference}),i=new b({x:e.vertices[1][0],y:e.vertices[1][1],spatialReference:g.view.spatialReference}),r=new h({geometry:{type:"polyline",paths:[[e.vertices[0],e.vertices[1]]],spatialReference:g.view.spatialReference},symbol:g.polylinesymbol}),o=v.geodesicLength(r.geometry,"meters"),n=v.buffer(t,o,"meters"),l=v.geodesicArea(n,"square-meters"),a=new h({geometry:n,symbol:g.polygonsymbol}),s=g.textsymbol,c=1e3<o?"半径:"+(o/1e3).toFixed(3)+"千米":"半径:"+parseFloat(o).toFixed(3)+"米";s.text=c;var u=new h({geometry:i,symbol:s}),d=g.textsymbol,y=1e5<l?"面积:"+(l/1e6).toFixed(3)+"平千方米":"面积:"+parseFloat(l).toFixed(3)+"平方米";d.text=y;var p=new h({geometry:t,symbol:d});w.add(a),w.add(r),w.add(u),w.add(p)}}),o.on("vertex-remove",function(e){console.log(e)}),o.on("cursor-update",function(e){if(2===e.vertices.length){w.removeAll();var t=new b({x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:g.view.spatialReference}),i=new b({x:e.vertices[1][0],y:e.vertices[1][1],spatialReference:g.view.spatialReference}),r=new h({geometry:{type:"polyline",paths:[[e.vertices[0],e.vertices[1]]],spatialReference:g.view.spatialReference},symbol:g.polylinesymbol}),o=v.geodesicLength(r.geometry,"meters"),n=v.buffer(t,o,"meters"),l=v.geodesicArea(n,"square-meters"),a=new h({geometry:n,symbol:g.polygonsymbol}),s=g.textsymbol,c=1e3<o?"半径:"+(o/1e3).toFixed(3)+"千米":"半径:"+parseFloat(o).toFixed(3)+"米";s.text=c;var u=new h({geometry:i,symbol:s}),d=g.textsymbol,y=1e5<l?"面积:"+(l/1e6).toFixed(3)+"平千方米":"面积:"+parseFloat(l).toFixed(3)+"平方米";d.text=y;var p=new h({geometry:t,symbol:d});w.add(a),w.add(r),w.add(u),w.add(p)}}),o.on("redo",function(e){console.log(e)}),o.on("undo",function(e){console.log(e)}),o.on("draw-complete",function(e){if(2===e.vertices.length){var t=new b({x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:g.view.spatialReference}),i=new b({x:e.vertices[1][0],y:e.vertices[1][1],spatialReference:g.view.spatialReference}),r=new h({geometry:{type:"polyline",paths:[[e.vertices[0],e.vertices[1]]],spatialReference:g.view.spatialReference},symbol:g.polylinesymbol}),o=v.geodesicLength(r.geometry,"meters"),n=v.buffer(t,o,"meters"),l=v.geodesicArea(n,"square-meters"),a=new h({geometry:n,symbol:g.polygonsymbol}),s=g.textsymbol,c=1e3<o?"半径:"+(o/1e3).toFixed(3)+"千米":"半径:"+parseFloat(o).toFixed(3)+"米";s.text=c;var u=new h({geometry:i,symbol:s}),d=g.textsymbol,y=1e5<l?"面积:"+(l/1e6).toFixed(3)+"平千方米":"面积:"+parseFloat(l).toFixed(3)+"平方米";d.text=y;var p=new h({geometry:t,symbol:d});g.view.map.remove(w),m.add(a),m.add(r),m.add(u),m.add(p);var f={radiusdistance:o,circlearea:l};g.emit("measurementcomplete",a,f,"circle")}})})},At.prototype.rectangle=function(){var B=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/Point","esri/geometry/Polygon","esri/geometry/geometryEngine"]).then(function(e){var t=e[0],R=e[1],i=e[2],A=e[3],S=e[4],I=e[5];B.drawtool=new t({view:B.view}),B.drawtool.reset();var E=B.view.map.findLayerById(B.displayedLayerid);E||(E=new i({id:B.displayedLayerid,title:"测量结果显示层",listMode:"hide"}),B.view.map.add(E));var r=(new x).uuid,F=B.view.map.findLayerById(r);null==F&&(F=new i({id:B.displayedLayerid,title:"测量矩形实时追踪显示层",listMode:"hide"}),B.view.map.add(F));var o=B.drawtool.create("rectangle",{mode:"click"});B.view.focus(),o.on("vertex-add",function(e){if(2===e.vertices.length){F.removeAll();var t=e.vertices[0][0]>e.vertices[1][0]?e.vertices[1][0]:e.vertices[0][0],i=e.vertices[0][1]>e.vertices[1][1]?e.vertices[1][1]:e.vertices[0][1],r=e.vertices[0][0]>e.vertices[1][0]?e.vertices[0][0]:e.vertices[1][0],o=e.vertices[0][1]>e.vertices[1][1]?e.vertices[0][1]:e.vertices[1][1],n=new S({hasZ:!0,hasM:!0,rings:[[[t,i],[r,i],[r,o],[t,o],[t,i]]],spatialReference:B.view.spatialReference}),l=new R({geometry:n,symbol:B.polygonsymbol}),a=new A({x:t+(r-t)/2,y:i,spatialReference:B.view.spatialReference}),s=new A({x:t,y:i,spatialReference:B.view.spatialReference}),c=new A({x:r,y:t,spatialReference:B.view.spatialReference}),u=I.distance(s,c,"meters"),d=B.textsymbol,y=1e3<u?"长度:"+(u/1e3).toFixed(3)+"千米":"长度:"+u.toFixed(3)+"米";d.text=y;var p=new R({geometry:a,symbol:d}),f=new A({x:r,y:i+(o-i)/2,spatialReference:B.view.spatialReference}),h=new A({x:r,y:i,spatialReference:B.view.spatialReference}),b=new A({x:r,y:o,spatialReference:B.view.spatialReference}),v=I.distance(h,b,"meters"),m=B.textsymbol,w=1e3<v?"宽度:"+(v/1e3).toFixed(3)+"千米":"宽度:"+v.toFixed(3)+"米";m.text=w;var g=new R({geometry:f,symbol:m}),x=new A({x:t+(r-t)/2,y:i+(o-i)/2,spatialReference:B.view.spatialReference}),L=B.textsymbol,C=u*v,k=1e5<C?"面积:"+(C/1e6).toFixed(3)+"平方千米":"面积:"+C.toFixed(3)+"平方米";L.text=k;var z=new R({geometry:x,symbol:L});F.add(p),F.add(g),F.add(z),F.add(l)}}),o.on("vertex-remove",function(e){console.log(e)}),o.on("cursor-update",function(e){if(2===e.vertices.length){F.removeAll();var t=e.vertices[0][0]>e.vertices[1][0]?e.vertices[1][0]:e.vertices[0][0],i=e.vertices[0][1]>e.vertices[1][1]?e.vertices[1][1]:e.vertices[0][1],r=e.vertices[0][0]>e.vertices[1][0]?e.vertices[0][0]:e.vertices[1][0],o=e.vertices[0][1]>e.vertices[1][1]?e.vertices[0][1]:e.vertices[1][1],n=new S({hasZ:!0,hasM:!0,rings:[[[t,i],[r,i],[r,o],[t,o],[t,i]]],spatialReference:B.view.spatialReference}),l=new R({geometry:n,symbol:B.polygonsymbol}),a=new A({x:t+(r-t)/2,y:i,spatialReference:B.view.spatialReference}),s=new A({x:t,y:i,spatialReference:B.view.spatialReference}),c=new A({x:r,y:i,spatialReference:B.view.spatialReference}),u=I.distance(s,c,"meters"),d=B.textsymbol,y=1e3<u?"长度:"+(u/1e3).toFixed(3)+"千米":"长度:"+u.toFixed(3)+"米";d.text=y;var p=new R({geometry:a,symbol:d}),f=new A({x:r,y:i+(o-i)/2,spatialReference:B.view.spatialReference}),h=new A({x:r,y:i,spatialReference:B.view.spatialReference}),b=new A({x:r,y:o,spatialReference:B.view.spatialReference}),v=I.distance(h,b,"meters"),m=B.textsymbol,w=1e3<v?"宽度:"+(v/1e3).toFixed(3)+"千米":"宽度:"+v.toFixed(3)+"米";m.text=w;var g=new R({geometry:f,symbol:m}),x=new A({x:t+(r-t)/2,y:i+(o-i)/2,spatialReference:B.view.spatialReference}),L=B.textsymbol,C=u*v,k=1e5<C?"面积:"+(C/1e6).toFixed(3)+"平方千米":"面积:"+C.toFixed(3)+"平方米";L.text=k;var z=new R({geometry:x,symbol:L});F.add(p),F.add(g),F.add(z),F.add(l)}}),o.on("redo",function(e){console.log(e)}),o.on("undo",function(e){console.log(e)}),o.on("draw-complete",function(e){if(2===e.vertices.length){var t=e.vertices[0][0]>e.vertices[1][0]?e.vertices[1][0]:e.vertices[0][0],i=e.vertices[0][1]>e.vertices[1][1]?e.vertices[1][1]:e.vertices[0][1],r=e.vertices[0][0]>e.vertices[1][0]?e.vertices[0][0]:e.vertices[1][0],o=e.vertices[0][1]>e.vertices[1][1]?e.vertices[0][1]:e.vertices[1][1],n=new S({hasZ:!0,hasM:!0,rings:[[[t,i],[r,i],[r,o],[t,o],[t,i]]],spatialReference:B.view.spatialReference}),l=new R({geometry:n,symbol:B.polygonsymbol}),a=new A({x:t+(r-t)/2,y:i,spatialReference:B.view.spatialReference}),s=new A({x:t,y:i,spatialReference:B.view.spatialReference}),c=new A({x:r,y:i,spatialReference:B.view.spatialReference}),u=I.distance(s,c,"meters"),d=B.textsymbol,y=1e3<u?"长度:"+(u/1e3).toFixed(3)+"千米":"长度:"+u.toFixed(3)+"米";d.text=y;var p=new R({geometry:a,symbol:d}),f=new A({x:r,y:i+(o-i)/2,spatialReference:B.view.spatialReference}),h=new A({x:r,y:i,spatialReference:B.view.spatialReference}),b=new A({x:r,y:o,spatialReference:B.view.spatialReference}),v=I.distance(h,b,"meters"),m=B.textsymbol,w=1e3<v?"宽度:"+(v/1e3).toFixed(3)+"千米":"宽度:"+v.toFixed(3)+"米";m.text=w;var g=new R({geometry:f,symbol:m}),x=new A({x:t+(r-t)/2,y:i+(o-i)/2,spatialReference:B.view.spatialReference}),L=B.textsymbol,C=u*v,k=1e5<C?"面积:"+(C/1e6).toFixed(3)+"平方千米":"面积:"+C.toFixed(3)+"平方米";L.text=k;var z=new R({geometry:x,symbol:L});B.view.map.remove(F),E.add(p),E.add(g),E.add(z),E.add(l),B.emit("measurementcomplete",l,{length:u,width:v,area:v*u},"rectangle")}})})},At.prototype.Point=function(){var c=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer"]).then(function(e){var t=e[0],l=e[1],i=e[2];c.drawtool=new t({view:c.view}),c.drawtool.reset();var a=c.view.map.findLayerById(c.displayedLayerid);a||(a=new i({id:c.displayedLayerid,title:"测量结果显示层",listMode:"hide"}),c.view.map.add(a));var r=(new x).uuid,s=c.view.map.findLayerById(r);null==s&&(s=new i({id:c.displayedLayerid,title:"测量点移动实时追踪显示层",listMode:"hide"}),c.view.map.add(s));var o=c.drawtool.create("point",{mode:"click"});c.view.focus(),o.on("vertex-add",function(e){console.log(e)}),o.on("vertex-remove",function(e){console.log(e)}),o.on("cursor-update",function(e){s.removeAll();var t={type:"point",x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:c.view.spatialReference},i=new l({geometry:t,symbol:c.marksymbol});s.add(i);var r=c.textsymbol;r.text="("+parseFloat(e.vertices[0][0]).toFixed(3)+","+parseFloat(e.vertices[0][1]).toFixed(3)+")";var o=new l({geometry:t,symbol:r});s.add(o)}),o.on("redo",function(e){console.log(e)}),o.on("undo",function(e){console.log(e)}),o.on("draw-complete",function(e){var t={type:"point",x:e.vertices[0][0],y:e.vertices[0][1],spatialReference:c.view.spatialReference},i=new l({geometry:t,symbol:c.marksymbol}),r=c.textsymbol;r.text="("+parseFloat(e.vertices[0][0]).toFixed(3)+","+parseFloat(e.vertices[0][1]).toFixed(3)+")";var o=new l({geometry:t,symbol:r});c.view.map.remove(s),a.add(o),a.add(i);var n="("+parseFloat(e.vertices[0][0]).toFixed(3)+","+parseFloat(e.vertices[0][0]).toFixed(3)+")";c.emit("measurementcomplete",i,n,"point")})})},At.prototype.Multipoint=function(){var d=this;P(["esri/views/draw/Draw","esri/views/draw/PointDrawAction","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/Polygon","esri/geometry/geometryEngine"]).then(function(e){var t=e[0],a=(e[1],e[2]),i=e[3];e[4],e[5],d.drawtool=new t({view:d.view}),d.drawtool.reset();var s=d.view.map.findLayerById(d.displayedLayerid);s||(s=new i({id:d.displayedLayerid,title:"测量结果显示层",listMode:"hide"}),d.view.map.add(s));var r=(new x).uuid,c=d.view.map.findLayerById(r);null==c&&(c=new i({id:d.displayedLayerid,title:"测量多点临时显示层",listMode:"hide"}),d.view.map.add(c));var o=(new x).uuid,u=d.view.map.findLayerById(o);null==u&&(u=new i({id:d.displayedLayerid,title:"测量多点移动追踪显示层",listMode:"hide"}),d.view.map.add(u));var n=d.drawtool.create("multipoint",{mode:"click"});d.view.focus(),n.on("vertex-add",function(e){c.removeAll(),e.vertices.map(function(e){var t={type:"point",x:e[0],y:e[1],spatialReference:d.view.spatialReference},i=new a({geometry:t,symbol:d.marksymbol}),r=d.textsymbol;r.text="("+parseFloat(e[0]).toFixed(3)+","+parseFloat(e[1]).toFixed(3)+")";var o=new a({geometry:t,symbol:r});c.add(o),c.add(i)})}),n.on("vertex-remove",function(e){console.log(e)}),n.on("cursor-update",function(e){u.removeAll(),e.vertices.map(function(e){var t={type:"point",x:e[0],y:e[1],spatialReference:d.view.spatialReference},i=new a({geometry:t,symbol:d.marksymbol}),r=d.textsymbol;r.text="("+parseFloat(e[0]).toFixed(3)+","+parseFloat(e[1]).toFixed(3)+")";var o=new a({geometry:t,symbol:r});u.add(o),u.add(i)})}),n.on("redo",function(e){console.log(e)}),n.on("undo",function(e){console.log(e)}),n.on("draw-complete",function(e){d.view.map.remove(c),d.view.map.remove(u);var n=[],l=[];e.vertices.map(function(e){var t={type:"point",x:e[0],y:e[1],spatialReference:d.view.spatialReference},i=new a({geometry:t,symbol:d.marksymbol}),r=d.textsymbol;r.text="("+parseFloat(e[0]).toFixed(3)+","+parseFloat(e[1]).toFixed(3)+")";var o=new a({geometry:t,symbol:r});s.add(i),s.add(o),n.push(i),l.push(e)}),d.emit("measurementcomplete",n,l,"multipoint")})})},At.prototype.drawPolyline=function(){var b=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/geometryEngine"]).then(function(e){var t=e[0],y=e[1],i=e[2],p=e[3];b.drawtool=new t({view:b.view}),b.drawtool.reset();var f=b.view.map.findLayerById(b.displayedLayerid);f||(f=new i({id:b.displayedLayerid,title:"测量结果显示层",listMode:"hide"}),b.view.map.add(f));var r=(new x).uuid,h=b.view.map.findLayerById(r);null==h&&(h=new i({id:b.displayedLayerid,title:"测量多边线实时追踪显示层",listMode:"hide"}),b.view.map.add(h));var o=b.drawtool.create("polyline");b.view.focus(),o.on(["vertex-add","vertex-remove","cursor-update","redo","undo"],function(e){if(1<e.vertices.length){var t=e.vertices;h.removeAll();var i=new y({geometry:{type:"polyline",paths:t,spatialReference:b.view.spatialReference},symbol:b.polylinesymbol}),r=function(e){var t=e.clone(),i=t.removePoint(0,t.paths[0].length-1),r=t.getPoint(0,t.paths[0].length-1);return{type:"polyline",spatialReference:b.view.spatialReference,hasZ:!1,paths:[[[r.x,r.y],[i.x,i.y]]]}};if(function(e){if(!(e.paths[0].length<3)){var t=e.clone(),i=r(e);return t.removePoint(0,t.paths[0].length-1),p.crosses(i,t)}}(i.geometry)){var o=new y({geometry:r(i.geometry),symbol:b.polylinesymbol});o&&h.addMany([i,o]),o&&e.preventDefault()}else h.add(i);var n=b.textsymbol,l=p.geodesicLength(i.geometry,"meters"),a=1e3<l?"长度:"+(l/1e3).toFixed(3)+"千米":"长度:"+l.toFixed(3)+"米";n.text=a;var s=i.geometry.clone(),c=s.removePoint(0,s.paths[0].length-1),u=new y({geometry:c,symbol:n});h.add(u)}}),o.on("draw-complete",function(e){if(1<e.vertices.length){var t=e.vertices;h.removeAll();var i=new y({geometry:{type:"polyline",paths:t,spatialReference:b.view.spatialReference},symbol:b.polylinesymbol}),r=function(e){var t=e.clone(),i=t.removePoint(0,t.paths[0].length-1),r=t.getPoint(0,t.paths[0].length-1);return{type:"polyline",spatialReference:b.view.spatialReference,hasZ:!1,paths:[[[r.x,r.y],[i.x,i.y]]]}},o=null;if(function(e){if(!(e.paths[0].length<3)){var t=e.clone(),i=r(e);return t.removePoint(0,t.paths[0].length-1),p.crosses(i,t)}}(i.geometry)){var n=new y({geometry:r(i.geometry),symbol:b.polylinesymbol});n&&(f.addMany([i,n]),o=new y({geometry:p.union(i.geometry,n.geometry),symbol:b.polylinesymbol})),n&&e.preventDefault()}else o=i,f.add(i);var l=b.textsymbol,a=p.geodesicLength(i.geometry,"meters"),s=1e3<a?"长度:"+(a/1e3).toFixed(3)+"千米":"长度:"+a.toFixed(3)+"米";l.text=s;var c=i.geometry.clone(),u=c.removePoint(0,c.paths[0].length-1),d=new y({geometry:u,symbol:l});f.add(d),b.view.map.remove(h),b.emit("measurementcomplete",o,{distance:a},"polyline")}})})},At.prototype.drawPolygon=function(){var y=this;P(["esri/views/draw/Draw","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/geometryEngine"]).then(function(e){var t=e[0],s=e[1],i=e[2],c=e[3];y.drawtool=new t({view:y.view}),y.drawtool.reset();var u=y.view.map.findLayerById(y.displayedLayerid);u||(u=new i({id:y.displayedLayerid,title:"测量结果显示层",listMode:"hide"}),y.view.map.add(u));var r=(new x).uuid,d=y.view.map.findLayerById(r);null==d&&(d=new i({id:y.displayedLayerid,title:"测量多边形实时追踪显示层",listMode:"hide"}),y.view.map.add(d));var o=y.drawtool.create("polygon");y.view.focus(),o.on(["vertex-add","vertex-remove","cursor-update","redo","undo"],function(e){var t=e.vertices;d.removeAll();var i={type:"polygon",rings:t,spatialReference:y.view.spatialReference},r=new s({geometry:i,symbol:y.polygonsymbol});if(3<e.vertices.length){var o=c.geodesicArea(r.geometry,"square-meters"),n=y.textsymbol,l=1e5<Math.abs(o)?"面积:"+(Math.abs(o)/1e6).toFixed(3)+"平方千米":"面积:"+Math.abs(o).toFixed(3)+"平方米";n.text=l;var a=new s({geometry:r.geometry.extent.center,symbol:n});d.add(a)}d.add(r)}),o.on("draw-complete",function(e){var t=e.vertices;d.removeAll();var i={type:"polygon",rings:t,spatialReference:y.view.spatialReference},r=new s({geometry:i,symbol:y.polygonsymbol}),o=c.geodesicArea(r.geometry,"square-meters"),n=y.textsymbol,l=1e5<Math.abs(o)?"面积:"+(Math.abs(o)/1e6).toFixed(3)+"平方千米":"面积:"+Math.abs(o).toFixed(3)+"平方米";n.text=l;var a=new s({geometry:r.geometry.extent.center,symbol:n});y.view.map.remove(d),u.add(a),u.add(r),y.emit("measurementcomplete",r,{area:o},"polygon")})})},At.prototype.reset=function(){this.drawtool&&this.drawtool.reset()},At.prototype.clean=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&this.view.map.remove(e)},At.prototype.show=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!0)},At.prototype.hide=function(){var e=this.view.map.findLayerById(this.displayedLayerid);e&&(e.visible=!1)},At.prototype.init=function(i){return kt(this,void 0,void 0,function(){var t=this;return zt(this,function(e){return this.displayedLayerid=(new x).uuid,this.view=i,"2d"===this.view.type?(this.polygonsymbol={type:"simple-fill",color:[255,255,255,.6],style:"solid",outline:{color:[255,255,0,.8],width:2}},this.polylinesymbol={type:"simple-line",color:[255,255,255,.6],width:"4px",style:"solid"},this.marksymbol={type:"simple-marker",style:"circle",color:[255,255,0,.6],size:"24px",outline:{color:[255,255,0,.8],width:2}}):(this.polygonsymbol={type:"polygon-3d",symbolLayers:[{type:"extrude",castShadows:!1,size:10,material:{color:[255,255,255,.4]},edges:{type:"solid",color:[50,50,50,.5]}}]},this.polylinesymbol={type:"line-3d",symbolLayers:[{type:"path",anchor:"center",Values:"center",profile:"quad",width:2,height:10,material:{color:[255,255,255,.4]},cap:"square",join:"miter",castShadows:!1,profileRotation:"heading"}]},this.marksymbol={type:"point-3d",symbolLayers:[{type:"object",width:20,height:20,depth:20,resource:{primitive:"sphere"},material:{color:[0,0,255,.8]}}],verticalOffset:{screenLength:60,maxWorldLength:1e3,minWorldLength:20},callout:{type:"line",size:1.5,color:"white",border:{color:"black"}}}),this.textsymbol={type:"text",color:"white",angle:0,text:"",xoffset:60,yoffset:10,horizontalAlignment:"right",verticalAlignment:"bottom",font:{size:12,family:"Josefin Slab",weight:"bold"}},this.view.on(S.click,function(e){t.view.hitTest(e).then(function(e){return kt(t,void 0,void 0,function(){return zt(this,function(e){return[2]})})})}),this.view.on(S.pointermove,function(e){t.view.hitTest(e).then(function(e){return kt(t,void 0,void 0,function(){return zt(this,function(e){return[2]})})})}),[2]})})},At);function At(e){var t=Lt.call(this)||this;return t.marksymbol=null,t.polylinesymbol=null,t.polygonsymbol=null,t.textsymbol=null,t.displayedLayerid="",t.view=null,t.drawtool=null,t.drawlayerscollection=[],t.init(e),t}var St,It,Et=(St=function(e,t){return(St=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}St(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ft=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},Bt=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},_t=(Et(Pt,It=e),Pt.prototype.add=function(o){var n=this;void 0===o&&(o={}),P(["82B44794-5CE0-A64A-9047F07CAF08BD2C/08F60FEF-C6FF-A788-344D-1755CB0E3870/B622344F-BB19-15F1-3920E863621B4D9B","esri/views/3d/externalRenderers"]).then(function(e){var t=e[0],i=e[1];if(o.paths){var r=new t(n.view,o.paths,o.width,o.color,o.opacity,o.dash,o.rest,o.linesegment,o.linesegmentfade);i.add(n.view,r),n.meshLineRendererArray.push([(new x).uuid,r])}}).catch(function(e){console.error(e)})},Pt.prototype.remove=function(){var i=this;P(["esri/views/3d/externalRenderers"]).then(function(e){var t=e[0];i.meshLineRendererArray.map(function(e){t.remove(i.view,e[1])}),i.meshLineRendererArray=[]})},Pt.prototype.init=function(t){return Ft(this,void 0,void 0,function(){return Bt(this,function(e){return this.view=t,[2]})})},Pt);function Pt(e){var t=It.call(this)||this;return t.meshLineRendererArray=[],t.view=null,t.init(e),t}var Mt,Ot,jt=(Mt=function(e,t){return(Mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Mt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Wt=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},Dt=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Tt=(jt(Zt,Ot=e),Zt.prototype.add=function(n){var l=this;void 0===n&&(n={}),P(["esri/layers/599EFB79-18C9-DC0A-E2C9FC2F2316C660"]).then(function(e){var t=e[0],i=[];n.datas.forEach(function(e,t){i.push({name:e[0]+" Top10",type:"lines",coordinateSystem:"arcgis",zlevel:1,effect:{show:!0,period:6,trailLength:.7,color:"#fff",symbolSize:3},lineStyle:{normal:{color:n.color[t],width:0,curveness:.2}},data:l.convertData(e[1],n.geoCoordMap)},{name:e[0]+" Top10",type:"lines",coordinateSystem:"arcgis",zlevel:2,symbol:["none","arrow"],symbolSize:10,effect:{show:!0,period:6,trailLength:0,symbol:n.planePath,symbolSize:15},lineStyle:{normal:{color:n.color[t],width:1,opacity:.6,curveness:.2}},data:l.convertData(e[1],n.geoCoordMap)},{name:e[0]+" Top10",type:"effectScatter",coordinateSystem:"arcgis",zlevel:2,rippleEffect:{brushType:"stroke"},legendHoverLink:!0,hoverAnimation:!0,symbol:n.symbol,label:{normal:{show:!0,position:"right",formatter:"{b}"}},symbolSize:function(e){return e[2]/8},itemStyle:{normal:{color:n.color[t],shadowBlur:10,shadowColor:"#333"}},data:e[1].map(function(e){return{name:e[1].name,value:n.geoCoordMap[e[1].name].concat([e[1].value])}})})});var r=new t(l.view,"",n.id),o={title:{text:"",subtext:"",left:"center",textStyle:{color:"#fff"}},series:i};r.setChartOption(o)})},Zt.prototype.remove=function(e){var t=document.getElementsByClassName("esri-view-surface")[0],i=document.getElementById(e);null!=i&&t.removeChild(i)},Zt.prototype.convertData=function(e,t){for(var i=[],r=0,o=e;r<o.length;r++){var n=o[r],l=t[n[0].name],a=t[n[1].name];l&&a&&i.push({fromName:n[0].name,toName:n[1].name,coords:[l,a],value:n[1].value})}return i},Zt.prototype.getAPIScript=function(e){return document.querySelector("script["+e+"]")},Zt.prototype.loadAPIScript=function(o,n){var l=this;return new _.Promise(function(e,t){var i=l.getAPIScript(o);if(i){var r=i.getAttribute("src");r!==n?t(new Error("The echartgl is already loaded ("+r+").")):l.handleScriptLoad(i,e,t)}else i=l.createScript(o,n),l.handleScriptLoad(i,function(){i.setAttribute(o,"loaded"),e(i)},t),document.head.appendChild(i)})},Zt.prototype.createScript=function(e,t){var i=document.createElement("script");return i.type="text/javascript",i.src=t,i.setAttribute(e,"loading"),i},Zt.prototype.handleScriptLoad=function(e,t,i){var r;i&&(r=this.handleScriptError(e,i));var o=function(){t(e),e.removeEventListener("load",o,!1),r&&e.removeEventListener("error",r,!1)};e.addEventListener("load",o,!1)},Zt.prototype.handleScriptError=function(t,i){var r=function(e){i(e.error||new Error("There was an error attempting to load "+t.src)),t.removeEventListener("error",r,!1)};return t.addEventListener("error",r,!1),r},Zt.prototype.init=function(t){return Wt(this,void 0,void 0,function(){return Dt(this,function(e){return this.view=t,[2]})})},Zt);function Zt(e){var t=Ot.call(this)||this;return t.view=null,t.init(e),t}var Ht,Gt,qt=(Ht=function(e,t){return(Ht=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ht(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Jt=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},Xt=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Yt=(qt(Ut,Gt=e),Ut.prototype.play=function(l){var a=this;void 0===l&&(l={}),P(["geolocate","esri/widgets/Track","esri/geometry/support/webMercatorUtils"]).then(function(e){var i=e[0],t=e[1],r=e[2];if(void 0!==l.coords){var o=0;a.track=new t({view:a.view,goToLocationEnabled:!1});var n=0;i.use(),void 0!==a.routepalybackinternal&&clearInterval(a.routepalybackinternal),a.routepalybackinternal=setInterval(function(){var e=r.xyToLngLat(l.coords[n].x,l.coords[n].y),t={lng:e[0],lat:e[1]};i.change(t),n=(n+1)%l.coords.length,++o===l.coords.length&&clearInterval(a.routepalybackinternal)},2500),a.view.when(function(){var t=a.view.center;a.track.on("track",function(){l.mobilesymbol&&(a.track.graphic.symbol=l.mobilesymbol);var e=a.track.graphic.geometry;1<o&&l.showtrail&&a.createAnimateRoute(e,t,l.trailsymbol),a.view.goTo({center:e,tilt:70,scale:2500,heading:360-a.getHeading(e,t),rotation:360-a.getHeading(e,t)}).catch(function(e){"AbortError"!==e.name&&console.error(e)}),t=e.clone()}),a.track.start()})}}).catch(function(e){console.error(e)})},Ut.prototype.remove=function(){this.routepalybackinternal,clearInterval(this.routepalybackinternal),this.track.destroy();var e=this.view.map.findLayerById(this.displayedLayerid);e&&this.view.map.remove(e)},Ut.prototype.getHeading=function(e,t){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI-90},Ut.prototype.createAnimateRoute=function(n,l,a){var s=this;P(["esri/Graphic","esri/layers/GraphicsLayer"]).then(function(e){var t=e[0],i=e[1],r=new t({geometry:{type:"polyline",paths:[[l.longitude,l.latitude],[n.longitude,n.latitude]]},symbol:void 0!==a?a:{type:"simple-line",color:[156,39,176],width:10}}),o=s.view.map.findLayerById(s.displayedLayerid);void 0===o&&(o=new i({title:"路径轨迹播放",id:s.displayedLayerid,listMode:"hide"}),s.view.map.add(o)),o.add(r)})},Ut.prototype.init=function(t){return Jt(this,void 0,void 0,function(){return Xt(this,function(e){return this.displayedLayerid=(new x).uuid,this.view=t,[2]})})},Ut);function Ut(e){var t=Gt.call(this)||this;return t.displayedLayerid="",t.view=null,t.routepalybackinternal=null,t.track=null,t.init(e),t}var Nt,Vt,$t=(Nt=function(e,t){return(Nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Nt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Qt=function(e,l,a,s){return new(a=a||Promise)(function(i,t){function r(e){try{n(s.next(e))}catch(e){t(e)}}function o(e){try{n(s.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}n((s=s.apply(e,l||[])).next())})},Kt=function(i,r){var o,n,l,e,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(l=2&t[0]?n.return:t[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,t[1])).done)return l;switch(n=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(l=0<(l=a.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){a.label=t[1];break}if(6===t[0]&&a.label<l[1]){a.label=l[1],l=t;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(t);break}l[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(i,a)}catch(e){t=[6,e],n=0}finally{o=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},ei=($t(ti,Vt=e),ti.prototype.play=function(y){var p=this;void 0===y&&(y={}),P(["esri/geometry/Point","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/support/webMercatorUtils"]).then(function(e){var o=e[0],n=e[1],l=e[2];if(e[3],void 0!==y.coords){var a=0,s=0,c=p.view.center;void 0!==p.mapRoamplayinternal&&clearInterval(p.mapRoamplayinternal);var u=void 0!==y.duration?y.duration:2e3,d=void 0!==y.speedFactor?y.speedFactor:1;p.mapRoamplayinternal=setInterval(function(){var e={x:y.coords[s].x,y:y.coords[s].y,z:void 0!==y.coords[s].z?y.coords[s].z:0};s=(s+1)%y.coords.length,++a;var t=new o({x:e.x,y:e.y,z:e.z,spatialReference:p.view.spatialReference}),i=p.view.map.findLayerById(p.mobilelayerid);void 0===i&&(i=new l({title:"漫游路径"+p.mobilelayerid,id:p.mobilelayerid,listMode:"hide"}),p.view.map.add(i)),i.removeAll();var r=new n({geometry:t,symbol:y.mobilesymbol});i.add(r),1<a&&y.showtrail&&p.createAnimateRoute(t,c,y.trailsymbol),p.view.goTo({center:t,tilt:70,scale:2500,heading:360-p.getHeading(t,c),rotation:360-p.getHeading(t,c)},{speedFactor:d,duration:u-.2*u,maxDuration:u-.2*u,easing:"in-out-coast-quadratic"}).then().catch(function(e){"AbortError"!==e.name&&console.error(e)}),c=t.clone(),a===y.coords.length&&clearInterval(p.mapRoamplayinternal)},u)}}).catch(function(e){console.error(e)})},ti.prototype.remove=function(){this.mapRoamplayinternal,clearInterval(this.mapRoamplayinternal);var e=this.view.map.findLayerById(this.displayedLayerid);e&&this.view.map.remove(e);var t=this.view.map.findLayerById(this.mobilelayerid);t&&this.view.map.remove(t)},ti.prototype.getHeading=function(e,t){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI-90},ti.prototype.createAnimateRoute=function(n,l,a){var s=this;P(["esri/Graphic","esri/layers/GraphicsLayer"]).then(function(e){var t=e[0],i=e[1],r=new t({geometry:{type:"polyline",paths:[[l.x,l.y,l.z],[n.x,n.y,n.z]],spatialReference:s.view.spatialReference},symbol:void 0!==a?a:{type:"simple-line",color:[156,39,176],width:10}}),o=s.view.map.findLayerById(s.displayedLayerid);void 0===o&&(o=new i({title:"漫游路径"+s.displayedLayerid,id:s.displayedLayerid,listMode:"hide"}),s.view.map.add(o)),o.add(r)})},ti.prototype.init=function(t){return Qt(this,void 0,void 0,function(){return Kt(this,function(e){return this.displayedLayerid=(new x).uuid,this.mobilelayerid=(new x).uuid,this.view=t,[2]})})},ti);function ti(e){var t=Vt.call(this)||this;return t.displayedLayerid="",t.view=null,t.mapRoamplayinternal=null,t.mobilelayerid="",t.init(e),t}return{load:P,Aurora:R,Layers:yt,Boundary:j,Draw:U,DynamicCloud:te,DynamicPolygon:he,GraphicOverlays:rt,FeaureOverlays:Oe,EchartFlashPointLayer:Ie,FlashPoint3DLayer:Ve,FlashGifLayer:Ge,HeatMap:ut,ContourMapLayer:Z,Measurement:Rt,MeshLine:_t,MaskBoundary:wt,TrajectoryPlus:ei,DynamicSquareFence:Le,DynamicCylinderFence:se,MigrationMap:Tt,Trajectory:Yt}});
//# sourceMappingURL=Plugins.min.js.map

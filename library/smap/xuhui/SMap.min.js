!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.SMap=t()}(this,function(){"use strict";function e(e,t){this.northeast=t,this.southwest=e,this.xmin=e[0],this.ymin=e[1],this.zmin=void 0!==e[2]?e[2]:void 0,this.xmax=t[0],this.ymax=t[1],this.zmax=void 0!==t[2]?t[2]:void 0}function t(e,t,i){this.X=e,this.Y=t,this.Z=void 0===i?0:i}function i(e){this.visible=!(void 0!==e.visible&&!e.visible),this.position=void 0===e.position||"top-right"===e.position?"top-right":e.position,this.collapse=!0===e.collapse}var r,o,l=((r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(a,o=i),a);function a(e){var t=o.call(this,e)||this;return t.controlName="basemaptoggle",t}var n,s,p=((n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(c,s=i),c);function c(e){var t=s.call(this,e)||this;return t.controlName="bimfilter",t.layerid=e.layerid,t}var u,d,y=((u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(h,d=i),h);function h(e){var t=d.call(this,e)||this;return t.controlName="basemapgallery",t}var v,b,m=((v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(f,b=i),f);function f(e){var t=b.call(this,e)||this;return t.controlName="baseMapGalleryExpand",t}var g,w,x=((g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(_,w=i),_);function _(e){var t=w.call(this,e)||this;return t.controlName="compass",t}var k,L,S=((k=function(e,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(z,L=i),z);function z(e){var t=L.call(this,e)||this;return t.controlName="fullscreen",t}var M,C,E=((M=function(e,t){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}M(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(H,C=i),H);function H(e){var t=C.call(this,e)||this;return t.controlName="home",t}var I,A,N=((I=function(e,t){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}I(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(R,A=i),R);function R(e){var t=A.call(this,e)||this;return t.controlName="toc",t}var T,X,P=((T=function(e,t){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(O,X=i),O);function O(e){var t=X.call(this,e)||this;return t.controlName="measurearea",t}var D,F,j=((D=function(e,t){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(G,F=i),G);function G(e){var t=F.call(this,e)||this;return t.controlName="measureline",t}var W,B,J=((W=function(e,t){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}W(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(V,B=i),V);function V(e){var t=B.call(this,e)||this;return t.controlName="undergroundswitch",t}var Z,Q,U=((Z=function(e,t){return(Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Z(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(q,Q=i),q);function q(e){var t=Q.call(this,e)||this;return t.controlName="zoom",t}var Y=($.jsapi="http://10.201.37.225:8080/smiapi/arcgis",$.jsapiversion4X="4.15",$.tokenserver={tokenType:"free",token_front:{url:"http://10.108.3.52:8080/onemap/tokens/generateToken",user:"none",password:"none"},token_black:{url:"http://10.108.3.16:8401/mapconfig/gistoken",tokenconfigname:"smiapi_new"}},$.proxyConifg={useProxy:!0,url:"http://10.201.37.225:8080/mapkProx/proxy.jsp?",httpsDomains:[{proxyUrl:"http://10.201.37.225:8080/mapkProx/proxy.jsp",domainName:"http://hostserver.xhbd.local"},{proxyUrl:"http://10.201.37.225:8080/mapkProx/proxy.jsp",domainName:"http://hostserver2.xhbd.local"}]},$.fonts={url:"http://10.201.37.225:8080/smiapi/arcgis/4.15/fonts"},$.gisService={geometryServiceUrl:"http:///mapserver.smi.sh.cegn.cn:8080/OneMapServer/rest/services/Geometry/GeometryServer",serverurl:"http://mapserver.smi.sh.cegn.cn:8080/OneMapServer/rest/services",baseMapServices:{isToken:!0,tokenType:"OneMap",layers:[{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2020/MapServer",layerEName:"basemap_air",isToken:!1,visible:!1,opacity:1,mapType:"SHCTiledMapServiceLayer",tag:"影像底图",layerCName:"影像底图",type:"basemap_air"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/BaseMap/MapServer",layerEName:"basemap_zw",isToken:!1,visible:!1,opacity:1,mapType:"SHCTiledMapServiceLayer",tag:"政务底图",layerCName:"政务底图",type:"basemap_zw"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/MarkerMap/MapServer",layerEName:"basemap_as",isToken:!1,visible:!1,opacity:1,mapType:"TileLayer",tag:"暗色底图",layerCName:"暗色底图",type:"basemap_as"}]},buildingsLayers:{id:"buildings_3d_layers",title:"空间基础",tag:"buildings_3d_layers",listMode:"show",visible:!0,layerGroups:[{id:"buildings_3d_above_layers",title:"地上",tag:"buildings_3d_above_layers",visible:!0,listMode:"show",layerGroups:[],layers:[{url:"http://hostserver.xhbd.local/arcgis/rest/services/Hosted/XuHuiJingMo/SceneServer",id:"model_air_real",isToken:!1,visible:!1,opacity:1,maptype:"SceneLayer",tag:"影像底图精模",title:"影像底图精模",elevationInfo:{mode:"absolute-height",offset:-4},type:"model_air_real",popupEnabled:!0,listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Hosted/XuHuiQuBaiMo/SceneServer",id:"model_white_zw",isToken:!1,visible:!0,opacity:1,maptype:"SceneLayer",tag:"政务白模型",title:"政务白模型",type:"model_white_zw",popupEnabled:!0,listMode:"show",renderer:{type:"simple",symbol:{type:"mesh-3d",symbolLayers:[{type:"fill",material:{color:[255,255,255,.6],colorMixMode:"replace"},edges:{type:"solid",color:[0,0,0,.6],size:1}}]}}},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Hosted/XuHuiQuBaiMo/SceneServer",id:"model_white_as",isToken:!1,visible:!1,opacity:1,maptype:"SceneLayer",tag:"暗色白模型",title:"暗色白模型",type:"model_white_as",popupEnabled:!0,listMode:"show",renderer:{type:"simple",symbol:{type:"mesh-3d",symbolLayers:[{type:"fill",material:{color:[77,126,176,1],colorMixMode:"replace"},edges:{type:"solid",color:[0,0,0,.6],size:1}}]}}}]}]},smapbussinessLayers:{serverurl:"http://hostserver.xhbd.local/arcgis/rest/services",istoken:!1,tokenType:"OneMap",layerGroups:[{id:"smap_3D_layers",title:"三维业务组",grouptype:"3D",tag:"smap_3D_layers",visible:!0,listMode:"show",layerGroups:[],layers:[]},{id:"smap_2D_layers",title:"二维业务组",grouptype:"2D",tag:"smap_2D_layers",visible:!0,listMode:"show",layerGroups:[{id:"history_images",title:"历史影像数据",tag:"history_images",visible:!0,listMode:"show",layers:[{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air1948/MapServer",id:"Air1948",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像1948",title:"影像1948",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air1979/MapServer",id:"Air1979",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像1979",title:"影像1979",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air1994/MapServer",id:"Air1994",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像1994",title:"影像1994",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2006/MapServer",id:"Air2006",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2006",title:"影像2006",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2008/MapServer",id:"Air2008",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2008",title:"影像2008",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2010/MapServer",id:"Air2010",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2010",title:"影像2010",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2011/MapServer",id:"Air2011",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2011",title:"影像2011",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2012/MapServer",id:"Air2012",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2012",title:"影像2012",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2013/MapServer",id:"Air2013",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2013",title:"影像2013",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2014/MapServer",id:"Air2014",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2014",title:"影像2014",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2015/MapServer",id:"Air2015",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2015",title:"影像2015",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2016/MapServer",id:"Air2016",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2016",title:"影像2016",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local2/arcgis/rest/services/Air2017/MapServer",id:"Air2017",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2017",title:"影像2017",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2018/MapServer",id:"Air2018",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2018",title:"影像2018",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2019/MapServer",id:"Air2019",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2019",title:"影像2019",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Air2020/MapServer",id:"Air2020",istoken:!1,visible:!1,opacity:1,maptype:"SHCTiledMapServiceLayer",tag:"影像2020",title:"影像2020",type:"image",listMode:"show"}]},{id:"xh_allboundary",title:"徐汇分区描边",tag:"xh_allboundary",visible:!0,listMode:"show",layers:[{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ/MapServer",id:"XH_boundarymask_xuhui",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"XH_boundarymask_xuhui",popupEnabled:!0,title:"徐汇区分区描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0403/MapServer",id:"XH_boundarymask_0403",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"天平街道描边",title:"天平街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0404/MapServer",id:"XH_boundarymask_0404",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"湖南街道描边",title:"湖南街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0407/MapServer",id:"XH_boundarymask_0407",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"斜土街道描边",title:"斜土街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0408/MapServer",id:"XH_boundarymask_0408",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"枫林街道描边",title:"枫林街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0410/MapServer",id:"XH_boundarymask_0410",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"长桥街道描边",title:"长桥街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0411/MapServer",id:"XH_boundarymask_0411",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"田林街道描边",title:"田林街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0412/MapServer",id:"XH_boundarymask_0412",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"红梅街道描边",title:"红梅街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0413/MapServer",id:"XH_boundarymask_0413",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"康健街道描边",title:"康健街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0414/MapServer",id:"XH_boundarymask_0414",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"徐家汇街道描边",title:"徐家汇街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0415/MapServer",id:"XH_boundarymask_0415",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"凌云街道描边",title:"凌云街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0416/MapServer",id:"XH_boundarymask_0416",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"龙华街道描边",title:"龙华街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0417/MapServer",id:"XH_boundarymask_0417",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"漕河泾街道描边",title:"漕河泾街道描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0418/MapServer",id:"XH_boundarymask_0418",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"华泾镇描边",title:"华泾镇描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0419/MapServer",id:"XH_boundarymask_0419",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"南站管委会描边",title:"南站管委会描边",type:"image",listMode:"show"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XHGQ_0420/MapServer",id:"XH_boundarymask_0420",istoken:!1,visible:!1,opacity:1,maptype:"TileLayer",tag:"滨江描边",title:"滨江描边",type:"image",listMode:"show"}]},{id:"XH_PIPELINE",title:"雨污管线",tag:"XH_PIPELINE",visible:!0,listMode:"show",layers:[{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_PIPELINE/FeatureServer/0",id:"XH_PIPELINE_WSGD",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"污水管点",title:"污水管点",popupTemplate:{title:"{exp_no}",content:[{type:"fields",fieldInfos:[{fieldName:"exp_no",label:"物探点号"},{fieldName:"feature",label:"特征"},{fieldName:"subsid",label:"附属物"},{fieldName:"dlmc",label:"道路名称"},{fieldName:"jjcc",label:"窨井尺寸"}]}]},elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!0},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_PIPELINE/FeatureServer/1",id:"XH_PIPELINE_YSGD",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"雨水管点",title:"雨水管点",popupTemplate:{title:"{exp_no}",content:[{type:"fields",fieldInfos:[{fieldName:"exp_no",label:"物探点号"},{fieldName:"feature",label:"特征"},{fieldName:"subsid",label:"附属物"},{fieldName:"dlmc",label:"道路名称"},{fieldName:"jjcc",label:"窨井尺寸"}]}]},elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!0},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_PIPELINE/FeatureServer/2",id:"XH_PIPELINE_HLGD",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"污水管点",title:"污水管点",popupTemplate:{title:"{exp_no}",content:[{type:"fields",fieldInfos:[{fieldName:"exp_no",label:"物探点号"},{fieldName:"feature",label:"特征"},{fieldName:"subsid",label:"附属物"},{fieldName:"dlmc",label:"道路名称"},{fieldName:"jjcc",label:"窨井尺寸"}]}]},elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!0},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_PIPELINE/FeatureServer/3",id:"XH_PIPELINE_YSGX",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"雨水管线",title:"雨水管线",popupTemplate:{title:"{s_point}",content:[{type:"fields",fieldInfos:[{fieldName:"s_point",label:"起点编号"},{fieldName:"e_point",label:"终点编号"},{fieldName:"material",label:"材质"},{fieldName:"pipe_size",label:"管径(mm)"},{fieldName:"s_deep",label:"起点埋深(m)"},{fieldName:"e_deep",label:"终点埋深(m)"},{fieldName:"s_h",label:"起点高程(m)"},{fieldName:"e_h",label:"终点高程(m)"},{fieldName:"dlmc",label:"道路名称"}]}]},elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!0},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_PIPELINE/FeatureServer/4",id:"XH_PIPELINE_WSGX",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"污水管线",title:"污水管线",popupTemplate:{title:"{s_point}",content:[{type:"fields",fieldInfos:[{fieldName:"s_point",label:"起点编号"},{fieldName:"e_point",label:"终点编号"},{fieldName:"material",label:"材质"},{fieldName:"pipe_size",label:"管径(mm)"},{fieldName:"s_deep",label:"起点埋深(m)"},{fieldName:"e_deep",label:"终点埋深(m)"},{fieldName:"s_h",label:"起点高程(m)"},{fieldName:"e_h",label:"终点高程(m)"},{fieldName:"dlmc",label:"道路名称"}]}]},elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!0},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_PIPELINE/FeatureServer/5",id:"XH_PIPELINE_HLGX",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"合流管线",title:"合流管线",popupTemplate:{title:"{s_point}",content:[{type:"fields",fieldInfos:[{fieldName:"s_point",label:"起点编号"},{fieldName:"e_point",label:"终点编号"},{fieldName:"material",label:"材质"},{fieldName:"pipe_size",label:"管径(mm)"},{fieldName:"s_deep",label:"起点埋深(m)"},{fieldName:"e_deep",label:"终点埋深(m)"},{fieldName:"s_h",label:"起点高程(m)"},{fieldName:"e_h",label:"终点高程(m)"},{fieldName:"dlmc",label:"道路名称"}]}]},elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!0}]},{id:"XH_PONDING",title:"积水区域",tag:"XH_PONDING",visible:!0,listMode:"show",layers:[{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_ROADPONDING/MapServer/0",id:"XH_ROADPONDING_JDSB",istoken:!1,visible:!1,opacity:.8,maptype:"FeatureLayer",tag:"积水道路街道上报",title:"积水道路街道上报",type:"image",renderer:{type:"simple",symbol:{type:"simple-fill",color:[0,222,255,.5],outline:{color:[0,222,255,0],width:"0px"}}},listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_ROADPONDING/MapServer/1",id:"XH_ROADPONDING_LQM",istoken:!1,visible:!1,opacity:.8,maptype:"FeatureLayer",tag:"积水道路利奇马",title:"积水道路利奇马",type:"image",renderer:{type:"simple",symbol:{type:"simple-fill",color:[0,222,255,.5],outline:{color:[0,222,255,0],width:"0px"}}},listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_ROADPONDING/MapServer/2",id:"XH_ROADPONDING_2018",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"T2018年常发积水点",title:"T2018年常发积水点",type:"image",renderer:{type:"simple",symbol:{type:"simple-fill",color:[0,222,255,.5],outline:{color:[0,222,255,0],width:"0px"}}},listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_ROADPONDING/FeatureServer/3",id:"XH_ROADPONDING_2017",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"T2017年常发积水点",title:"T2017年常发积水点",type:"image",renderer:{type:"simple",symbol:{type:"simple-fill",color:[0,222,255,.5],outline:{color:[0,222,255,0],width:"0px"}}},listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_ROADPONDING/FeatureServer/4",id:"XH_BLOCKPONDING_LQM",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"积水小区利奇马",title:"积水小区利奇马",type:"image",renderer:{type:"simple",symbol:{type:"simple-fill",color:[86,180,252,.5],outline:{color:[86,180,252,0],width:"0px"}}},listMode:"hide"}]},{id:"XH_RIVERLINE",title:"徐汇河网",tag:"XH_RIVERLINE",visible:!1,listMode:"show",layers:[{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RiverLine/FeatureServer/0",id:"XH_RIVERLINE_2",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"二级河流",title:"二级河流",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RiverLine/FeatureServer/1",id:"XH_RIVERLINE_3",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"三级河流",title:"三级河流",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RiverLine/FeatureServer/2",id:"XH_RIVERLINE_BOUND",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"河流边线",title:"河流边线",type:"image",listMode:"hide"}]},{id:"XH_ROADLINE",title:"徐汇道路",tag:"XH_ROADLINE",visible:!1,listMode:"show",layers:[{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/0",id:"XH_STREETLINE_3",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"三级街道",title:"三级街道",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/1",id:"XH_ROADLINE_4",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"四级公路",title:"四级公路",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/2",id:"XH_STREETLINE_4",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"四级街道",title:"四级街道",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/3",id:"XH_ROADLINE_3",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"三级公路",title:"三级公路",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/4",id:"XH_HIGHWAY",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"高速公路",title:"高速公路",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/5",id:"XH_STREETLINE_1",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"一级街道",title:"一级街道",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/6",id:"XH_STREETLINE_2",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"二级街道",title:"二级街道",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/7",id:"XH_ROADLINE_1",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"一级公路",title:"一级公路",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/8",id:"XH_ROADLINE_2",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"二级公路",title:"二级公路",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/9",id:"XH_STREETLINE_5",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"五级街道",title:"五级街道",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/10",id:"XH_EXPRESSWAY",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"城市快速路",title:"城市快速路",type:"image",listMode:"hide"},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_RoadLine/FeatureServer/11",id:"XH_ROADLINE_5",istoken:!1,visible:!0,opacity:1,maptype:"FeatureLayer",tag:"五级公路",title:"五级公路",type:"image",listMode:"hide"}]},{id:"XH_PONDING",title:"上海边界范围数据",tag:"shanghaiboundary",visible:!0,listMode:"show",layers:[{url:"http://hostserver2.xhbd.local/server/rest/services/Hosted/sh_qx_boundary/FeatureServer",id:"qx_boundary",istoken:!0,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"qx_boundary",title:"上海区县边界",renderer:{type:"simple",symbol:{type:"simple-fill",color:[0,227,229,0],outline:{color:[0,0,255,1],width:"2px"}}},type:"image",listMode:"show"},{url:"http://hostserver2.xhbd.local/server/rest/services/Hosted/sh_jd_boundary/FeatureServer",id:"jd_boundary",istoken:!0,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"jd_boundary",title:"上海街道边界",renderer:{type:"simple",symbol:{type:"simple-fill",color:[0,227,229,0],outline:{color:[0,255,0,1],width:"2px"}}},type:"image",listMode:"show"},{url:"http://hostserver2.xhbd.local/server/rest/services/Hosted/sh_jwh_boundary/FeatureServer",id:"jwh_boundary",istoken:!0,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"jwh_boundary",title:"上海居委会边界",renderer:{type:"simple",symbol:{type:"simple-fill",color:[0,227,229,0],outline:{color:[255,0,0,1],width:"2px"}}},type:"image",listMode:"show"}]}],layers:[{url:"http://hostserver.xhbd.local/arcgis/rest/services/XU_WG/FeatureServer",id:"XH_WG",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"网格",title:"网格",type:"image",listMode:"show",popupEnabled:!1,renderer:{type:"simple",symbol:{type:"simple-fill",color:[0,227,229,0],outline:{color:[20,227,229,1],width:"2px"}}}},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XU_JD/FeatureServer",id:"XH_JD",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇区街道",title:"徐汇区街道",type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_JD_V2/FeatureServer",id:"XH_JD_V2",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇区街道V2",title:"徐汇区街道V2",labelingInfo:[{symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:[205,102,102,255]},halo:{color:[0,0,0,.7],size:3},size:25}]},labelPlacement:"above-center",labelExpressionInfo:{expression:"$feature.jd_name"}}],type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_GNQ/FeatureServer",id:"XH_GNQ",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇功能区",title:"徐汇功能区",labelingInfo:[{symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:[0,230,169,255]},halo:{color:[0,0,0,.7],size:3},size:22}]},labelPlacement:"above-center",labelExpressionInfo:{expression:"$feature.gnqname"}}],type:"image",listMode:"show",popupEnabled:!1},{url:"http://31.0.37.222/arcgis/rest/services/XH_GNQ2/FeatureServer",id:"XH_GNQ2",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇功能区2",title:"徐汇功能区2",labelingInfo:[{symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:[0,230,169,255]},halo:{color:[0,0,0,.7],size:3},size:25}]},labelPlacement:"above-center",labelExpressionInfo:{expression:"$feature.gnqname"}}],type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_ZDGNQ/FeatureServer",id:"XH_ZDGNQ",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇4新功能区",title:"徐汇4新功能区",labelingInfo:[{symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:[0,230,169,255]},halo:{color:[0,0,0,.7],size:3},size:25}]},labelPlacement:"above-center",labelExpressionInfo:{expression:"$feature.name"}}],type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_ZJGD/MapServer",id:"XH_ZJGD",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"在建工地",title:"在建工地",type:"image",listMode:"show",labelingInfo:[{symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:"white"},halo:{color:[0,0,0,.7],size:3},size:25}]},labelPlacement:"above-center",labelExpressionInfo:{expression:"$feature.地图上"}}],popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_JWH/FeatureServer",id:"XH_JWH",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇居委会",title:"徐汇居委会",labelingInfo:[{symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:[84,212,223,255]},halo:{color:[0,0,0,.7],size:3},size:20}]},labelPlacement:"above-center",labelExpressionInfo:{expression:"$feature.jwhname"}}],type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_XQ_Polygon/FeatureServer",id:"XH_XQ_Polygon",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇小区面",title:"徐汇小区面",type:"image",listMode:"show",popupEnabled:!1,renderer:{type:"simple",symbol:{type:"simple-fill",color:[255,235,175,.1],outline:{color:[255,235,175,1],width:"1.5px"}}}},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_FMQ_XQ/FeatureServer",id:"XH_FMQ_XQ",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇风貌小区",title:"徐汇风貌小区",type:"image",listMode:"show",popupEnabled:!1,renderer:{type:"simple",symbol:{type:"simple-fill",color:[255,235,175,.1],outline:{color:[255,235,175,1],width:"1.5px"}}}},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_GJCRK/MapServer",id:"XH_GJCRK",istoken:!1,visible:!1,opacity:1,maptype:"MapImageLayer",tag:"徐汇轨交出入口",title:"徐汇轨交出入口",type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/Hosted/cameraPoint/FeatureServer",id:"XH_VideoCamera",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇区摄像头",title:"徐汇区摄像头",type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_XQ_CenterPoint/FeatureServer",id:"XH_XQ_CenterPoint",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇区小区中心点",title:"徐汇区小区中心点",type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XU_GJZD/FeatureServer",id:"XH_GJZD",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇轨交站点",title:"徐汇轨交站点",elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_GJXL/FeatureServer",id:"XH_GJXL",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇轨交线路",title:"徐汇轨交线路",elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!1},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_XIAN_REGION/FeatureServer/1",id:"XH_XIAN_REIGON",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇西岸范围",title:"徐汇西岸范围",elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!0},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_XIAN_REGION/FeatureServer/0",id:"XH_BINJIANG_REIGON",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"徐汇滨江范围",title:"徐汇滨江范围",elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!0,renderer:{type:"simple",symbol:{type:"line-3d",symbolLayers:[{type:"path",profile:"quad",material:{color:[0,254,255,.4]},width:6,height:.5,join:"miter",cap:"round",anchor:"bottom",profileRotation:"heading"}]}}},{url:"http://hostserver.xhbd.local/arcgis/rest/services/XH_PSXT/FeatureServer/0",id:"XH_PSXT",istoken:!1,visible:!1,opacity:1,maptype:"FeatureLayer",tag:"排水系统",title:"排水系统",renderer:{type:"simple",symbol:{type:"simple-fill",color:[36,241,254,.1],outline:{color:[36,241,254,1],width:4}}},labelingInfo:[{symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:"white"},halo:{color:[0,0,0,.7],size:3},size:20}]},labelPlacement:"above-center",labelExpressionInfo:{expression:"$feature.排水系"}}],elevationInfo:"relative-to-ground",type:"image",listMode:"show",popupEnabled:!0},{id:"Hight_Graphiclayer",istoken:!1,visible:!0,opacity:1,maptype:"GraphicsLayer",tag:"辅助显示图层",title:"辅助显示图层",type:"image",listMode:"hide"},{id:"location_Hightlight",istoken:!1,visible:!0,opacity:1,maptype:"GraphicsLayer",tag:"地名地址高亮",title:"地名地址高亮",type:"image",listMode:"hide"}]}]}},$);function $(){}var K=Y.jsapiversion4X,ee="next";function te(e){if(null===e&&(e=K),e.toString().toLowerCase()===ee)return ee;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function ie(e){return void 0===e&&(e=K),Y.jsapi+"/"+e+"/init.js"}function re(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function oe(e,t){if(t){var i=document.querySelector(t);i.parentNode.insertBefore(e,i)}else document.head.appendChild(e)}function le(e){return document.querySelector('link[href*="'+e+'"]')}function ae(e){return!e||te(e)?function(e){void 0===e&&(e=K),null===e&&(e=K);var t=ie(e),i=t.substring(0,t.indexOf("init.js")),r=te(e);return r===ee||3!==r.major?i+"esri/themes/light/main.css":i+(r.minor<=10?"js/":"")+"esri/css/esri.css"}(e):e}function ne(e,t){var i=ae(e),r=le(i);if(r||oe(r=re(i),t),4===function(e){null===e&&(e=K);var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}(e).major){var o=i.substring(0,i.indexOf("esri/themes/"))+"esri/themes/gis/css/gis.css",l=le(o);l||oe(l=re(o),t)}return r}var se={Promise:"undefined"!=typeof window?window.Promise:void 0},pe={};function ce(e,t,i){var r,o,l,a;i&&(l=i,a=function(e){l(e.error||new Error("There was an error attempting to load "+o.src)),o.removeEventListener("error",a,!1)},(o=e).addEventListener("error",a,!1),r=a);var n=function(){t(e),e.removeEventListener("load",n,!1),r&&e.removeEventListener("error",r,!1)};e.addEventListener("load",n,!1)}function ue(){return document.querySelector("script[data-shsmi]")}function de(){var e=window.require;return e&&e.on}function ye(e){void 0===e&&(e={});var s={};[pe,e].forEach(function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])});var p=s.version,c=s.url||ie(p);return new se.Promise(function(e,t){var i,r,o=ue();if(o){var l=o.getAttribute("src");l!==c?t(new Error("The ArcGIS API for JavaScript is already loaded ("+l+").")):de()?e(o):ce(o,e,t)}else if(de())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var a=s.css;if(a)ne(!0===a?p:a,s.insertCssBefore);else ne(null,s.insertCssBefore);if(s.dojoConfig)window.dojoConfig=s.dojoConfig;else{var n={async:!0,packages:[{location:Y.jsapi+"/extensions",name:"smiapi"},{location:Y.jsapi+"/extensions/geolocation",name:"geolocate",main:"geolocate"}],deps:["@dojo/framework/shim/main"],has:{"esri-promise-compatibility":1,"esri-featurelayer-webgl":1}};window.dojoConfig=n}i=c,(r=document.createElement("script")).type="text/javascript",r.src=i,r.setAttribute("data-shsmi","loading"),ce(o=r,function(){o.setAttribute("data-shsmi","loaded"),e(o)},t),document.head.appendChild(o)}})}function he(t){return new se.Promise(function(i,e){var r=window.require.on("error",e);window.require(t,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.remove(),i(e)})})}function ve(e,t){if(void 0===t&&(t={}),de())return he(e);var i=ue(),r=i&&i.getAttribute("src");return!t.url&&r&&(t.url=r),ye(t).then(function(){return he(e)})}var be=function(e,a,n,s){return new(n=n||Promise)(function(i,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(r,o)}l((s=s.apply(e,a||[])).next())})},me=function(i,r){var o,l,a,e,n={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;n;)try{if(o=1,l&&(a=2&t[0]?l.return:t[0]?l.throw||((a=l.return)&&a.call(l),0):l.next)&&!(a=a.call(l,t[1])).done)return a;switch(l=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,l=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(!(a=0<(a=n.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){n=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){n.label=t[1];break}if(6===t[0]&&n.label<a[1]){n.label=a[1],a=t;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(t);break}a[2]&&n.ops.pop(),n.trys.pop();continue}t=r.call(i,n)}catch(e){t=[6,e],l=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};var fe=function(e,a,n,s){return new(n=n||Promise)(function(i,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(r,o)}l((s=s.apply(e,a||[])).next())})},ge=function(i,r){var o,l,a,e,n={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;n;)try{if(o=1,l&&(a=2&t[0]?l.return:t[0]?l.throw||((a=l.return)&&a.call(l),0):l.next)&&!(a=a.call(l,t[1])).done)return a;switch(l=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,l=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(!(a=0<(a=n.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){n=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){n.label=t[1];break}if(6===t[0]&&n.label<a[1]){n.label=a[1],a=t;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(t);break}a[2]&&n.ops.pop(),n.trys.pop();continue}t=r.call(i,n)}catch(e){t=[6,e],l=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};function we(v,b,m,f,g){return fe(this,void 0,void 0,function(){var t,i,r,o,l,a,n,s,p,c,u,d,y,h;return ge(this,function(e){switch(e.label){case 0:return[4,ve(["esri/Map","esri/Basemap","esri/geometry/Point","esri/core/urlUtils","esri/config","esri/identity/IdentityManager","esri/core/watchUtils","esri/views/SceneView"])];case 1:return t=e.sent(),i=t[0],r=t[1],o=t[2],l=t[3],a=t[4],n=t[5],s=t[6],p=t[7],m.useProxy&&m.httpsDomains.map(function(e){l.addProxyRule({proxyUrl:e.proxyUrl,urlPrefix:e.domainName})}),a.geometryServiceUrl=b.geometryServiceUrl,""!==f&&n.registerToken({server:b.serverurl,token:f}),n.on("dialog-create",function(){n.dialog.open=!0}),[4,function(a,n){return be(this,void 0,void 0,function(){var t,i,r,o,l;return me(this,function(e){switch(e.label){case 0:return[4,ve(["esri/geometry/Extent","esri/layers/SHCTiledMapServiceLayer","esri/layers/TileLayer","esri/geometry/SpatialReference"])];case 1:return t=e.sent(),i=t[0],r=t[1],o=t[2],l=t[3],[2,a.map(function(e){switch(e.mapType){case"SHCTiledMapServiceLayer":var t=new i({xmin:-65e3,ymin:-76e3,xmax:75000.00000000003,ymax:72000.00000000003,spatialReference:l.WebMercator});return!0===e.isToken?new r({url:e.url,token:n,fullExtent:t,opacity:e.opacity,title:e.layerCName,id:e.layerEName,visible:e.visible}):new r({url:e.url,fullExtent:t,opacity:e.opacity,title:e.layerCName,id:e.layerEName,visible:e.visible});case"TileLayer":return new o({url:e.url,id:e.layerEName,visible:e.visible,opacity:e.opacity,listMode:e.listMode,title:e.layerCName})}})]}})})}(b.baseMapServices.layers,f)];case 2:return c=e.sent(),u=new r({baseLayers:c,title:"底图",id:"basemap_zw"}),d=new i({basemap:u}),[4,function(l,f){return be(this,void 0,void 0,function(){var t,a,n,s,p,c,u,d,y,o,h,v,b,m,i,r;return me(this,function(e){switch(e.label){case 0:return[4,ve(["esri/layers/TileLayer","esri/layers/SceneLayer","esri/layers/VectorTileLayer","esri/layers/MapImageLayer","esri/layers/IntegratedMeshLayer","esri/layers/PointCloudLayer","esri/layers/BuildingSceneLayer","esri/layers/SHCTiledMapServiceLayer","esri/layers/SHCMapServiceLayer","esri/layers/GroupLayer","esri/layers/FeatureLayer","esri/layers/GraphicsLayer","esri/geometry/Extent","esri/geometry/SpatialReference"])];case 1:return t=e.sent(),a=t[0],n=t[1],t[2],s=t[3],p=t[4],c=t[5],u=t[6],d=t[7],y=t[8],o=t[9],h=t[10],v=t[11],b=t[12],m=t[13],i=new o({id:l.id,title:l.title,visible:l.visible,listMode:l.listMode}),r=l.layerGroups.map(function(e){var t=new o({id:e.id,title:e.title,visible:e.visible,listMode:e.listMode});if(null!=e.layerGroups){var i=e.layerGroups.reverse().map(function(e){var l=new o({id:e.id,title:e.title,visible:e.visible,listMode:e.listMode});return e.layers.reverse().map(function(e){switch(e.maptype){case"TileLayer":l.add(new a(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,listMode:e.listMode}));break;case"MapImageLayer":l.add(new s(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,listMode:e.listMode}));break;case"FeatureLayer":var t=new h(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,listMode:e.listMode,popupEnabled:e.popupEnabled});return null!=e.renderer&&void 0!==e.renderer&&(t.renderer=e.renderer),null!=e.labelingInfo&&void 0!==e.labelingInfo&&(t.labelingInfo=e.labelingInfo),null!=e.elevationInfo&&void 0!==e.elevationInfo&&(t.elevationInfo=e.elevationInfo),null!=e.popupTemplate&&void 0!==e.popupTemplate&&(t.popupTemplate=e.popupTemplate),t;case"SceneLayer":var i=new n(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,popupEnabled:e.popupEnabled});null!=e.renderer&&void 0!==e.renderer&&(i.renderer=e.renderer),null!=e.elevationInfo&&void 0!==e.elevationInfo&&(i.elevationInfo=e.elevationInfo),null!=e.popupTemplate&&void 0!==e.popupTemplate&&(i.popupTemplate=e.popupTemplate),l.add(i);break;case"BuildingSceneLayer":l.add(new u({url:e.url,id:e.id,title:e.title,visible:e.visible,opacity:e.opacity}));break;case"PointCloudLayer":l.add(new c(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,listMode:e.listMode}));break;case"IntegratedMeshLayer":l.add(new p(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,listMode:e.listMode}));case"GraphicsLayer":l.add(new v({id:e.id,visible:e.visible,opacity:e.opacity,listMode:e.listMode,title:e.title}));break;case"SHCTiledMapServiceLayer":var r=new b({xmin:-65e3,ymin:-76e3,xmax:75000.00000000003,ymax:72000.00000000003,spatialReference:m.WebMercator});!0===e.istoken?l.add(d({url:e.url,token:f,fullExtent:r,opacity:e.opacity,title:e.title,id:e.id,visible:e.visible})):l.add(d({url:e.url,fullExtent:r,opacity:e.opacity,title:e.title,id:e.id,visible:e.visible}));break;case"SHCMapServiceLayer":var o=new b({xmin:-65e3,ymin:-76e3,xmax:75000.00000000003,ymax:72000.00000000003,spatialReference:m.WebMercator});!0===e.istoken?l.add(y({url:e.url,token:f,fullExtent:o,opacity:e.opacity,title:e.title,id:e.id,visible:e.visible})):l.add(new y({url:e.url,fullExtent:o,opacity:e.opacity,title:e.title,id:e.id,visible:e.visible}))}}),l});t.addMany(i)}if(null!=e.layers){var r=e.layers.reverse().map(function(e){switch(e.maptype){case"TileLayer":return new a(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity});case"MapImageLayer":return new s(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity});case"FeatureLayer":var t=new h(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,popupEnabled:e.popupEnabled});return null!=e.renderer&&void 0!==e.renderer&&(t.renderer=e.renderer),null!=e.labelingInfo&&void 0!==e.labelingInfo&&(t.labelingInfo=e.labelingInfo),null!=e.elevationInfo&&void 0!==e.elevationInfo&&(t.elevationInfo=e.elevationInfo),null!=e.popupTemplate&&void 0!==e.popupTemplate&&(t.popupTemplate=e.popupTemplate),t;case"SceneLayer":var i=new n(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,popupEnabled:e.popupEnabled});return null!=e.renderer&&void 0!==e.renderer&&(i.renderer=e.renderer),null!=e.elevationInfo&&void 0!==e.elevationInfo&&(i.elevationInfo=e.elevationInfo),null!=e.popupTemplate&&void 0!==e.popupTemplate&&(i.popupTemplate=e.popupTemplate),i;case"BuildingSceneLayer":return new u({url:e.url,id:e.id,title:e.title,visible:e.visible,opacity:e.opacity});case"PointCloudLayer":return new c(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,listMode:e.listMode});case"IntegratedMeshLayer":return new p(e.url,{id:e.id,title:e.title,visible:e.visible,opacity:e.opacity,listMode:e.listMode});case"GraphicsLayer":return new v({id:e.id,visible:e.visible,opacity:e.opacity,listMode:e.listMode,title:e.title})}});t.addMany(r)}return t}),i.addMany(r),[2,i]}})})}(b.buildingsLayers,f)];case 3:if(y=e.sent(),d.add(y),void 0!==g.mapStyle){switch(g.mapStyle){case"smap://styles/normal":d.basemap.id="basemap_zw";break;case"smap://styles/dark":d.basemap.id="basemap_as";break;case"smap://styles/image":d.basemap.id="basemap_air";break;default:d.basemap.id="basemap_as"}d.basemap.baseLayers.items.forEach(function(e){e.id===d.basemap.id?e.visible=!0:e.visible=!1}),["model_white_zw","model_air_real","model_white_as"].forEach(function(e){var t=d.findLayerById(e);!1===g.showBuildingBlock?t&&(t.visible=!1):t&&("basemap_zw"===d.basemap.id?t.visible="model_white_zw"===e:"basemap_as"===d.basemap.id?t.visible="model_white_as"===e:"basemap_air"===d.basemap.id&&(t.visible="model_air_real"===e))})}return((h=new p({map:d,container:v,spatialReference:{wkid:102100},viewingMode:"local"})).ui.empty("top-left"),h.ui.empty("top-right"),h.ui.empty("bottom-left"),h.ui.empty("bottom-right"),h.padding={top:5,bottom:0,left:0,right:5},h.when(function(){h.qualitySettings.memoryLimit=4096,n.on("dialog-create",function(){n.dialog.open=!0})}),void 0!==g.center&&(h.center=new o({x:g.center[0],y:g.center[1],z:void 0!==g.center[2]?g.center[2]:0,spatialReference:{wkid:102100}})),void 0!==g.zoom&&(h.zoom=g.zoom),void 0===g.pitch)?[3,5]:[4,h.goTo({center:h.center,zoom:h.zoom,tilt:g.pitch,heading:0})];case 4:e.sent(),s.when(h,"animation",function(e){e.when(function(e){void 0!==g.zooms&&h.watch("zoom",function(e){e>=g.zooms[1]&&(h.zoom=g.zooms[1]),e<=g.zooms[0]&&(h.zoom=g.zooms[0])})}).catch(function(e){console.log(e)})}),e.label=5;case 5:return[2,{sceneView:h,mapv:d}]}})})}function xe(y,h,v,b,m){return fe(this,void 0,void 0,function(){var t,i,r,o,l,a,n,s,p,c,u,d;return ge(this,function(e){switch(e.label){case 0:return[4,ve(["esri/Map","esri/Basemap","esri/core/urlUtils","esri/config","esri/identity/IdentityManager","esri/geometry/Point","esri/views/MapView"])];case 1:return t=e.sent(),i=t[0],r=t[1],o=t[2],l=t[3],a=t[4],n=t[5],s=t[6],v.useProxy&&v.httpsDomains.map(function(e){o.addProxyRule({proxyUrl:e.proxyUrl,urlPrefix:e.domainName})}),l.geometryServiceUrl=h.geometryserviceUrl,l.fontsUrl=Y.fonts.url,""!==b&&a.registerToken({server:h.serverurl,token:b}),a.on("dialog-create",function(){a.dialog.open=!0}),[4,function(a,n){return be(this,void 0,void 0,function(){var t,i,r,o,l;return me(this,function(e){switch(e.label){case 0:return[4,ve(["esri/geometry/Extent","esri/layers/TileLayer","esri/layers/SceneLayer","esri/layers/SHCTiledMapServiceLayer","esri/layers/GroupLayer","esri/geometry/SpatialReference"])];case 1:return t=e.sent(),i=t[0],r=t[1],t[2],o=t[3],t[4],l=t[5],[2,a.map(function(e){switch(e.mapType){case"SHCTiledMapServiceLayer":var t=new i({xmin:-65e3,ymin:-76e3,xmax:75000.00000000003,ymax:72000.00000000003,spatialReference:l.WebMercator});return!0===e.isToken?new o({url:e.url,token:n,fullExtent:t,opacity:e.opacity,title:e.layerCName,id:e.layerEName,visible:e.visible}):new o({url:e.url,fullExtent:t,opacity:e.opacity,title:e.layerCName,id:e.layerEName,visible:e.visible});case"TileLayer":return new r(e.url,{id:e.layerEName,visible:e.visible,opacity:e.opacity,listMode:e.listMode,title:e.layerCName})}})]}})})}(h.baseMapServices.layers,b)];case 2:if(p=e.sent(),c=new r({baseLayers:p,title:"底图",id:"basemap_as"}),u=new i({basemap:c}),void 0!==m.mapStyle){switch(m.mapStyle){case"smap://styles/normal":u.basemap.id="basemap_zw";break;case"smap://styles/dark":u.basemap.id="basemap_as";break;case"smap://styles/image":u.basemap.id="basemap_air";break;default:u.basemap.id="basemap_as"}u.basemap.baseLayers.items.forEach(function(e){e.id===u.basemap.id?e.visible=!0:e.visible=!1})}return(d=new s({map:u,container:y,spatialReference:{wkid:102100}})).ui.empty("top-left"),d.ui.empty("top-right"),d.ui.empty("bottom-left"),d.ui.empty("bottom-right"),d.padding={top:5,bottom:0,left:0,right:5},void 0!==m.center&&(d.center=new n({x:m.center[0],y:m.center[1],spatialReference:{wkid:102100}})),void 0!==m.zoom&&(d.zoom=m.zoom),void 0!==m.zooms&&(d.constraints.minZoom=m.zooms[0],d.constraints.maxZoom=m.zooms[1]),void 0!==m.rotateEnable&&(d.constraints.rotationEnabled=m.rotateEnable),[2,{mapView:d,mapv:u}]}})})}var _e=(ke.prototype._addListener=function(e,t,i){if(this.emit("newListener",e,t),this.events.has(e)){var r=this.events.get(e);i?r.unshift(t):r.push(t)}else this.events.set(e,[t]);var o=this.getMaxListeners();if(0<o&&this.listenerCount(e)>o){var l=new Error("Possible EventEmitter memory leak detected.\n         "+this.listenerCount(e)+" "+e.toString()+" listeners.\n         Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",console.warn(l)}return this},ke.prototype.addListener=function(e,t){return this._addListener(e,t,!1)},ke.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(this.events.has(e)){for(var r=0,o=this.events.get(e).slice();r<o.length;r++){var l=o[r];try{l.apply(this,t)}catch(e){this.emit("error",e)}}return!0}if("error"===e)throw 0<t.length?t[0]:Error("Unhandled error.");return!1},ke.prototype.eventNames=function(){return Array.from(this.events.keys())},ke.prototype.getMaxListeners=function(){return this.maxListeners||ke.defaultMaxListeners},ke.prototype.listenerCount=function(e){return this.events.has(e)?this.events.get(e).length:0},ke.prototype._listeners=function(e,t,i){if(!e.events.has(t))return[];var r=e.events.get(t);return i?this.unwrapListeners(r):r.slice(0)},ke.prototype.unwrapListeners=function(e){for(var t=new Array(e.length),i=0;i<e.length;i++)t[i]=e[i].listener||e[i];return t},ke.prototype.listeners=function(e){return this._listeners(this,e,!0)},ke.prototype.rawListeners=function(e){return this._listeners(this,e,!1)},ke.prototype.off=function(e,t){return this.removeListener(e,t)},ke.prototype.on=function(e,t){return this.addListener(e,t)},ke.prototype.once=function(e,t){var i=this.onceWrap(e,t);return this.on(e,i),this},ke.prototype.onceWrap=function(e,t){function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.context.removeListener(this.eventName,this.rawListener),this.listener.apply(this.context,e)}var r={eventName:e,listener:t,rawListener:i,context:this},o=i.bind(r);return(r.rawListener=o).listener=t,o},ke.prototype.prependListener=function(e,t){return this._addListener(e,t,!0)},ke.prototype.prependOnceListener=function(e,t){var i=this.onceWrap(e,t);return this.prependListener(e,i),this},ke.prototype.removeAllListeners=function(e){var t=this;if(void 0===this.events)return this;if(this.events.has(e)){var i=this.events.get(e).slice();this.events.delete(e);for(var r=0,o=i;r<o.length;r++){var l=o[r];this.emit("removeListener",e,l)}}else this.eventNames().map(function(e){t.removeAllListeners(e)});return this},ke.prototype.removeListener=function(e,t){if(this.events.has(e)){var i=this.events.get(e);-1!==i.indexOf(t)&&(i.splice(i.indexOf(t),1),this.emit("removeListener",e,t),0===i.length&&this.events.delete(e))}return this},ke.prototype.setMaxListeners=function(e){return this.maxListeners=e,this},ke.defaultMaxListeners=50,ke);function ke(){this.events=new Map}var Le,Se,ze,Me,Ce=(Ee.maploaded="maploaded",Ee.zoomchanged="zoomchanged",Ee.extentchanged="extentchanged",Ee.centerchanged="centerchanged",Ee.blur="blur",Ee.click="click",Ee.doubleclick="doubleclick",Ee.drag="drag",Ee.focus="focus",Ee.hold="hold",Ee.keydown="key-down",Ee.keyup="key-up",Ee.mousewheel="mouse-wheel",Ee.pointerdown="pointer-down",Ee.pointerenter="pointer-enter",Ee.pointerleave="pointer-leave",Ee.pointermove="pointer-move",Ee.pointerup="pointer-up",Ee.resize="pointer-up",Ee.popupvisible="popup-visible",Ee);function Ee(){}(Se=Le=Le||{}).noCache="no-cache",Se.default="default",Se.reload="reload",Se.forceCache="force-cache",Se.onlyIfCached="only-if-cached",Se.cache="cache",(Me=ze=ze||{}).noCors="no-cors",Me.sameOrigin="same-origin",Me.cors="cors";var He,Ie,Ae=(He=function(e,t){return(He=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}He(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ne=function(e,a,n,s){return new(n=n||Promise)(function(i,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(r,o)}l((s=s.apply(e,a||[])).next())})},Re=function(i,r){var o,l,a,e,n={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;n;)try{if(o=1,l&&(a=2&t[0]?l.return:t[0]?l.throw||((a=l.return)&&a.call(l),0):l.next)&&!(a=a.call(l,t[1])).done)return a;switch(l=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,l=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(!(a=0<(a=n.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){n=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){n.label=t[1];break}if(6===t[0]&&n.label<a[1]){n.label=a[1],a=t;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(t);break}a[2]&&n.ops.pop(),n.trys.pop();continue}t=r.call(i,n)}catch(e){t=[6,e],l=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Te=(Ae(Xe,Ie=_e),Xe.prototype.setlayerRenderer=function(e,t){var i=this.view.map.findLayerById(e);i&&(i.renderer=t)},Xe.prototype.addLayer=function(e){!function(v,b,m){be(this,void 0,void 0,function(){return me(this,function(e){return ve(["esri/layers/TileLayer","esri/layers/SceneLayer","esri/layers/FeatureLayer","esri/layers/MapImageLayer","esri/layers/SHCTiledMapServiceLayer","esri/layers/GraphicsLayer","esri/geometry/Extent","esri/geometry/SpatialReference"]).then(function(e){var t=e[0],i=e[1],r=e[2],o=e[3],l=e[4],a=e[5],n=e[6],s=e[7];switch(v.layerType){case"TileLayer":var p=new t({url:v.layerUrl,id:v.layerLayerId,visible:void 0===v.layerVisible||v.layerVisible,opacity:void 0!==v.layerOpacity?v.layerOpacity:1,title:v.layerTitle});v.layerMaxScale&&(p.maxScale=v.layerMaxScale),v.layerMinScale&&(p.minScale=v.layerMinScale);break;case"FeatureLayer":var c=new r({url:v.layerUrl,id:v.layerLayerId,visible:void 0===v.layerVisible||v.layerVisible,opacity:void 0!==v.layerOpacity?v.layerOpacity:1,title:v.layerTitle,popupEnabled:void 0===v.layerPopupEnabled||v.layerPopupEnabled});v.layerPopupTemplate&&(c.popupTemplate=v.layerPopupTemplate),v.layerRenderer&&(c.renderer=v.layerRenderer),v.layerMaxScale&&(c.maxScale=v.layerMaxScale),v.layerMinScale&&(c.minScale=v.layerMinScale),v.layerLabelingInfo&&(c.labelingInfo=v.layerLabelingInfo),v.layerLabelsVisible&&(c.labelsVisible=v.layerLabelsVisible),v.layerelevationInfo&&(c.elevationInfo=v.layerelevationInfo),b.map.add(c);break;case"SceneLayer":var u=new i({url:v.layerUrl,id:v.layerLayerId,visible:void 0===v.layerVisible||v.layerVisible,opacity:void 0!==v.layerOpacity?v.layerOpacity:1,title:v.layerTitle,popupEnabled:void 0===v.layerPopupEnabled||v.layerPopupEnabled});v.layerPopupTemplate&&(u.popupTemplate=v.layerPopupTemplate),v.layerRenderer&&(u.renderer=v.layerRenderer),v.layerMaxScale&&(u.maxScale=v.layerMaxScale),v.layerMinScale&&(u.minScale=v.layerMinScale),v.layerelevationInfo&&(c.elevationInfo=v.layerelevationInfo),b.map.add(u);break;case"MapImageLayer":var d=new o({url:v.layerUrl,id:v.layerLayerId,visible:void 0===v.layerVisible||v.layerVisible,opacity:void 0!==v.layerOpacity?v.layerOpacity:1,title:v.layerTitle});v.layerMaxScale&&(d.maxScale=v.layerMaxScale),v.layerMinScale&&(d.minScale=v.layerMinScale),v.layerSublayers&&(d.sublayers=v.layerSublayers),b.map.add(d);break;case"SHCTiledMapServiceLayer":var y=new n({xmin:-65e3,ymin:-76e3,xmax:75000.00000000003,ymax:72000.00000000003,spatialReference:s.WebMercator});!0===v.isToken?b.map.add(new l({url:v.layerUrl,token:m,fullExtent:y,title:v.layerTitle,opacity:void 0!==v.layerOpacity?v.layerOpacity:1,id:v.layerLayerId,visible:void 0===v.layerVisible||v.layerVisible})):b.map.add(new l({url:v.layerUrl,fullExtent:y,opacity:void 0!==v.layerOpacity?v.layerOpacity:1,title:v.layerTitle,id:v.layerLayerId,visible:void 0===v.layerVisible||v.layerVisible}));break;case"GraphicsLayer":var h=new a({id:v.layerLayerId,visible:void 0===v.layerVisible||v.layerVisible,opacity:void 0!==v.layerOpacity?v.layerOpacity:1,title:v.layerTitle});v.layerMaxScale&&(u.maxScale=v.layerMaxScale),v.layerMinScale&&(u.minScale=v.layerMinScale),v.layerelevationInfo&&(c.elevationInfo=v.layerelevationInfo),b.map.add(h)}}).catch(function(e){console.error(e)}),[2]})})}(e,this.view,this.maptoken)},Xe.prototype.getZoom=function(){if(this.view)return this.view.zoom},Xe.prototype.setZoom=function(e){this.view&&(this.view.zoom=e)},Xe.prototype.panTo=function(i){var r=this;this.view&&ve(["esri/geometry/Point"]).then(function(e){var t=new e[0]({x:i[0],y:i[1],z:void 0!==i[2]?i[2]:0,spatialReference:r.view.spatialReference});r.view.center=t}).catch(function(e){console.error(e)})},Xe.prototype.panBy=function(e,t){if(this.view){var i=this.view.center,r=this.view.toScreen(i);this.view.center=this.view.toMap({x:r.x+e,y:r.y+t})}},Xe.prototype.getBounds=function(){if(this.view){var e={};return e.southwest=[this.view.extent.xmin.toFixed(6),this.view.extent.ymin.toFixed(6)],"3D"===this.viewMode&&void 0!==this.view.extent.zmin&&e.southwest.push(this.view.extent.zmin.toFixed(6)),e.northeast=[this.view.extent.xmax.toFixed(6),this.view.extent.ymax.toFixed(6)],"3D"===this.viewMode&&void 0!==this.view.extent.zmax&&e.northeast.push(this.view.extent.zmax.toFixed(6)),e}},Xe.prototype.setBounds=function(r){var o=this;this.view&&ve(["esri/geometry/Extent","esri/geometry/SpatialReference"]).then(function(e){var t=e[0],i=(e[1],new t({xmin:r.xmin,ymin:r.ymin,xmax:r.xmax,zmax:r.ymax,spatialReference:o.view.spatialReference}));"3D"===o.viewMode&&void 0!==r.zmin&&void 0!==r.zmax&&(i.zmin=r.zmin,i.zmax=r.zmax),o.view.extent=i}).catch(function(e){console.error(e)})},Xe.prototype.setCenter=function(o,l,a){return Ne(this,void 0,void 0,function(){var t,i,r;return Re(this,function(e){switch(e.label){case 0:return this.view?[4,ve(["esri/geometry/Point","esri/geometry/SpatialReference"])]:[3,2];case 1:t=e.sent(),i=t[0],t[1],r=null,r="2D"===this.viewMode?new i({x:o,y:l,spatialReference:this.view.spatialReference}):new i({x:o,y:l,z:void 0!==a?a:0,spatialReference:this.view.spatialReference}),this.view.center=r,e.label=2;case 2:return[2]}})})},Xe.prototype.setZoomAndCenter=function(o,l){return Ne(this,void 0,void 0,function(){var t,i,r;return Re(this,function(e){switch(e.label){case 0:return this.view?[4,ve(["esri/geometry/Point","esri/geometry/SpatialReference"])]:[3,2];case 1:t=e.sent(),i=t[0],t[1],r=null,"2D"===this.viewMode?(this.view.zoom=o,r=new i({x:l[0],y:l[1],spatialReference:this.view.spatialReference}),this.view.center=r):(r=new i({x:l[0],y:l[1],z:void 0!==l[2]?l[2]:0,spatialReference:this.view.spatialReference}),this.view.goTo({center:r,zoom:o,tilt:this.view.camera.tilt,heading:this.view.camera.heading})),e.label=2;case 2:return[2]}})})},Xe.prototype.getCenter=function(){if(this.view){var e=[];return e.push(this.view.center.x.toFixed(6)),e.push(this.view.center.y.toFixed(6)),"3D"===this.viewMode&&e.push(this.view.center.z.toFixed(6)),e}},Xe.prototype.getScale=function(){if(this.view)return this.view.scale},Xe.prototype.setRotation=function(e){this.view&&("2D"===this.viewMode?this.view.rotation=e:this.view.goTo({center:this.view.center,zoom:this.view.zoom,tilt:this.view.camera.tilt,heading:e}))},Xe.prototype.setPitch=function(e){this.view&&"3D"===this.viewMode&&this.view.goTo({center:this.view.center,zoom:this.view.zoom,tilt:e,heading:this.view.camera.heading})},Xe.prototype.getPitch=function(){if(this.view&&"3D"===this.viewMode)return this.view.camera.tilt},Xe.prototype.zoomIn=function(){this.view&&("3D"===this.viewMode?this.view.zoom+1>=this.zooms[0]&&this.view.zoom+1<=this.zooms[1]&&this.view.goTo({center:this.view.center,zoom:this.view.zoom+1,tilt:this.view.camera.tilt,heading:this.view.camera.heading}):this.view.goTo({center:this.view.center,zoom:this.view.zoom+1}))},Xe.prototype.zoomOut=function(){this.view&&("3D"===this.viewMode?this.view.zoom-1>=this.zooms[0]&&this.view.zoom-1<=this.zooms[1]&&this.view.goTo({center:this.view.center,zoom:this.view.zoom-1,tilt:this.view.camera.tilt,heading:this.view.camera.heading}):this.view.goTo({center:this.view.center,zoom:this.view.zoom-1}))},Xe.prototype.setMapStyle=function(e){var i=this;if(this.view){switch(e){case"smap://styles/light":this.view.map.basemap.id="basemap_zw";break;case"smap://styles/dark":this.view.map.basemap.id="basemap_as";break;case"smap://styles/image":this.view.map.basemap.id="basemap_air";break;default:return}if(this.view.map.basemap.baseLayers.items.forEach(function(e){e.id===i.view.map.basemap.id?e.visible=!0:e.visible=!1}),"2D"===this.viewMode)return;["model_white_zw","model_air_real","model_white_as"].forEach(function(e){var t=i.view.map.findLayerById(e);!1===i.showBuildingBlock?t.visible=!1:t&&("basemap_zw"===i.view.map.basemap.id?t.visible="model_white_zw"===e:"basemap_as"===i.view.map.basemap.id?t.visible="model_white_as"===e:"basemap_air"===i.view.map.basemap.id&&(t.visible="model_air_real"===e))})}},Xe.prototype.getMapStyle=function(){if(this.view)switch(this.view.map.basemap.id){case"basemap_zw":return"smap://styles/light";case"basemap_as":return"smap://styles/dark";case"basemap_air":return"smap://styles/image"}},Xe.prototype.showBuilding=function(e){var i=this;null!==this.view&&"2D"!==this.viewMode&&(this.showBuildingBlock=!!e,["model_white_zw","model_air_real","model_white_as"].forEach(function(e){var t=i.view.map.findLayerById(e);!1===i.showBuildingBlock?t.visible=!1:t&&("basemap_zw"===i.view.map.basemap.id?t.visible="model_white_zw"===e:"basemap_as"===i.view.map.basemap.id?t.visible="model_white_as"===e:"basemap_air"===i.view.map.basemap.id&&(t.visible="model_air_real"===e))}))},Xe.prototype.addControl=function(l){var a=this;if("toc"===l.controlName.toLowerCase())ve(["esri/widgets/LayerList","esri/widgets/Expand"]).then(function(e){var t=e[0],i=e[1],r=new t({container:document.createElement("div"),id:"maplayerlist",view:a.view});if(l.collapse){var o=new i({id:"layerlistonly",view:a.view,content:r.domNode,expandIconClass:"esri-icon-layers",expandTooltip:"专题图层框",group:"top-left"});a.mapControl.push([l.controlName,o]),l.visible&&a.view.ui.add(o,l.position)}else a.mapControl.push([l.controlName,r]),a.view.ui.add(r,l.position)}).catch(function(e){console.error(e)});else if("zoom"===l.controlName.toLowerCase())ve(["esri/widgets/Zoom"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)});else if("compass"===l.controlName.toLowerCase())ve(["esri/widgets/Compass"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)});else if("home"===l.controlName.toLowerCase())ve(["esri/widgets/Home"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)});else if("fullscreen"===l.controlName.toLowerCase())ve(["esri/widgets/Fullscreen"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)});else if("undergroundswitch"===l.controlName.toLowerCase()){if("2D"===this.viewMode)return;ve(["esri/widgets/AboveBelowModeSwitch"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)})}else if("measurearea"===l.controlName.toLowerCase())"2D"===this.viewMode?ve(["esri/widgets/AreaMeasureMentButton2D"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)}):ve(["esri/widgets/AreaMeasureMentButton3D"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)});else if("measureline"===l.controlName.toLowerCase())"2D"===this.viewMode?ve(["esri/widgets/DistanceMeasureMentButton2D"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)}):ve(["esri/widgets/DistanceMeasureMentButton3D"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)});else if("basemaptoggle"===l.controlName.toLowerCase())"2D"===this.viewMode?ve(["esri/widgets/BaseMapSwitchButton2D"]).then(function(e){var t=new e[0]({view:a.view});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)}):ve(["esri/widgets/BaseMapSwitchButton3D"]).then(function(e){var t=new e[0]({view:a.view,showBuildingBlock:a.showBuildingBlock});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)});else if("basemapgallery"===l.controlName.toLowerCase())ve(["esri/widgets/BMapGallery_Control"]).then(function(e){var t=new e[0]({view:a.view,showBuildingBlock:a.showBuildingBlock});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)});else if("basemapgalleryexpand"===l.controlName.toLowerCase())ve(["esri/widgets/BMapGallery_Expand"]).then(function(e){var t=new e[0]({view:a.view,showBuildingBlock:a.showBuildingBlock});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)});else if("bimfilter"===l.controlName.toLowerCase()){if("2D"===this.viewMode)return;ve(["esri/widgets/BuildingSencelayerFilter"]).then(function(e){var t=new e[0]({view:a.view,layerid:l.layerid});a.mapControl.push([l.controlName,t]),l.visible&&a.view.ui.add(t,l.position)}).catch(function(e){console.error(e)})}},Xe.prototype.removeControl=function(r){var o=this;this.mapControl.forEach(function(e,t,i){e[0]===r.controlName&&(o.view.ui.remove(e[1]),o.mapControl.slice(t,1))})},Xe.prototype.enableThroughGround=function(e){null!==this.view&&"2D"!==this.viewMode&&(e?(this.view.map.ground.surfaceColor="#fff",this.view.map.ground.opacity=0,this.view.map.ground.navigationConstraint={type:"none"}):(this.view.map.ground.surfaceColor=null,this.view.map.ground.opacity=1,this.view.map.ground.navigationConstraint={type:"stay-above"}))},Xe.prototype.add=function(g){var w=this;ve(["esri/Graphic","esri/geometry/Point","esri/symbols/PictureMarkerSymbol","esri/geometry/Polyline","esri/geometry/Polygon"]).then(function(e){var v=e[0],b=e[1],m=(e[2],e[3]),f=e[4];if(g instanceof Array)g.forEach(function(e){if("marker"===e.overlaytype.toLowerCase()){var t=void 0;t="2D"===w.viewMode?{type:"picture-marker",url:e.icon.image,width:e.icon.size.width,height:e.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:e.icon.size.width,resource:{href:e.icon.image}}]};var i=e.attributes;i.uuid=e.uuid;var r=new v({geometry:new b({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:w.view.spatialReference}),symbol:t,attributes:i});if(w.mapoverlayers.push(["smap-default",e.uuid,r]),w.view.graphics.add(r),e.label.visible){var o=new v({geometry:new b({x:"3D"===w.viewMode?e.position[0]+e.label.xoffset:e.position[0],y:"3D"===w.viewMode?e.position[1]+e.label.yoffset:e.position[1],z:"3D"===w.viewMode?e.position[2]+e.label.zoffset:e.position[2],spatialReference:w.view.spatialReference}),symbol:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},attributes:i});w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",e.uuid,o])}}else if("polyline"===e.overlaytype.toLowerCase()){var l={type:"simple-line",color:e.strokeColor,style:e.style,width:e.width,cap:e.cap,join:e.lineJoin},a=[];e.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var n=new m({hasZ:!1,hasM:!1,paths:a,spatialReference:w.view.spatialReference}),s=e.attributes;s.uuid=e.uuid;var p=new v({geometry:n,symbol:l,attributes:s});w.mapoverlayers.push(["smap-default",e.uuid,p]),w.view.graphics.add(p),e.label.visible&&(o=new v({geometry:p.geometry.extent.center,symbol:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},attributes:s}),w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",e.uuid,o]))}else if("polygon"===e.overlaytype.toLowerCase()){var c=void 0;c="simple"===e.symboltype?{type:"simple-fill",color:e.fillColor,style:e.style,outline:{color:e.strokeColor,width:e.strokeWeight,style:e.strokestyle}}:{type:"picture-fill",url:e.url,width:e.picwidth,height:e.picheight,outline:{style:e.strokestyle,color:e.strokeColor,width:e.strokeWeight}};var u=[];e.paths.forEach(function(e){u.push([e.X,e.Y,e.Z])});var d=new f({hasZ:!0,hasM:!0,rings:u,spatialReference:w.view.spatialReference}),y=e.attributes;y.uuid=e.uuid;var h=new v({geometry:d,symbol:c,attributes:y});w.mapoverlayers.push(["smap-default",e.uuid,h]),w.view.graphics.add(h),e.label.visible&&(o=new v({geometry:h.geometry.extent.center,symbol:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},attributes:y}),w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",e.uuid,o]))}});else if("group"===g.type)g.overlayers.forEach(function(e){if("marker"===e.overlaytype.toLowerCase()){var t=void 0;t="2D"===w.viewMode?{type:"picture-marker",url:e.icon.image,width:e.icon.size.width,height:e.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:e.icon.size.width,resource:{href:e.icon.image}}]};var i=e.attributes;i.uuid=e.uuid;var r=new v({geometry:new b({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:w.view.spatialReference}),symbol:t,attributes:i});if(w.mapoverlayers.push([g.uuid,e.uuid,r]),w.view.graphics.add(r),e.label.visible){var o=new v({geometry:new b({x:"3D"===w.viewMode?e.position[0]+e.label.xoffset:e.position[0],y:"3D"===w.viewMode?e.position[1]+e.label.yoffset:e.position[1],z:"3D"===w.viewMode?e.position[2]+e.label.zoffset:e.position[2],spatialReference:w.view.spatialReference}),symbol:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},attributes:i});w.view.graphics.add(o),w.mapoverlayers.push([g.uuid,e.uuid,o])}}else if("polyline"===e.overlaytype.toLowerCase()){var l={type:"simple-line",color:e.strokeColor,style:e.style,width:e.width,cap:e.cap,join:e.lineJoin},a=[];e.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var n=new m({hasZ:!1,hasM:!1,paths:a,spatialReference:w.view.spatialReference}),s=e.attributes;s.uuid=e.uuid;var p=new v({geometry:n,symbol:l,attributes:s});w.mapoverlayers.push([g.uuid,e.uuid,p]),w.view.graphics.add(p),e.label.visible&&(o=new v({geometry:p.geometry.extent.center,symbol:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},attributes:s}),w.view.graphics.add(o),w.mapoverlayers.push([g.uuid,e.uuid,o]))}else if("polygon"===e.overlaytype.toLowerCase()){var c=void 0;c="simple"===e.symboltype?{type:"simple-fill",color:e.fillColor,style:e.style,outline:{color:e.strokeColor,width:e.strokeWeight,style:e.strokestyle}}:{type:"picture-fill",url:e.url,width:e.picwidth,height:e.picheight,outline:{style:e.strokestyle,color:e.strokeColor,width:e.strokeWeight}};var u=[];e.paths.forEach(function(e){u.push([e.X,e.Y,e.Z])});var d=e.attributes;d.uuid=e.uuid;var y=new f({hasZ:!0,hasM:!0,rings:u,spatialReference:w.view.spatialReference}),h=new v({geometry:y,symbol:c,attributes:d});w.mapoverlayers.push([g.uuid,e.uuid,h]),w.view.graphics.add(h),e.label.visible&&(o=new v({geometry:h.geometry.extent.center,symbol:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},attributes:d}),w.view.graphics.add(o),w.mapoverlayers.push([g.uuid,e.uuid,o]))}});else if("element"===g.type)if("marker"===g.overlaytype.toLowerCase()){var t=void 0;t="2D"===w.viewMode?{type:"picture-marker",url:g.icon.image,width:g.icon.size.width,height:g.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:g.icon.size.width,resource:{href:g.icon.image}}]};var i=g.attributes;i.uuid=g.uuid;var r=new v({geometry:new b({x:g.position[0],y:g.position[1],z:void 0===g.position[2]?0:g.position[2],spatialReference:w.view.spatialReference}),symbol:t,attributes:i});if(w.mapoverlayers.push(["smap-default",g.uuid,r]),w.view.graphics.add(r),g.label.visible){var o=new v({geometry:new b({x:"3D"===w.viewMode?g.position[0]+g.label.xoffset:g.position[0],y:"3D"===w.viewMode?g.position[1]+g.label.yoffset:g.position[1],z:"3D"===w.viewMode?g.position[2]+g.label.zoffset:g.position[2],spatialReference:w.view.spatialReference}),symbol:{type:g.label.type,text:g.label.text,color:g.label.color,angle:g.label.angle,backgroundColor:g.label.backgroundColor,borderLineColor:g.label.borderLineColor,borderLineSize:g.label.borderLineSize,kerning:g.label.kerning,lineHeight:g.label.lineHeight,lineWidth:g.label.lineWidth,rotated:g.label.rotated,haloColor:g.label.haloColor,haloSize:g.label.haloSize,xoffset:g.label.xoffset,yoffset:g.label.yoffset,verticalAlignment:g.label.verticalAlignment,horizontalAlignment:g.label.horizontalAlignment,font:{size:g.label.size,family:"Josefin Slab",weight:g.label.weight}},attributes:i});w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",g.uuid,o])}}else if("polyline"===g.overlaytype.toLowerCase()){var l={type:"simple-line",color:g.strokeColor,style:g.style,width:g.width,cap:g.cap,join:g.lineJoin},a=[];g.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var n=new m({hasZ:!1,hasM:!1,paths:a,spatialReference:w.view.spatialReference}),s=g.attributes;s.uuid=g.uuid;var p=new v({geometry:n,symbol:l,attributes:s});w.mapoverlayers.push(["smap-default",g.uuid,p]),w.view.graphics.add(p),g.label.visible&&(o=new v({geometry:p.geometry.extent.center,symbol:{type:g.label.type,text:g.label.text,color:g.label.color,angle:g.label.angle,backgroundColor:g.label.backgroundColor,borderLineColor:g.label.borderLineColor,borderLineSize:g.label.borderLineSize,kerning:g.label.kerning,lineHeight:g.label.lineHeight,lineWidth:g.label.lineWidth,rotated:g.label.rotated,haloColor:g.label.haloColor,haloSize:g.label.haloSize,xoffset:g.label.xoffset,yoffset:g.label.yoffset,verticalAlignment:g.label.verticalAlignment,horizontalAlignment:g.label.horizontalAlignment,font:{size:g.label.size,family:"Josefin Slab",weight:g.label.weight}},attributes:s}),w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",g.uuid,o]))}else if("polygon"===g.overlaytype.toLowerCase()){var c=void 0;c="simple"===g.symboltype?{type:"simple-fill",color:g.fillColor,style:g.style,outline:{color:g.strokeColor,width:g.strokeWeight,style:g.strokestyle}}:{type:"picture-fill",url:g.url,width:g.picwidth,height:g.picheight,outline:{style:g.strokestyle,color:g.strokeColor,width:g.strokeWeight}};var u=[];g.paths.forEach(function(e){u.push([e.X,e.Y,e.Z])});var d=g.attributes;d.uuid=g.uuid;var y=new f({hasZ:!0,hasM:!0,rings:u,spatialReference:w.view.spatialReference}),h=new v({geometry:y,symbol:c,attributes:d});w.mapoverlayers.push(["smap-default",g.uuid,h]),w.view.graphics.add(h),g.label.visible&&(o=new v({geometry:h.geometry.extent.center,symbol:{type:g.label.type,text:g.label.text,color:g.label.color,angle:g.label.angle,backgroundColor:g.label.backgroundColor,borderLineColor:g.label.borderLineColor,borderLineSize:g.label.borderLineSize,kerning:g.label.kerning,lineHeight:g.label.lineHeight,lineWidth:g.label.lineWidth,rotated:g.label.rotated,haloColor:g.label.haloColor,haloSize:g.label.haloSize,xoffset:g.label.xoffset,yoffset:g.label.yoffset,verticalAlignment:g.label.verticalAlignment,horizontalAlignment:g.label.horizontalAlignment,font:{size:g.label.size,family:"Josefin Slab",weight:g.label.weight}},attributes:d}),w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",g.uuid,o]))}}).catch(function(e){console.error(e)})},Xe.prototype.remove=function(t){var i=this;t instanceof Array?t.forEach(function(t){i.mapoverlayers.filter(function(e){return e[1]===t.uuid}).forEach(function(e){i.view.graphics.remove(e[2])}),i.mapoverlayers=i.mapoverlayers.filter(function(e){return e[1]!==t.uuid})}):"group"===t.type?(this.mapoverlayers.filter(function(e){return e[0]===t.uuid}).forEach(function(e){i.view.graphics.remove(e[2])}),this.mapoverlayers=this.mapoverlayers.filter(function(e){return e[0]!==t.uuid})):"element"===t.type&&(this.mapoverlayers.filter(function(e){return e[1]===t.uuid}).forEach(function(e){i.view.graphics.remove(e[2])}),this.mapoverlayers=this.mapoverlayers.filter(function(e){return e[1]!==t.uuid}))},Xe.prototype.update=function(g){var w=this;ve(["esri/Graphic","esri/geometry/Point","esri/symbols/PictureMarkerSymbol","esri/geometry/Polyline","esri/geometry/Polygon"]).then(function(e){var v=e[0],b=e[1],m=(e[2],e[3]),f=e[4];if(g instanceof Array)g.forEach(function(t){if(w.mapoverlayers.filter(function(e){return e[1]===t.uuid}).forEach(function(e){w.view.graphics.remove(e[2])}),w.mapoverlayers=w.mapoverlayers.filter(function(e){return e[1]!==t.uuid}),"marker"===t.overlaytype.toLowerCase()){var e=void 0;e="2D"===w.viewMode?{type:"picture-marker",url:t.icon.image,width:t.icon.size.width,height:t.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:t.icon.size.width,resource:{href:t.icon.image}}]};var i=t.attributes;i.uuid=t.uuid;var r=new v({geometry:new b({x:t.position[0],y:t.position[1],z:void 0===t.position[2]?0:t.position[2],spatialReference:w.view.spatialReference}),symbol:e,attributes:i});if(w.mapoverlayers.push(["smap-default",t.uuid,r]),w.view.graphics.add(r),t.label.visible){var o=new v({geometry:new b({x:"3D"===w.viewMode?t.position[0]+t.label.xoffset:t.position[0],y:"3D"===w.viewMode?t.position[1]+t.label.yoffset:t.position[1],z:"3D"===w.viewMode?t.position[2]+t.label.zoffset:t.position[2],spatialReference:w.view.spatialReference}),symbol:{type:t.label.type,text:t.label.text,color:t.label.color,angle:t.label.angle,backgroundColor:t.label.backgroundColor,borderLineColor:t.label.borderLineColor,borderLineSize:t.label.borderLineSize,kerning:t.label.kerning,lineHeight:t.label.lineHeight,lineWidth:t.label.lineWidth,rotated:t.label.rotated,haloColor:t.label.haloColor,haloSize:t.label.haloSize,xoffset:t.label.xoffset,yoffset:t.label.yoffset,verticalAlignment:t.label.verticalAlignment,horizontalAlignment:t.label.horizontalAlignment,font:{size:t.label.size,family:"Josefin Slab",weight:t.label.weight}},attributes:i});w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",t.uuid,o])}}else if("polyline"===t.overlaytype.toLowerCase()){var l={type:"simple-line",color:t.strokeColor,style:t.style,width:t.width,cap:t.cap,join:t.lineJoin},a=[];t.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var n=new m({hasZ:!1,hasM:!1,paths:a,spatialReference:w.view.spatialReference}),s=t.attributes;s.uuid=t.uuid;var p=new v({geometry:n,symbol:l,attributes:s});w.mapoverlayers.push(["smap-default",t.uuid,p]),w.view.graphics.add(p),t.label.visible&&(o=new v({geometry:p.geometry.extent.center,symbol:{type:t.label.type,text:t.label.text,color:t.label.color,angle:t.label.angle,backgroundColor:t.label.backgroundColor,borderLineColor:t.label.borderLineColor,borderLineSize:t.label.borderLineSize,kerning:t.label.kerning,lineHeight:t.label.lineHeight,lineWidth:t.label.lineWidth,rotated:t.label.rotated,haloColor:t.label.haloColor,haloSize:t.label.haloSize,xoffset:t.label.xoffset,yoffset:t.label.yoffset,verticalAlignment:t.label.verticalAlignment,horizontalAlignment:t.label.horizontalAlignment,font:{size:t.label.size,family:"Josefin Slab",weight:t.label.weight}},attributes:s}),w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",t.uuid,o]))}else if("polygon"===t.overlaytype.toLowerCase()){var c=void 0;c="simple"===t.symboltype?{type:"simple-fill",color:t.fillColor,style:t.style,outline:{color:t.strokeColor,width:t.strokeWeight,style:t.strokestyle}}:{type:"picture-fill",url:t.url,width:t.picwidth,height:t.picheight,outline:{style:t.strokestyle,color:t.strokeColor,width:t.strokeWeight}};var u=[];t.paths.forEach(function(e){u.push([e.X,e.Y,e.Z])});var d=new f({hasZ:!0,hasM:!0,rings:u,spatialReference:w.view.spatialReference}),y=t.attributes;y.uuid=t.uuid;var h=new v({geometry:d,symbol:c,attributes:y});w.mapoverlayers.push(["smap-default",t.uuid,h]),w.view.graphics.add(h),t.label.visible&&(o=new v({geometry:h.geometry.extent.center,symbol:{type:t.label.type,text:t.label.text,color:t.label.color,angle:t.label.angle,backgroundColor:t.label.backgroundColor,borderLineColor:t.label.borderLineColor,borderLineSize:t.label.borderLineSize,kerning:t.label.kerning,lineHeight:t.label.lineHeight,lineWidth:t.label.lineWidth,rotated:t.label.rotated,haloColor:t.label.haloColor,haloSize:t.label.haloSize,xoffset:t.label.xoffset,yoffset:t.label.yoffset,verticalAlignment:t.label.verticalAlignment,horizontalAlignment:t.label.horizontalAlignment,font:{size:t.label.size,family:"Josefin Slab",weight:t.label.weight}},attributes:y}),w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",t.uuid,o]))}});else if("group"===g.type)w.mapoverlayers.filter(function(e){return e[0]===g.uuid}).forEach(function(e){w.view.graphics.remove(e[2])}),w.mapoverlayers=w.mapoverlayers.filter(function(e){return e[0]!==g.uuid}),g.overlayers.forEach(function(e){if("marker"===e.overlaytype.toLowerCase()){var t=void 0;t="2D"===w.viewMode?{type:"picture-marker",url:e.icon.image,width:e.icon.size.width,height:e.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:e.icon.size.width,resource:{href:e.icon.image}}]};var i=e.attributes;i.uuid=e.uuid;var r=new v({geometry:new b({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:w.view.spatialReference}),symbol:t,attributes:i});if(w.mapoverlayers.push([g.uuid,e.uuid,r]),w.view.graphics.add(r),e.label.visible){var o=new v({geometry:new b({x:"3D"===w.viewMode?e.position[0]+e.label.xoffset:e.position[0],y:"3D"===w.viewMode?e.position[1]+e.label.yoffset:e.position[1],z:"3D"===w.viewMode?e.position[2]+e.label.zoffset:e.position[2],spatialReference:w.view.spatialReference}),symbol:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},attributes:i});w.view.graphics.add(o),w.mapoverlayers.push([g.uuid,e.uuid,o])}}else if("polyline"===e.overlaytype.toLowerCase()){var l={type:"simple-line",color:e.strokeColor,style:e.style,width:e.width,cap:e.cap,join:e.lineJoin},a=[];e.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var n=new m({hasZ:!1,hasM:!1,paths:a,spatialReference:w.view.spatialReference}),s=e.attributes;s.uuid=e.uuid;var p=new v({geometry:n,symbol:l,attributes:s});w.mapoverlayers.push([g.uuid,e.uuid,p]),w.view.graphics.add(p),e.label.visible&&(o=new v({geometry:p.geometry.extent.center,symbol:{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}},attributes:s}),w.view.graphics.add(o),w.mapoverlayers.push([g.uuid,e.uuid,o]))}else if("polygon"===e.overlaytype.toLowerCase()){var c=void 0;c="simple"===g.symboltype?{type:"simple-fill",color:g.fillColor,style:g.style,outline:{color:g.strokeColor,width:g.strokeWeight,style:g.strokestyle}}:{type:"picture-fill",url:g.url,width:g.picwidth,height:g.picheight,outline:{style:g.strokestyle,color:g.strokeColor,width:g.strokeWeight}};var u=[];g.paths.forEach(function(e){u.push([e.X,e.Y,e.Z])});var d=e.attributes;d.uuid=e.uuid;var y=new f({hasZ:!0,hasM:!0,rings:u,spatialReference:w.view.spatialReference}),h=new v({geometry:y,symbol:c,attributes:d});w.mapoverlayers.push(["smap-default",g.uuid,h]),w.view.graphics.add(h),g.label.visible&&(o=new v({geometry:h.geometry.extent.center,symbol:{type:g.label.type,text:g.label.text,color:g.label.color,angle:g.label.angle,backgroundColor:g.label.backgroundColor,borderLineColor:g.label.borderLineColor,borderLineSize:g.label.borderLineSize,kerning:g.label.kerning,lineHeight:g.label.lineHeight,lineWidth:g.label.lineWidth,rotated:g.label.rotated,haloColor:g.label.haloColor,haloSize:g.label.haloSize,xoffset:g.label.xoffset,yoffset:g.label.yoffset,verticalAlignment:g.label.verticalAlignment,horizontalAlignment:g.label.horizontalAlignment,font:{size:g.label.size,family:"Josefin Slab",weight:g.label.weight}},attributes:d}),w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",g.uuid,o]))}});else if("element"===g.type)if(w.mapoverlayers.filter(function(e){return e[1]===g.uuid}).forEach(function(e){w.view.graphics.remove(e[2])}),w.mapoverlayers=w.mapoverlayers.filter(function(e){return e[1]!==g.uuid}),"marker"===g.overlaytype.toLowerCase()){var t=void 0;t="2D"===w.viewMode?{type:"picture-marker",url:g.icon.image,width:g.icon.size.width,height:g.icon.size.height}:{type:"point-3d",symbolLayers:[{type:"icon",size:g.icon.size.width,resource:{href:g.icon.image}}]};var i=g.attributes;i.uuid=g.uuid;var r=new v({geometry:new b({x:g.position[0],y:g.position[1],z:void 0===g.position[2]?0:g.position[2],spatialReference:w.view.spatialReference}),symbol:t,attributes:i});if(w.mapoverlayers.push(["smap-default",g.uuid,r]),w.view.graphics.add(r),g.label.visible){var o=new v({geometry:new b({x:"3D"===w.viewMode?g.position[0]+g.label.xoffset:g.position[0],y:"3D"===w.viewMode?g.position[1]+g.label.yoffset:g.position[1],z:"3D"===w.viewMode?g.position[2]+g.label.zoffset:g.position[2],spatialReference:w.view.spatialReference}),symbol:{type:g.label.type,text:g.label.text,color:g.label.color,angle:g.label.angle,backgroundColor:g.label.backgroundColor,borderLineColor:g.label.borderLineColor,borderLineSize:g.label.borderLineSize,kerning:g.label.kerning,lineHeight:g.label.lineHeight,lineWidth:g.label.lineWidth,rotated:g.label.rotated,haloColor:g.label.haloColor,haloSize:g.label.haloSize,xoffset:g.label.xoffset,yoffset:g.label.yoffset,verticalAlignment:g.label.verticalAlignment,horizontalAlignment:g.label.horizontalAlignment,font:{size:g.label.size,family:"Josefin Slab",weight:g.label.weight}},attributes:i});w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",g.uuid,o])}}else if("polyline"===g.overlaytype.toLowerCase()){var l={type:"simple-line",color:g.strokeColor,style:g.style,width:g.width,cap:g.cap,join:g.lineJoin},a=[];g.path.forEach(function(e){a.push([e.X,e.Y,e.Z])});var n=new m({hasZ:!1,hasM:!1,paths:a,spatialReference:w.view.spatialReference}),s=g.attributes;s.uuid=g.uuid;var p=new v({geometry:n,symbol:l,attributes:s});w.mapoverlayers.push(["smap-default",g.uuid,p]),w.view.graphics.add(p),g.label.visible&&(o=new v({geometry:p.geometry.extent.center,symbol:{type:g.label.type,text:g.label.text,color:g.label.color,angle:g.label.angle,backgroundColor:g.label.backgroundColor,borderLineColor:g.label.borderLineColor,borderLineSize:g.label.borderLineSize,kerning:g.label.kerning,lineHeight:g.label.lineHeight,lineWidth:g.label.lineWidth,rotated:g.label.rotated,haloColor:g.label.haloColor,haloSize:g.label.haloSize,xoffset:g.label.xoffset,yoffset:g.label.yoffset,verticalAlignment:g.label.verticalAlignment,horizontalAlignment:g.label.horizontalAlignment,font:{size:g.label.size,family:"Josefin Slab",weight:g.label.weight}},attributes:s}),w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",g.uuid,o]))}else if("polygon"===g.overlaytype.toLowerCase()){var c=void 0;c="simple"===g.symboltype?{type:"simple-fill",color:g.fillColor,style:g.style,outline:{color:g.strokeColor,width:g.strokeWeight,style:g.strokestyle}}:{type:"picture-fill",url:g.url,width:g.picwidth,height:g.picheight,outline:{style:g.strokestyle,color:g.strokeColor,width:g.strokeWeight}};var u=[];g.paths.forEach(function(e){u.push([e.X,e.Y,e.Z])});var d=new f({hasZ:!0,hasM:!0,rings:u,spatialReference:w.view.spatialReference}),y=g.attributes;y.uuid=g.uuid;var h=new v({geometry:d,symbol:c,attributes:y});w.mapoverlayers.push(["smap-default",g.uuid,h]),w.view.graphics.add(h),g.label.visible&&(o=new v({geometry:h.geometry.extent.center,symbol:{type:g.label.type,text:g.label.text,color:g.label.color,angle:g.label.angle,backgroundColor:g.label.backgroundColor,borderLineColor:g.label.borderLineColor,borderLineSize:g.label.borderLineSize,kerning:g.label.kerning,lineHeight:g.label.lineHeight,lineWidth:g.label.lineWidth,rotated:g.label.rotated,haloColor:g.label.haloColor,haloSize:g.label.haloSize,xoffset:g.label.xoffset,yoffset:g.label.yoffset,verticalAlignment:g.label.verticalAlignment,horizontalAlignment:g.label.horizontalAlignment,font:{size:g.label.size,family:"Josefin Slab",weight:g.label.weight}},attributes:y}),w.view.graphics.add(o),w.mapoverlayers.push(["smap-default",g.uuid,o]))}})},Xe.prototype.addfeature=function(v){var b=this;ve(["esri/layers/FeatureLayer","esri/layers/support/LabelClass","esri/Graphic","esri/geometry/Point","esri/symbols/PictureMarkerSymbol","esri/geometry/Polyline","esri/geometry/Polygon"]).then(function(e){var s=e[0],p=e[1],c=e[2],u=e[3];if(e[4],e[5],e[6],v instanceof Array)v.forEach(function(e){if("marker"===e.overlaytype.toLowerCase()){var t=void 0;t="3D"===b.viewMode?{type:"simple",symbol:{type:"point-3d",symbolLayers:[{type:"icon",size:e.icon.size.width,resource:{href:e.icon.image}}]}}:{type:"simple",symbol:{type:"picture-marker",url:e.icon.image,width:e.icon.size.width,height:e.icon.size.height}};var i=[{name:"objectId",alias:"objectId",type:"oid"},{name:"uuid",alias:"唯一标识",type:"string"}];Object.keys(e.attributes).forEach(function(e){i.push({name:e,alias:e,type:"string"})});var r=new s({id:e.uuid,title:e.uuid,objectIdField:"OBJECTID",geometryType:"point",renderer:t,screenSizePerspectiveEnabled:!0,popupEnabled:!1,popupTemplate:!1,fields:i,source:[],spatialReference:b.view.spatialReference}),o=e.attributes;o.uuid=e.uuid;var l=new c({geometry:new u({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:b.view.spatialReference}),attributes:o});if(r.source.add(l),b.view.map.add(r),b.mapoverlayersflayer.push([e.uuid,e.uuid,l]),e.label.visible){var a=void 0;a="2D"===b.viewMode?{type:e.label.type,text:e.label.text,color:e.label.color,angle:e.label.angle,backgroundColor:e.label.backgroundColor,borderLineColor:e.label.borderLineColor,borderLineSize:e.label.borderLineSize,kerning:e.label.kerning,lineHeight:e.label.lineHeight,lineWidth:e.label.lineWidth,rotated:e.label.rotated,haloColor:e.label.haloColor,haloSize:e.label.haloSize,xoffset:e.label.xoffset,yoffset:e.label.yoffset,verticalAlignment:e.label.verticalAlignment,horizontalAlignment:e.label.horizontalAlignment,font:{size:e.label.size,family:"Josefin Slab",weight:e.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:e.label.color},size:e.label.size,halo:{color:e.label.haloColor,size:e.label.haloSize}}]};var n=new p({labelExpressionInfo:{expression:"$feature.NAME"},symbol:a,labelPlacement:e.label.placement,minScale:e.label.minScale,maxScale:e.label.maxScale});r.labelingInfo=[n]}}});else if("group"===v.type){var t,i=[{name:"objectId",alias:"objectId",type:"oid"},{name:"uuid",alias:"唯一标识",type:"string"}];if(i.push({name:"style",alias:"样式",type:"string"}),v.datafiled.forEach(function(e){i.push(e)}),"marker"===v.overlaytype.toLowerCase()){t={type:"unique-value",field:"style",uniqueValueInfos:[]},v.style.forEach(function(e){"3D"===b.viewMode?t.uniqueValueInfos.push({value:e.style,label:e.style,symbol:{type:"point-3d",symbolLayers:[{type:"icon",size:e.size.height,resource:{href:e.url}}]}}):t.uniqueValueInfos.push({value:e.style,label:e.style,symbol:{type:"picture-marker",url:e.url,width:e.size.height,height:e.size.height}})});var r=new s({id:v.uuid,title:v.uuid,objectIdField:"OBJECTID",geometryType:"point",renderer:t,screenSizePerspectiveEnabled:"3D"===b.viewMode,popupEnabled:!1,popupTemplate:!1,fields:i,source:[],spatialReference:b.view.spatialReference});if(b.view.map.add(r),v.overlayers.forEach(function(e){e.attributes.uuid=e.uuid;var t=new c({geometry:new u({x:e.position[0],y:e.position[1],z:void 0===e.position[2]?0:e.position[2],spatialReference:b.view.spatialReference}),attributes:e.attributes});r.source.add(t),b.mapoverlayersflayer.push([v.uuid,e.uuid,t])}),100<r.source.items.length&&null!=v.frreduction&&(r.featureReduction={type:v.frreduction.type,clusterRadius:v.frreduction.clusterRadius}),v.label.visible){var o=void 0;o="2D"===b.viewMode?{type:v.label.type,text:v.label.text,color:v.label.color,angle:v.label.angle,backgroundColor:v.label.backgroundColor,borderLineColor:v.label.borderLineColor,borderLineSize:v.label.borderLineSize,kerning:v.label.kerning,lineHeight:v.label.lineHeight,lineWidth:v.label.lineWidth,rotated:v.label.rotated,haloColor:v.label.haloColor,haloSize:v.label.haloSize,xoffset:v.label.xoffset,yoffset:v.label.yoffset,verticalAlignment:v.label.verticalAlignment,horizontalAlignment:v.label.horizontalAlignment,font:{size:v.label.size,family:"Josefin Slab",weight:v.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:v.label.color},size:v.label.size,halo:{color:v.label.haloColor,size:v.label.haloSize}}]};var l=new p({labelExpressionInfo:{expression:"$feature.NAME"},symbol:o,labelPlacement:v.label.placement,minScale:v.label.minScale,maxScale:v.label.maxScale});r.labelingInfo=[l]}}}else if("element"===v.type&&"marker"===v.overlaytype.toLowerCase()){var a=void 0;a="3D"===b.viewMode?{type:"simple",symbol:{type:"point-3d",symbolLayers:[{type:"icon",size:v.icon.size.width,resource:{href:v.icon.image}}]}}:{type:"simple",symbol:{type:"picture-marker",url:v.icon.image,width:v.icon.size.width,height:v.icon.size.height}};var n=[{name:"objectId",alias:"objectId",type:"oid"},{name:"uuid",alias:"唯一标识",type:"string"}];Object.keys(v.attributes).forEach(function(e){n.push({name:e,alias:e,type:"string"})});var d=new s({id:v.uuid,title:v.uuid,objectIdField:"OBJECTID",geometryType:"point",renderer:a,screenSizePerspectiveEnabled:!0,popupEnabled:!1,popupTemplate:!1,fields:n,source:[],spatialReference:b.view.spatialReference}),y=v.attributes;y.uuid=v.uuid;var h=new c({geometry:new u({x:v.position[0],y:v.position[1],z:void 0===v.position[2]?0:v.position[2],spatialReference:b.view.spatialReference}),attributes:y});d.source.add(h),b.view.map.add(d),b.mapoverlayersflayer.push([v.uuid,v.uuid,h]),v.label.visible&&(o=void 0,o="2D"===b.viewMode?{type:v.label.type,text:v.label.text,color:v.label.color,angle:v.label.angle,backgroundColor:v.label.backgroundColor,borderLineColor:v.label.borderLineColor,borderLineSize:v.label.borderLineSize,kerning:v.label.kerning,lineHeight:v.label.lineHeight,lineWidth:v.label.lineWidth,rotated:v.label.rotated,haloColor:v.label.haloColor,haloSize:v.label.haloSize,xoffset:v.label.xoffset,yoffset:v.label.yoffset,verticalAlignment:v.label.verticalAlignment,horizontalAlignment:v.label.horizontalAlignment,font:{size:v.label.size,family:"Josefin Slab",weight:v.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:v.label.color},size:v.label.size,halo:{color:v.label.haloColor,size:v.label.haloSize}}]},l=new p({labelExpressionInfo:{expression:"$feature.NAME"},symbol:o,labelPlacement:v.label.placement,minScale:v.label.minScale,maxScale:v.label.maxScale}),d.labelingInfo=[l])}})},Xe.prototype.updatefeature=function(l){var s=this;ve(["esri/layers/FeatureLayer","esri/layers/support/LabelClass","esri/Graphic","esri/geometry/Point","esri/symbols/PictureMarkerSymbol","esri/geometry/Polyline","esri/geometry/Polygon"]).then(function(e){e[0];var a=e[1],n=(e[2],e[3]);if(e[4],e[5],e[6],l instanceof Array)l.forEach(function(l){"marker"===l.overlaytype.toLowerCase()&&s.mapoverlayersflayer.filter(function(e){return e[1]===l.uuid}).forEach(function(t){var e=[],i=new n({x:l.position[0],y:l.position[1],z:void 0===l.position[2]?0:l.position[2],spatialReference:s.view.spatialReference});t[2].geometry=i,Object.keys(l.attributes).map(function(e){"objectId"!==e&&t[2].setAttribute(e,l.attributes[e])}),e.push(t[2]);var o=s.view.map.findLayerById(t[0]);null!==o&&o.applyEdits({updateFeatures:e}).then(function(e){var t;if(t="3D"===s.viewMode?{type:"simple",symbol:{type:"point-3d",symbolLayers:[{type:"icon",size:l.icon.size.width,resource:{href:l.icon.image}}]}}:{type:"simple",symbol:{type:"picture-marker",url:l.icon.image,width:l.icon.size.width,height:l.icon.size.height}},l.label.visible){var i=void 0;i="2D"===s.viewMode?{type:l.label.type,text:l.label.text,color:l.label.color,angle:l.label.angle,backgroundColor:l.label.backgroundColor,borderLineColor:l.label.borderLineColor,borderLineSize:l.label.borderLineSize,kerning:l.label.kerning,lineHeight:l.label.lineHeight,lineWidth:l.label.lineWidth,rotated:l.label.rotated,haloColor:l.label.haloColor,haloSize:l.label.haloSize,xoffset:l.label.xoffset,yoffset:l.label.yoffset,verticalAlignment:l.label.verticalAlignment,horizontalAlignment:l.label.horizontalAlignment,font:{size:l.label.size,family:"Josefin Slab",weight:l.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:l.label.color},size:l.label.size,halo:{color:l.label.haloColor,size:l.label.haloSize}}]};var r=new a({labelExpressionInfo:{expression:"$feature.NAME"},symbol:i,labelPlacement:l.label.placement,minScale:l.label.minScale,maxScale:l.label.maxScale});o.labelingInfo=[r]}o.renderer=t,o.refresh()})})});else if("group"===l.type){var r=[];l.overlayers.forEach(function(t){var i=s.mapoverlayersflayer.filter(function(e){return e[1]===t.uuid});if(1===i.length){t.attributes.uuid=t.uuid;var e=new n({x:t.position[0],y:t.position[1],z:void 0===t.position[2]?0:t.position[2],spatialReference:s.view.spatialReference});i[0][2].geometry=e,Object.keys(t.attributes).map(function(e){"objectId"!==e&&i[0][2].setAttribute(e,t.attributes[e])}),r.push(i[0][2])}});var o=s.view.map.findLayerById(l.uuid);null!==o&&o.applyEdits({updateFeatures:r}).then(function(e){var t={type:"unique-value",field:"style",uniqueValueInfos:[]};if(l.style.forEach(function(e){"3D"===s.viewMode?t.uniqueValueInfos.push({value:e.style,label:e.style,symbol:{type:"point-3d",symbolLayers:[{type:"icon",size:e.size.height,resource:{href:e.url}}]}}):t.uniqueValueInfos.push({value:e.style,label:e.style,symbol:{type:"picture-marker",url:e.url,width:e.size.height,height:e.size.height}})}),o.renderer=t,100<o.source.items.length&&null!=l.frreduction&&(o.featureReduction={type:l.frreduction.type,clusterRadius:l.frreduction.clusterRadius}),l.label.visible){var i=void 0;i="2D"===s.viewMode?{type:l.label.type,text:l.label.text,color:l.label.color,angle:l.label.angle,backgroundColor:l.label.backgroundColor,borderLineColor:l.label.borderLineColor,borderLineSize:l.label.borderLineSize,kerning:l.label.kerning,lineHeight:l.label.lineHeight,lineWidth:l.label.lineWidth,rotated:l.label.rotated,haloColor:l.label.haloColor,haloSize:l.label.haloSize,xoffset:l.label.xoffset,yoffset:l.label.yoffset,verticalAlignment:l.label.verticalAlignment,horizontalAlignment:l.label.horizontalAlignment,font:{size:l.label.size,family:"Josefin Slab",weight:l.label.weight}}:{type:"label-3d",symbolLayers:[{type:"text",material:{color:l.label.color},size:l.label.size,halo:{color:l.label.haloColor,size:l.label.haloSize}}]};var r=new a({labelExpressionInfo:{expression:"$feature.NAME"},symbol:i,labelPlacement:l.label.placement,minScale:l.label.minScale,maxScale:l.label.maxScale});o.labelingInfo=[r]}o.refresh()})}else"element"===l.type&&s.mapoverlayersflayer.filter(function(e){return e[1]===l.uuid}).forEach(function(i){var e=[];l.attributes.uuid=l.uuid;var t=new n({x:l.position[0],y:l.position[1],z:void 0===l.position[2]?0:l.position[2],spatialReference:s.view.spatialReference});i[2].geometry=t,Object.keys(l.attributes).map(function(e){"objectId"!==e&&i[2].setAttribute(e,l.attributes[e])}),e.push(i[2]);var r=s.view.map.findLayerById(i[0]);null!==r&&r.applyEdits({updateFeatures:e}).then(function(e){var t;i[0]===i[1]&&(t="3D"===s.viewMode?{type:"simple",symbol:{type:"point-3d",symbolLayers:[{type:"icon",size:l.icon.size.width,resource:{href:l.icon.image}}]}}:{type:"simple",symbol:{type:"picture-marker",url:l.icon.image,width:l.icon.size.width,height:l.icon.size.height}},r.renderer=t,l.label.visible)&&("2D"===s.viewMode?(l.label.type,l.label.text,l.label.color,l.label.angle,l.label.backgroundColor,l.label.borderLineColor,l.label.borderLineSize,l.label.kerning,l.label.lineHeight,l.label.lineWidth,l.label.rotated,l.label.haloColor,l.label.haloSize,l.label.xoffset,l.label.yoffset,l.label.verticalAlignment,l.label.horizontalAlignment,l.label.size,l.label.weight):(l.label.color,l.label.size,l.label.haloColor,l.label.haloSize),r.refresh())})})})},Xe.prototype.removefeature=function(t){var i=this;if(t instanceof Array)t.forEach(function(t){i.mapoverlayersflayer.filter(function(e){return e[1]===t.uuid}).forEach(function(e){var t=i.view.map.findLayerById(e[0]);null!==t&&t.applyEdits({deleteFeatures:[e[2]]}).then(function(e){t.queryFeatures().then(function(e){0===e.features.length&&i.view.map.remove(t)})})}),i.mapoverlayersflayer=i.mapoverlayersflayer.filter(function(e){return e[1]!==t.uuid})});else if("group"===t.type){var e=this.view.map.findLayerById(t.uuid);null!==e&&this.view.map.remove(e),this.mapoverlayersflayer=this.mapoverlayersflayer.filter(function(e){return e[0]!==t.uuid})}else"element"===t.type&&(this.mapoverlayersflayer.filter(function(e){return e[1]===t.uuid}).forEach(function(e){var t=i.view.map.findLayerById(e[0]);null!==t&&t.applyEdits({deleteFeatures:[e[2]]}).then(function(e){t.queryFeatures().then(function(e){0===e.features.length&&i.view.map.remove(t)})})}),this.mapoverlayersflayer=this.mapoverlayersflayer.filter(function(e){return e[1]!==t.uuid}))},Xe.prototype.clearMap=function(){this.view.graphics.removeAll(),this.mapoverlayers=[]},Xe.prototype.setExtentConstrain=function(a,n){var s=this;ve(["esri/geometry/Extent","esri/geometry/geometryEngine","esri/core/watchUtils"]).then(function(e){var t=e[0],i=e[1],r=e[2],o=new t({xmin:a[0],ymin:a[1],xmax:n[0],ymax:n[1],spatialReference:s.view.spatialReference});s.view.extent=o;var l=r.whenTrue(s.view,"stationary",function(){i.contains(o,s.view.extent)||(s.view.extent=o)});s.watchHandles.push(["extentcontrain",l])})},Xe.prototype.removeExtentConstrain=function(){this.watchHandles.filter(function(e){return"extentcontrain"===e[0]}).forEach(function(e){e[1].remove()}),this.watchHandles=this.watchHandles.filter(function(e){return"extentcontrain"!==e[0]})},Xe.prototype.setmaskboundary=function(y){var h=this;ve(["esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/Polygon","esri/geometry/geometryEngineAsync","esri/geometry/SpatialReference","esri/Color"]).then(function(e){var p=e[0],t=e[1],i=e[2],c=e[3],u=(e[4],e[5]),r=null;"qx_boundary"===y.boundaryType?r=h.view.map.findLayerById("qx_boundary"):"jd_boundary"===y.boundaryType?r=h.view.map.findLayerById("jd_boundary"):"jwh_boundary"===y.boundaryType&&(r=h.view.map.findLayerById("jwh_boundary"));var d=h.view.map.findLayerById("mask_boundary_graphiclayer");if(null==d&&(d=new t({id:"mask_boundary_graphiclayer",title:"遮罩层",listMode:"hide"}),h.view.map.add(d)),d.removeAll(),y.inputgeometry){if(null===(r=h.view.map.findLayerById("qx_boundary")))return;var o=new i({rings:y.inputgeometry,spatialReference:h.view.spatialReference}),l=r.fullExtent;l.spatialReference=h.view.spatialReference;var s=o;s.spatialReference=h.view.spatialReference,c.buffer(s,y.boundarydistance,"meters").then(function(e){c.difference(l,e).then(function(e){var t;t="3D"===h.viewMode?y.symbol?{type:"polygon-3d",symbolLayers:[{type:"extrude",material:{color:y.maskColor},size:y.symbol.size,edges:{type:"solid",color:y.maskColor}}]}:{type:"polygon-3d",symbolLayers:[{type:"fill",material:{color:y.maskColor},outline:{color:"white",size:"0px"}}]}:{type:"simple-fill",color:y.maskColor,style:"solid",outline:{color:y.maskColor,width:1}};var i=new p({geometry:e,symbol:t});d.add(i);for(var o=void 0===y.bounarycount?30:y.bounarycount,l=Math.ceil(y.boundarydistance/o),a=new u(y.boundaryColor).toRgba(),r=function(r){c.buffer(s,r*o,"meters").then(function(t){c.buffer(s,(r-1)*o,"meters").then(function(e){c.difference(t,e).then(function(e){var t;a[3]=1/l*r,t="3D"===h.viewMode?y.symbol?{type:"polygon-3d",symbolLayers:[{type:"extrude",material:{color:a},size:y.symbol.size,edges:{type:"solid",color:a}}]}:{type:"polygon-3d",symbolLayers:[{type:"fill",material:{color:a},outline:{color:"white",size:"0px"}}]}:{type:"simple-fill",color:a,style:"solid",outline:{color:a,width:1}};var i=new p({geometry:e,symbol:t});d.add(i)})})})},n=1;n<=l;n++)r(n)})})}else{if(null===r)return;var a=r.createQuery();a.where=y.boundaryDefinition,r.queryFeatures(a).then(function(e){if(e.features.length){var t=r.fullExtent;t.spatialReference=h.view.spatialReference;var s=e.features[0].geometry;s.spatialReference=h.view.spatialReference,c.buffer(s,y.boundarydistance,"meters").then(function(e){c.difference(t,e).then(function(e){var t;t="3D"===h.viewMode?y.symbol?{type:"polygon-3d",symbolLayers:[{type:"extrude",material:{color:y.maskColor},size:y.symbol.size,edges:{type:"solid",color:y.maskColor}}]}:{type:"polygon-3d",symbolLayers:[{type:"fill",material:{color:y.maskColor},outline:{color:"white",size:"0px"}}]}:{type:"simple-fill",color:y.maskColor,style:"solid",outline:{color:y.maskColor,width:1}};var i=new p({geometry:e,symbol:t});d.add(i);for(var o=void 0===y.bounarycount?30:y.bounarycount,l=Math.ceil(y.boundarydistance/o),a=new u(y.boundaryColor).toRgba(),r=function(r){c.buffer(s,r*o,"meters").then(function(t){c.buffer(s,(r-1)*o,"meters").then(function(e){c.difference(t,e).then(function(e){var t;a[3]=1/l*r,t="3D"===h.viewMode?y.symbol?{type:"polygon-3d",symbolLayers:[{type:"extrude",material:{color:a},size:y.symbol.size,edges:{type:"solid",color:a}}]}:{type:"polygon-3d",symbolLayers:[{type:"fill",material:{color:a},outline:{color:"white",size:"0px"}}]}:{type:"simple-fill",color:a,style:"solid",outline:{color:a,width:1}};var i=new p({geometry:e,symbol:t});d.add(i)})})})},n=1;n<=l;n++)r(n)})})}})}}).catch(function(e){console.error(e)})},Xe.prototype.init=function(c,u,d){return Ne(this,void 0,void 0,function(){var t=this;return Re(this,function(e){return this.maplayers=Y.gisService,ve(["smiapi/utils/xhrutils"]).then(function(e){var p=e[0];return Ne(t,void 0,void 0,function(){var t,i,r,o,l,a,n,s=this;return Re(this,function(e){switch(e.label){case 0:return"back"!==Y.tokenserver.tokenType?[3,1]:(t=void 0===d.tokenconfigname?Y.tokenserver.token_black.tokenconfigname:d.tokenconfigname,i=window.location.host,r=Y.tokenserver.token_black.url,p.maptoken_backend(Y.proxyConifg.url,r,t,i).then(function(i){return Ne(s,void 0,void 0,function(){var t;return Re(this,function(e){switch(e.label){case 0:return this.maptoken=JSON.parse(i.data).token,"3D"!==this.viewMode?[3,2]:[4,we(c,Y.gisService,Y.proxyConifg,this.maptoken,d)];case 1:return t=e.sent(),this.view=t.sceneView,[3,4];case 2:return[4,xe(c,Y.gisService,Y.proxyConifg,this.maptoken,d)];case 3:t=e.sent(),this.view=t.mapView,e.label=4;case 4:return this.initEvent(),[2]}})})}),[3,7]);case 1:return"free"!==Y.tokenserver.tokenType?[3,6]:"3D"!==this.viewMode?[3,3]:[4,we(c,Y.gisService,Y.proxyConifg,"",d)];case 2:return o=e.sent(),this.view=o.sceneView,[3,5];case 3:return[4,xe(c,Y.gisService,Y.proxyConifg,"",d)];case 4:o=e.sent(),this.view=o.mapView,e.label=5;case 5:return this.initEvent(),[3,7];case 6:l=Y.tokenserver.token_front.url,a=Y.tokenserver.token_front.user,n=Y.tokenserver.token_front.password,p.maptoken_front(l,a,n).then(function(i){return Ne(s,void 0,void 0,function(){var t;return Re(this,function(e){switch(e.label){case 0:return this.maptoken=i.token,"3D"!==u?[3,2]:[4,we(c,Y.gisService,Y.proxyConifg,this.maptoken,d)];case 1:return t=e.sent(),this.view=t.sceneView,[3,4];case 2:return[4,xe(c,Y.gisService,Y.proxyConifg,this.maptoken,d)];case 3:t=e.sent(),this.view=t.mapView,e.label=4;case 4:return this.initEvent(),[2]}})})}),e.label=7;case 7:return[2]}})})}),[2]})})},Xe.prototype.init1=function(l,a,n){return Ne(this,void 0,void 0,function(){var t,i,o=this;return Re(this,function(e){switch(e.label){case 0:return"back"!==Y.tokenserver.tokenType?[3,1]:(t={tokenconfigname:void 0===n.tokenconfigname?"smiapi_new":n.tokenconfigname,domainName:window.location.host},function(e,t,i,r,o){void 0===i&&(i={}),r=r||ze.sameOrigin;var l={cache:o=o||Le.default,credentials:"same-origin",headers:{"user-agent":"Mozilla/4.0 MDN Example","content-type":"application/json","X-Authorization":"Bearer"+t},method:"GET",redirect:"follow",referrer:"no-referrer"},a=encodeURIComponent;return e+="?"+Object.keys(i).map(function(e){return a(e)+"="+a(i[e])}).join("&"),fetch(e,l).then(function(e){return e.json()}).then(function(e){return e.error?(e.error.statusCode,Promise.reject(new Error(e.error))):Promise.resolve(e)})}(Y.tokenserver.token_black.url,"",t,ze.noCors,Le.forceCache).then(function(r){return Ne(o,void 0,void 0,function(){var t,i;return Re(this,function(e){switch(e.label){case 0:return t=JSON.parse(r.data).token,"3D"!==this.viewMode?[3,2]:[4,we(l,Y.gisService,Y.proxyConifg,t,n)];case 1:return i=e.sent(),this.view=i.sceneView,[3,4];case 2:return[4,xe(l,Y.gisService,Y.proxyConifg,t,n)];case 3:i=e.sent(),this.view=i.mapView,e.label=4;case 4:return this.initEvent(),[2]}})})}),[3,7]);case 1:return"free"!==Y.tokenserver.tokenType?[3,6]:"3D"!==this.viewMode?[3,3]:[4,we(l,Y.gisService,Y.proxyConifg,"",n)];case 2:return i=e.sent(),this.view=i.sceneView,[3,5];case 3:return[4,xe(l,Y.gisService,Y.proxyConifg,"",n)];case 4:i=e.sent(),this.view=i.mapView,e.label=5;case 5:return this.initEvent(),[3,7];case 6:(function(e,t,i,r,o){r=r||ze.sameOrigin,o=o||Le.default;var l={body:JSON.stringify(i),cache:o,credentials:"same-origin",headers:{"user-agent":"Mozilla/4.0 MDN Example","content-type":"application/json","X-Authorization":"Bearer"+t},method:"POST",mode:r,redirect:"follow",referrer:"no-referrer"};return fetch(e,l).then(function(e){return 200!=e.status&&204!=e.status?e.json().then(function(e){return Promise.reject(e)}):"No Content"==e.statusText?void 0:e.json()})})(Y.tokenserver.token_front.url+"?request=getToken&username="+Y.tokenserver.token_front.user+"&password="+Y.tokenserver.token_front.password+"&clientid=ref."+window.location.host+"&expiration=1440&f=json","","",ze.noCors,Le.default).then(function(r){return Ne(o,void 0,void 0,function(){var t,i;return Re(this,function(e){switch(e.label){case 0:return t=r.token,"3D"!==a?[3,2]:[4,we(l,Y.gisService,Y.proxyConifg,t,n)];case 1:return i=e.sent(),this.view=i.sceneView,[3,4];case 2:return[4,xe(l,Y.gisService,Y.proxyConifg,t,n)];case 3:i=e.sent(),this.view=i.mapView,e.label=4;case 4:return this.initEvent(),[2]}})})}),e.label=7;case 7:return[2]}})})},Xe.prototype.initEvent=function(){return Ne(this,void 0,void 0,function(){var i=this;return Re(this,function(e){return ve(["esri/core/watchUtils"]).then(function(e){var t=e[0];i.view.when(function(){t.whenTrueOnce(i.view,"ready",function(){i.emit(Ce.maploaded,i.view)}),t.whenTrue(i.view,"stationary",function(){if(i.view.extent){var e={xmin:i.view.extent.xmin.toFixed(6),ymin:i.view.extent.ymin.toFixed(6),xmax:i.view.extent.xmax.toFixed(6),ymax:i.view.extent.ymax.toFixed(6)};if("2D"===i.viewMode)i.emit(Ce.extentchanged,e);else{var t={xmin:i.view.extent.xmin.toFixed(6),ymin:i.view.extent.ymin.toFixed(6),xmax:i.view.extent.xmax.toFixed(6),ymax:i.view.extent.ymax.toFixed(6),zmin:i.view.extent.zmin,zmax:i.view.extent.zmax};i.emit(Ce.extentchanged,t)}i.view.center&&("2D"===i.viewMode?i.emit(Ce.centerchanged,{x:i.view.center.x.toFixed(6),y:i.view.center.y.toFixed(6)}):i.emit(Ce.centerchanged,{x:i.view.center.x.toFixed(6),y:i.view.center.y.toFixed(6),z:i.view.center.z})),i.view.zoom&&i.emit(Ce.zoomchanged,i.view.zoom)}}),i.view.popup.watch("visible",function(e){i.emit(Ce.popupvisible,e)}),i.view.on("blur",function(e){i.emit(Ce.blur,i.view,e)}),i.view.on("click",function(e){i.emit(Ce.click,i.view,e)}),i.view.on("double-click",function(e){i.emit(Ce.doubleclick,i.view,e)}),i.view.on("drag",function(e){i.emit(Ce.drag,i.view,e)}),i.view.on("focus",function(e){i.emit(Ce.focus,i.view,e)}),i.view.on("hold",function(e){i.emit(Ce.hold,i.view,e)}),i.view.on("key-down",function(e){i.emit(Ce.keydown,i.view,e)}),i.view.on("key-up",function(e){i.emit(Ce.keyup,i.view,e)}),i.view.on("mouse-wheel",function(e){i.emit(Ce.mousewheel,i.view,e)}),i.view.on("pointer-down",function(e){i.emit(Ce.pointerdown,i.view,e)}),i.view.on("pointer-enter",function(e){i.emit(Ce.pointerenter,i.view,e)}),i.view.on("pointer-leave",function(e){i.emit(Ce.pointerleave,i.view,e)}),i.view.on("pointer-move",function(e){i.emit(Ce.pointermove,i.view,e)}),i.view.on("pointer-up",function(e){i.emit(Ce.pointerup,i.view,e)}),i.view.on("resize",function(e){i.emit(Ce.resize,i.view,e)})})}),[2]})})},Xe);function Xe(e,t){void 0===t&&(t={});var i=Ie.call(this)||this;return i.maplayers=null,i.viewMode="2D",i.showBuildingBlock=!1,i.view=null,i.maptoken="",i.mapControl=[],i.mapoverlayers=[],i.mapoverlayersflayer=[],i.watchHandles=[],i.viewMode=void 0===t.viewMode||"2D"===t.viewMode?"2D":"3D",i.zooms=void 0===t.zooms?[0,11]:t.zooms,i.showBuildingBlock=!!t.showBuildingBlock,i.init(e,i.viewMode,t),i}function Pe(e){this.type="text",this.type=void 0===e.type?"cluster":e.type,this.clusterRadius=void 0===e.clusterRadius?100:e.clusterRadius}function Oe(e){this.size=e.size,this.image=e.image}function De(e){this.type="text",this.color="white",this.visible=!0,this.size=12,this.weight="normal",this.angle=0,this.backgroundColor="red",this.borderLineColor="blue",this.borderLineSize=200,this.haloColor="yellow",this.haloSize=20,this.horizontalAlignment="right",this.verticalAlignment="top",this.kerning=!0,this.lineHeight=25,this.lineWidth=200,this.rotated=!1,this.xoffset=0,this.yoffset=0,this.zoffset=0,this.placement="above-right",this.maxScale=0,this.minScale=0,this.text=void 0===e.text?"标注":e.text,this.color=void 0===e.color?"white":e.color,this.visible=void 0===e.visible||e.visible,this.size=void 0===e.size?12:e.size,this.weight=void 0===e.weight?"normal":e.weight,this.angle=void 0===e.angle?0:e.angle,this.backgroundColor=void 0===e.backgroundColor?"red":e.backgroundColor,this.borderLineColor=void 0===e.borderLineColor?"blue":e.borderLineColor,this.borderLineSize=void 0===e.borderLineSize?200:e.borderLineSize,this.haloColor=void 0===e.haloColor?"yellow":e.haloColor,this.haloSize=void 0===e.haloSize?0:e.haloSize,this.horizontalAlignment=void 0===e.horizontalAlignment?"right":e.horizontalAlignment,this.verticalAlignment=void 0===e.verticalAlignment?"top":e.verticalAlignment,this.kerning=void 0===e.kerning||e.kerning,this.lineHeight=void 0===e.lineHeight?25:e.lineHeight,this.lineWidth=void 0===e.lineWidth?200:e.lineWidth,this.rotated=void 0!==e.rotated&&e.rotated,this.xoffset=void 0===e.xoffset?0:e.xoffset,this.yoffset=void 0===e.yoffset?0:e.yoffset,this.zoffset=void 0===e.zoffset?0:e.zoffset,this.placement=void 0===e.placement?"center-right":e.placement,this.maxScale=void 0===e.maxScale?0:e.maxScale,this.minScale=void 0===e.minScale?0:e.minScale}var Fe=(je.prototype.S4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},je.prototype.get_uuid=function(){return this.S4()+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+this.S4()+this.S4()},je);function je(){this.uuid=this.get_uuid()}function Ge(e){this.uuid=(new Fe).uuid,this.label=e.label,this.attributes=void 0===e.attributes?{}:e.attributes,this.type="element"}var We,Be,Je=((We=function(e,t){return(We=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}We(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(Ve,Be=Ge),Ve);function Ve(e){var t=Be.call(this,e)||this;return t.overlaytype="Marker",t.icon=e.icon,t.position=e.position,t}function Ze(e,t){this.uuid=(new Fe).uuid,this.overlayers=e,this.type="group",this.overlaytype=void 0===t.overlaytype?"marker":t.overlaytype,this.datafiled=void 0===t.datafiled?[]:t.datafiled,this.style=void 0===t.style?[]:t.style,this.label=void 0===t.label?null:t.label,this.frreduction=void 0===t.frreduction?null:t.frreduction}var Qe,Ue,qe,Ye,$e=((Qe=function(e,t){return(Qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Qe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(Ke,Ue=Ge),Ke);function Ke(e){var t=Ue.call(this,e)||this;return t.overlaytype="polygon",t.paths=e.paths,t.symboltype=void 0===e.symboltype?"simple":e.symboltype,t.fillColor=void 0===e.fillColor?"white":e.fillColor,t.style=void 0===e.style?"solid":e.style,t.strokeColor=void 0===e.strokeColor?"red":e.strokeColor,t.strokestyle=void 0===e.strokestyle?"solid":e.strokestyle,t.strokeWeight=void 0===e.strokeWeight?2:e.strokeWeight,t.url=void 0===e.url?"":e.url,t.picwidth=void 0===e.picwidth?20:e.picwidth,t.picheight=void 0===e.picheight?20:e.picheight,t}function et(e){var t=Ye.call(this,e)||this;return t.overlaytype="Polyline",t.path=e.path,t.cap=void 0===e.cap?"square":e.cap,t.strokeColor=void 0===e.strokeColor?"red":e.strokeColor,t.style=void 0===e.style?"solid":e.style,t.lineJoin=void 0===e.lineJoin?"round":e.lineJoin,t.width=void 0===e.width?5:e.width,t}return{load:ve,Bounds:e,LayerListControl:N,Zoom:U,Home:E,Compass:x,Fullscreen:S,MeasureArea:P,MeasureLine:j,BasemapToggle:l,BMapGallery:y,BMapGalleryExpand:m,UndergroundSwitch:J,BIMFilterControl:p,Marker:Je,Icon:Oe,Size:function(e,t){this.width=e,this.height=t},Label:De,FeatureReduction:Pe,OverlayGroup:Ze,LngLat:t,Polyline:((qe=function(e,t){return(qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}qe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(et,Ye=Ge),et),Polygon:$e,MapEvent:Ce,Map:Te}});
//# sourceMappingURL=SMap.min.js.map
